<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="lang" content="en-us" />
    <meta name="area" content="livedocs" />
    <title>Adobe&#160;ColdFusion&#160;9 * cfimap</title>
    <link rel="shortcut icon" href="images/ColdFusionLinkIndicator.png" />
    <meta name="book" content="ColdFusion&#160;9&#160;CFML&#160;Reference" />
    <meta name="product" content="ColdFusion" />
    <meta name="keywords" content="" /><!--<PageMap><DataObject type="document"><Attribute name="product" value="ColdFusion"></Attribute><Attribute name="book" value="ColdFusion&#160;9&#160;CFML&#160;Reference"></Attribute><Attribute name="keywords" value=""></Attribute></DataObject></PageMap>-->
    
    <script type="text/javascript" language="Javascript" charset="UTF-8"><!--[CDATA[
        var currentTreeNode = "WS371453EC-36D5-44ce-BF1E-750E3016BBD6.html";
    document.cookie = "topicId=" + "WS371453EC-36D5-44ce-BF1E-750E3016BBD6.html";
// ]]--></script>
<script src="terms.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="help.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script>  <script src="utilities.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="event.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="treeview.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="toc.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script> <script src="swfobject.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>  <script src="booklist.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>
<script type="text/javascript">
<!--[CDATA[
var topictype = "topic";
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
  var linkId = document.createElement("link");
  linkId.href = "content-ie6.css";
  linkId.rel = "stylesheet";
  linkId.type = "text/css";
  headId.appendChild(linkId);
}
function initRoboHelpDOM() {
  if (use_chm_behavior) {
    hideElement("search");
  }
  if (use_robohelp_behavior) {
    hideElement("search");
    hideElement("productmenu");
    //hideElement("notyourversion");
  }
  if(!use_chc_behavior) {
    //document.getElementById("notyourversion").style.display = "inline";;
  }
}
var dirname = location.pathname.match( /.*\// );    
function setSearchUserPref(){
  if ( document.cookie.indexOf( "ah_searchpref" ) > -1 ) {
    if ( document.cookie.indexOf( dirname ) > 0 ) {
      document.search.gsa.checked = true ;
    }else{
      document.search.gsa.checked = false ;            
    }
  }
}
YAHOO.util.Event.onDOMReady(initRoboHelpDOM);
YAHOO.util.Event.onDOMReady(setSearchUserPref);
// ]]-->
</script>

<!-- ********************************** -->
<!-- START: ForeSee survey code in: /ssi/globalheader.ssi -->

<script type="text/javascript">
<!-- 
// Enable the survey for only English, German and Japanese
var agt=navigator.userAgent.toLowerCase();
if ( agt.indexOf("community help client") == -1 ){
    if ( document.location.href.indexOf("/en_US/") != -1 ){
        showSurvey();
//    }else if (document.location.href.indexOf("/de_DE/") != -1){
//         var locale="de";
//         showSurvey();
    }else if (document.location.href.indexOf("/ja_JP/") != -1 ){
         var locale="ja";
         showSurvey();
    }	
}

function showSurvey(){
	document.write('<script type="text/javascript" src="/js/foresee/foresee-trigger.js"><\/scr'+'ipt>');
}

// -->
</script>

<!-- END: ForeSee survey code -->
<!-- ******************************** -->




    <link rel="stylesheet" type="text/css" href="tree.css" />
    <link rel="stylesheet" type="text/css" href="content.css" />
    <link rel="stylesheet" type="text/css" href="localeSpecific.css" />
  </head>
  <body id="content_body" onload="window.focus();">
    <a name="top" shape="rect"><!--LeaveCommentHere--></a>
    
    <div id="mnemonic">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon" class="ColdFusion"><div class="banner"><a href="WSf01dbd23413dda0e50e0885e12057559231-8000.html">Adobe&#160;ColdFusion&#160;9</a><span id="notyourversion">|&#160;
                    <a rel="nofollow" href="http://www.adobe.com/support/documentation/en/coldfusion/">Not your version?</a></span></div></div><!--googleon: index-->
    </div>
    
    <div id="searchbar">
<table id="searchbartable">
<tr>
<td colspan="2">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon"><div id="pdf"><img src="images/PDF.gif" width="16" height="16" /><a title="View Help PDF" href="coldfusion_9_cfmlref.pdf">View Help PDF ( 32MB)</a></div></div><!--googleon: index-->
</td>
</tr>
</table>
    </div>

<!-- BEGIN SEARCH CONTENT -->
<form id="search" name="search" action="search.html" target="_self">
<script type="text/javascript">
<!--[CDATA[
if ( !use_chc_behavior ){
    if (typeof(terms_AHV_SEARCH_CONSTRAINT) != "undefined" && 
        terms_AHV_SEARCH_CONSTRAINT.length > 0 && 
        document.location.href.indexOf(".adobe.com") > 0){
        if ( typeof(terms_SEARCH_THIS_HELP_ONLY) != "undefined" && terms_SEARCH_THIS_HELP_ONLY == "ON" ) {
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                checked="checked" \
                value="1" ><\/input>'); 
                
        // Leave the "Search this help system only" checkbox unckecked
        }else{    
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                value="1" ><\/input>'); 
        }
        document.write('<span class="gsalabel">' + terms_AHV_SEARCH_CONSTRAINT + '<\/span><\/div>'); 
    }
    document.write('<input class="searchinput" \
        name="q" \
        id="q" \
        type="text" \
        maxlength="256" \
        value="' + terms_AHV_SEARCH_BUTTON + '" \
        onclick="clearSearch()"><\/input><input \
        type="button" \
        name="searchbutton" \
        class="searchbutton" \
        onclick="submit()"><\/input>'); 
} 
 
/* 
 * Start Functions 
 */
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}

// set search preferences
function setAHSearchPref(){
    if (document.search.gsa.checked == 1){
        setAHSearchCookie( dirname );
    }else{
        setAHSearchCookie( "community" );
    }
}

// Set search preferences cookie
function setAHSearchCookie( p ){
    // set cookie ah_searchpref with a value of the document path
    var expire=new Date();
    expire.setDate(expire.getDate()+365); // Cookie expires after 1 year (365 days) 
    document.cookie="ah_searchpref=" +p+ "; expires=" +expire.toGMTString()+ ";";
}

// ]]-->
</script> 
 </form>
<!-- END SEARCH CONTENT -->    



<!-- BEGIN PAGE CONTENT WRAPPER -->
    <div id="page_content_wrapper">
<!-- BEGIN PAGE WRAPPER -->
<table id="page_content_table">
<tr>

<td id="col2">
<!-- BEGIN CONTENT WRAPPER -->
<!-- BEGIN BREADCRUMBS -->

      
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc3ff6d0ea77859461172e0811cbec22c24-7945.html" title="cfimage"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc3ff6d0ea77859461172e0811cbec18a66-7fea.html" title="cfimpersonate"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e50e0885e12057559231-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e50e0885e12057559231-8000.html"><b>ColdFusion&#160;9&#160;CFML&#160;Reference</b></a> / <a href="WSc3ff6d0ea77859461172e0811cbec17576-7ffe.html"><b>ColdFusion Tags</b></a> 
      / <a href="WSc3ff6d0ea77859461172e0811cbec18a66-8000.html"><b>Tags i</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
      <div id="content_wrapper">
<!-- BEGIN PAGE TITLE -->
        <h1>cfimap</h1>
<!-- END PAGE TITLE -->
<!-- BEGIN IONCOMMENTCOUNT -->
        <div id="ionCount">
        </div>
<!-- END IONCOMMENTCOUNT -->
<table id="inner_content_table" width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td>
          <div style="border-top:#ccc solid 1px;"><p> </p>
          </div>
<p id="chcPromo" style="display:none;">
<a id="chcLink" href="http://www.adobe.com/support/chc/">
<img id="chcImage" src="http://www.adobe.com/support/chc/GetMoreHelpFeatures.png"/>
</a>
</p>
<script type="text/javascript" language="javascript" charset="utf-8">
<!--
var cfgArray = [];
//cfgArray["Acrobat_10.0_Professional.helpcfg"] = "acrobatpro";
//cfgArray["Acrobat_10.0_Standard.helpcfg"] = "acrobatstd";
cfgArray["Lightroom_3.0.helpcfg"] = "lightroom";
cfgArray["PhotoshopElements_8.0_Win.helpcfg"] = "photoshopelements";
cfgArray["PhotoshopElements_8.0_Mac.helpcfg"] = "photoshopelementsmac";
cfgArray["PremiereElements_8.0_Win.helpcfg"] = "premiereelements";

//cfgArray["AfterEffects_10.0.helpcfg"] = "aftereffects";
//cfgArray["AIR.helpcfg"] = "air";
//cfgArray["ColdFusionBuilder.helpcfg"] = "coldfusion";
//cfgArray["Contribute_6.0.helpcfg"] = "contribute";
//cfgArray["DeviceCentral_3.0.helpcfg"] = "devicecentral";
//cfgArray["Dreamweaver_11.0.helpcfg"] = "dreamweaver";
//cfgArray["EncoreDVD_5.0.helpcfg"] = "encore";
//cfgArray["ExtensionManager_3.0.helpcfg"] = "extension";
//cfgArray["Fireworks_11.0.helpcfg"] = "fireworks";
//cfgArray["Flash_11.0.helpcfg"] = "flash";
//cfgArray["Flex_4.0.helpcfg"] = "flashbuilder";
//cfgArray["FlashCatalyst_1.0.helpcfg"] = "flashcatalyst";
//cfgArray["Illustrator_15.0.helpcfg"] = "illustrator";
//cfgArray["InCopy_7.0.helpcfg"] = "incopy";
//cfgArray["InDesign_7.0.helpcfg"] = "indesign";
//cfgArray["OnLocation_5.0.helpcfg"] = "onlocation";
//cfgArray["Photoshop_12.0.helpcfg"] = "photoshop";
//cfgArray["PremierePro_5.0.helpcfg"] = "premierepro";

function getLangName() {
    var lang = "en-us";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if (ptn.test(lang)) {
        var languageCode = lang.replace(ptn, "$1");
        var countryCode = lang.replace(ptn, "$2");
        lang = languageCode + "_" + countryCode.toUpperCase();
    }
    return lang;
}

function getCountryName() {
    var lang = "";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if ((ptn.test(lang)) && (lang != "en-us")) {
        var countryCode = lang.replace(ptn, "$2");
        return "/" + countryCode;
    }
    return "";
}

if ( (typeof(terms_HELPCFG) != 'undefined')  && (terms_HELPCFG.indexOf(".helpcfg") != -1) ) {
    var stage   = (document.location.href.indexOf(".stage.") != -1) ? 'stage.' : '';
    var baseUrl = 'http://www.' + stage + 'adobe.com';
    var refpage = document.location.href.replace(/#.*$/, '');
	
	if ((!use_robohelp_behavior) && (terms_HELPCFG.length > 0) && (typeof(cfgArray[terms_HELPCFG]) != 'undefined') && (cfgArray[terms_HELPCFG].length > 0)) {
		if (document.getElementById) { // DOM3 = IE5, NS6
			var newHref = baseUrl + getCountryName() + "/support/chc/" + "?helpcfg=http://help." + stage + "adobe.com/HelpCfg/" + getLangName() + "/" + terms_HELPCFG + "&url=" + refpage + "&product=" + cfgArray[terms_HELPCFG];
			var newSrc = baseUrl + getCountryName() + "/support/chc/GetMoreHelpFeatures.png";
			document.getElementById("chcPromo").style.display = "block";
			document.getElementById("chcLink").href = newHref;
			document.getElementById("chcImage").src = newSrc;
		}
	}
}

//-->
</script>



          <div><div class="section"><h4 class="sectiontitle">Description</h4><p>Queries
an IMAP server to retrieve and manage mails within multiple folders.</p>
</div>
<div class="section"><h4 class="sectiontitle">Category</h4><p><a href="WSc3ff6d0ea77859461172e0811cbec22c24-75be.html">Communications tags</a>, <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7737.html">Internet protocol tags</a></p>
</div>
<div class="section"><h4 class="sectiontitle">Syntax</h4><pre><i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">&lt;cfimap</i><i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema"> 
 &#160;action ="DELETE|DELETEFOLDER|CREATEFOLDER|OPEN|CLOSE|RENAMEFOLDER|LISTALLFOLDERS| MARKREAD|MOVEMAIL|GETALL|GETHEADERONLY"</i>     
&#160; attachmentpath = "string" <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema"> 
&#160;&#160;connection = "string" 
&#160;&#160;folder = "string" 
&#160;&#160;generateuniquefilenames = "yes|no" 
&#160;&#160;maxrows = "integer" 
&#160;&#160;messagenumber ="integer" 
&#160;&#160;name = "string" 
&#160;&#160;newfolder = "string"<i> 
&#160;&#160;</i>password = "string" 
&#160;&#160;port = "integer" 
&#160;&#160;recurse = "true|false" 
&#160;&#160;secure = "yes|no"  
&#160;&#160;server = "IMAP server address" 
&#160;&#160;startrow = "integer"<i> 
&#160;&#160;secure = "yes|no"  
&#160;&#160;</i>stoponerror = "true|false" 
&#160;&#160;uid = "integer or comma-delimited list of integers" 
&#160;&#160;username = "SMTP user ID"&gt;</i></pre>
</div>
<div class="section"><h4 class="sectiontitle">See Also</h4><p><samp class="codeph"><a href="WSc3ff6d0ea77859461172e0811cbec22c24-7c15.html">cfmailparam</a></samp>, <samp class="codeph"><a href="WSc3ff6d0ea77859461172e0811cbec22c24-7c15.html">cfmailparam</a></samp>, <samp class="codeph"><a href="WSc3ff6d0ea77859461172e0811cbec22c24-7c14.html">cfmailpart</a></samp>, <samp class="codeph"><a href="WSc3ff6d0ea77859461172e0811cbec22c24-7f96.html">cfpop</a></samp>, <samp class="codeph"><a href="WSc3ff6d0ea77859461172e0811cbec22c24-7c7d.html">cfftp</a></samp>, <samp class="codeph"><a href="WSc3ff6d0ea77859461172e0811cbec22c24-7ffc.html">cfhttp</a></samp>, <samp class="codeph"><a href="WSc3ff6d0ea77859461172e0811cbec22c24-7f97.html">cfldap</a></samp>, <samp class="codeph"><a href="WSc3ff6d0ea77859461172e0811cbec22c24-7114.html">Wrap</a></samp>; <a href="http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec22c24-70fc.html" target="_self">Using
ColdFusion with mail servers</a> in <a href="http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec22c24-782a.html" target="_self">Sending
and Receiving E-Mail</a>  in the <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">Developing ColdFusion Applications</i></p>
</div>
<div class="section"><h4 class="sectiontitle">History</h4><p>New tag introduced in ColdFusion
9.</p>
</div>
<div class="section"><h4 class="sectiontitle">Attributes</h4>
<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e51792"><p>Attribute</p>
</th>
<th valign="top" width="NaN%" id="d17e51795"><p>Req/Opt</p>
</th>
<th valign="top" width="NaN%" id="d17e51798"><p>Default</p>
</th>
<th valign="top" width="NaN%" id="d17e51801"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">action</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 "><p>GetHeaderOnly</p>
</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Returns the message header information for
all retrieved mail. Other values for this attribute are:</p>
<p><samp class="codeph">GetAll</samp>:
Returns mail. The information includes the message header information,
message text, and any attachments. Set the AttachmentPath attribute
to retrieve attachments. </p>
<p><samp class="codeph">Delete</samp>: Deletes
messages from a folder.</p>
<p><samp class="codeph">Open</samp>: Initiates an
open session or connection with the IMAP server.</p>
<p><samp class="codeph">Close</samp>:
Terminates the open session or connection with the IMAP server.</p>
<p><samp class="codeph">MarkRead</samp>:
Marks all messages read from a folder.</p>
<p><samp class="codeph">CreateFolder</samp>:
Creates a folder in the Mailbox.</p>
<p><samp class="codeph">DeleteFolder</samp>:
Deletes a folder in the Mailbox.</p>
<p><samp class="codeph">RenameFolder</samp>:
Renames an existing user-defined folder.</p>
<p><samp class="codeph">ListAllFolders</samp>:
Displays a list of all existing folders in the mailbox or under
the folder name defined by the Folder attribute.</p>
<p><samp class="codeph">MoveMail</samp>:
Moves mail from one folder to another.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">attachmentpath</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional for GetAll action</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 "><p></p>
</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies the name of the folder where ColdFusion
retrieves attachments. If this folder does not exist, ColdFusion
creates. If you do not specify the folder, then the attachment is
not saved.</p>
<p>Note: If you specify a relative path, then attachments
are saved in a temporary folder. This folder is same as one returned
by the GetTempDirectory function.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">Connection</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Required for the following actions: Open and
Close</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 "><p></p>
</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies the variable name for the connection/session.
If the server attribute has an invalid IP address or invalid domain
name, then the connection fails and ColdFusion returns an error message.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">Folder</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Required for the following actions: DeleteFolder, CreateFolder, and
RenameFolder</p>
<p>Optional for LISTALLFOLDERS, MOVEMAIL, MARKREAD, GETALL,
GETHEADERONLY, DELETE.</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 "><p>INBOX</p>
<p>(For ListAllFolders action,
the default folder is mailbox)</p>
</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>For mail actions: Specifies the folder name
where messages are retrieved, moved, or deleted. If folder name
is invalid, ColdFusion defaults to INBOX.</p>
<p>For folder actions:
Specifies the folder name that is deleted (DeleteFolder) or created
(CreateFolder) or renamed (RenameFolder).</p>
<p>When selecting a
subfolder, use the period (.) character as appropriate. For example,
when deleting mail in folder ‘Module’ in folder ‘Product.Version.Module’,
define the Folder attribute as ‘Product.Version.Module’.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">GenerateUniqueFilenames</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 ">&#160;</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Ensures that unique file names are generated
for each attachment file. The goal is to avoid name conflicts for
attachments that have the same filename.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">MaxRows</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 ">&#160;</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies the number of rows to be marked
as read, deleted, or moved across folders. When the value is 1,
it signals the row determined by StartRow. Any incremental value
marks rows starting from the StartRow.If you have specified the
UID or MessageNumber attribute, then MaxRows is ignored.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">MessageNumber</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 ">&#160;</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies the message number or a comma
delimited list of message numbers for retrieval, deletion, marking
mail as read, or moving mails. </p>
<p>If you set an invalid message
number, then the IMAP operation is ignored. For example, if you
specify that cfimap deletes a specified message number, and if that
message number does not exist, then the operation is ignored. </p>
<p>If
you have specified the UID attribute, then MessageNumber attribute
is ignored.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">Name</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
<p>Required for the following actions:
GetAll, GetHeaderOnly, and ListAllFolders</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 ">&#160;</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies the name for the query object
that contains the retrieved message information.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">NewFolder</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
<p>Required for the following actions: RenameFolder, MoveMail</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 ">&#160;</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies the name of the new folder when
you rename a folder or the name of the destination folder where
all mails move.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">Password</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
<p>Required when action="open" username
and password must be specified.</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 ">&#160;</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies the password for assessing the
users’ e-mail account.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">Port</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 "><p>143 or 993</p>
</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies the IMAP port number. Use 143
for non-secure connections and 993 for secured connections. </p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">Recurse</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 "><p>False</p>
</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies whether ColdFusion runs the CFIMAP
command in subfolders. </p>
<p>Recurse works for action=”ListAllFolders”.
When recurse is set to ”true”, ColdFusion parses through all folders
and subfolders and returns folder/subfolder names and mail information.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">Secure</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 "><p>False</p>
</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies whether the IMAP server uses a
Secure Sockets Layer.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">Server</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
<p>Required for the Open action</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 ">&#160;</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies the IMAP server identifier. You
can assign a host name or an IP address as the IMAP server identifier. </p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">StartRow</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 ">&#160;</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Defines the first row number for reading
or deleting. If you have specified the UID or MessageNumber attribute,
then StartRow is ignored. You can also specify StartRow for moving mails.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">StopOnError</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional    </p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 "><p>True</p>
</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies whether to ignore the exceptions
for this operation. When the value is true, it stops processing,
displays an appropriate error. </p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">Timeout</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 "><p>60</p>
</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies the number of seconds to wait
before timing out connection to IMAP server. An error message is
displayed when timeout occurs. </p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">Uid</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 ">&#160;</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies the unique ID or a comma-delimited
list of Uids to retrieve, delete, and move mails. If you set invalid
Uids, then they are ignored.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e51792 "><p><samp class="codeph">Username</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e51795 "><p>Optional</p>
</td>
<td valign="top" width="NaN%" headers="d17e51798 ">&#160;</td>
<td valign="top" width="NaN%" headers="d17e51801 "><p>Specifies the user name. Typically, the
user name is same the e-mail login. </p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section"><h4 class="sectiontitle">Usage</h4><p>Open a session or connection with
an IMAP server. To open a session, define the server, user name,
and password attributes. You can open a connection with an IMAP
server by specifying values for the server, user name, password,
and connection attributes. For a secure connection, specify secure="true".
You can reuse the connection attribute in subsequent CFIMAP tags,
without having to specify the server, user name, or password attributes.
Once you have established a connection, you can perform the following
actions:</p>
<ul><li><p>Retrieve mail: Retrieve mail using the GetHeaderOnly
or GetAll attributes and store the information in a query object.
Use the cfdump command to display the content of the query object.
You can also download attachments in temporary ColdFusion folder
or a new folder as defined by the AttachmentPath attribute.</p>
</li>
<li><p>Delete any unnecessary mail or delete folders. You can delete
any user-created folders. Standard folders, such as INBOX, OUTBOX,
SEND, cannot be deleted.</p>
</li>
<li><p>Mark multiple mail as read.</p>
</li>
<li><p>Manage mail folders by creating folders, renaming them or
moving mail across folders. If you are using sub folders, then use
periods (.) to specify the exact path.</p>
</li>
</ul>
<div class="para">Once you
have performed all actions, close the session or connection with
the IMAP server. For example, mail from your e-mail account in Gmail
can be retrieved by setting a connection to the Gmail IMAP server.
You can define the login (user name) and set a secure connection.
Next, you can quickly retrieve a top-level snapshot of e-mails using
the GetHeaderOnly attribute or access full information about e-mails
using the GetAll attribute. <div class="note"><span class="notetitle">Note:  </span>Gmail is not a complete IMAP implementation
so some of the features of a regular IMAP server may not work with
Gmail.</div>
</div>
<p>The following table lists the query information
(column names) returned by various cfimap attributes. </p>
<div class="para">
<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e52145"><p>Values for “action” attribute</p>
</th>
<th valign="top" width="NaN%" id="d17e52148"><p>Columns</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e52145 "><p>GetHeaderOnly</p>
</td>
<td valign="top" width="NaN%" headers="d17e52148 "><p>ANSWERED, CC, DELETED, DRAFT, FLAGGED, FROM,
HEADER, LINES, MESSAGEID, MESSAGENUMBER, RECENT, REPLYTO, RXDDATE,
SEEN, SENTDATE, SIZE, SUBJECT, TO, UID</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e52145 "><p>GetAll</p>
</td>
<td valign="top" width="NaN%" headers="d17e52148 "><p>ANSWERED, ATTACHMENTFILES, ATTACHMENTS,
BODY, CC, CIDS, DELETED, DRAFT, FLAGGED, FROM, HEADER, HTMLBODY,
LINES, MESSAGEID, MESSAGENUMBER, RECENT, REPLYTO, RXDDATE, SEEN,SENTDATE,
SIZE, SUBJECT, TEXTBODY, TO, UID.</p>
<p>CID is used to find the
correct place of an image in an HTML e-mail message that the CFIMAP tag
retrieves. If the e-mail message contains more than one embedded
image, only the last embedded image is available.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e52145 "><p>ListAllFolders</p>
</td>
<td valign="top" width="NaN%" headers="d17e52148 "><p>FULLNAME (specifies the entire directory
structure), NAME, NEW, TOTALMESSAGES, and UNREAD</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="para"><div class="note"><span class="notetitle">Note:  </span>The cfimap command works best
on IMAP4 revision1. IMAP4 revision1 is backwards compatible with
IMAP2 and IMAP2bis versions. Any previous versions are no more actively
used. </div>
</div>
<p>You can get errors in following scenarios:</p>
<div class="para"><ul><li><p>Accessing an invalid server connection is established. Check
the network conditions and whether you are using appropriate server
IP address and domain names. Use valid e-mail user names and passwords.</p>
</li>
<li><p>Accessing non-existent folders: Check whether the folder
you are accessing exists. Create or rename folders with valid names.
You cannot rename core folders. Move mail within existing folders.</p>
</li>
<li><p>Slow network: Verify if the timeout attribute needs a higher
value. Actions such as CreateFolder may need longer time to execute.
In such cases, adjust the value of the timeout attribute.</p>
</li>
<li><p>Incorrect usage of cfimap attributes: Check if you are using
the correct attribute. For example, if you have 15 e-mails in a
folder and if the startrow or maxrow attribute has value of 18 then
ColdFusion returns an error.</p>
</li>
<li><p>The e-mail client does not recognize IMAP access. Verify
whether your e-mail is set up to allow IMAP access. Complete the
necessary IMAP access in connection settings section of your e-mail
client.</p>
</li>
<li><p>Using incorrect syntax for attributes: Verify that all attributes
are defined per syntax.</p>
</li>
</ul>
</div>
</div>
<div class="section"><h4 class="sectiontitle">Example: 1</h4><pre>&lt;!--- Retrieving e-mails from a folder ---&gt; 
&lt;html &gt; 
    &lt;head&gt; 
    &lt;title&gt;IMAP Mail Client&lt;/title&gt; 
    &lt;/head&gt; 
    &lt;body&gt; 
    &lt;!--- Replace your username and password with valid IMAP email account name and password. Replace "server address" with your IMAP server address---&gt; 
    &lt;cfimap 
        server = "server address" &lt;!------&gt; 
        username = "yourname" 
        action="open" 
        secure="yes" 
        password = "yourpassword" 
        connection = "test.cf.gmail"&gt; 
    &lt;!--- Retrieve header information from the mailbox. ---&gt; 
    &lt;cfimap 
        action="getHeaderOnly" 
        connection="test.cf.gmail" 
        name="queryname"&gt; 
    &lt;cfdump var="#queryname#"&gt; 
    &lt;cfimap 
        action="close" 
        connection = "test.cf.gmail"&gt; 
    &lt;/body&gt; 
&lt;/html&gt;</pre>
</div>
<div class="section"><h4 class="sectiontitle">Example: 2</h4><pre>&lt;!--- Create a folder; copy mail from Inbox and list all folder info---&gt; 
&lt;html &gt; 
    &lt;head&gt; 
    &lt;title&gt;IMAP Mail Client&lt;/title&gt; 
    &lt;/head&gt; 
&lt;body&gt; 
    &lt;!--- Replace yourname and yourpassword with valid IMAP email account name and password. Replace "server address" with your IMAP server address---&gt; 
    &lt;cfimap 
        server = "server address" 
        username = "yourname" 
        action="open" 
        secure="yes" 
        password = "yourpassword" 
        connection = "test.cf.gmail"&gt; 
    &lt;!--- Create a new folder, named Folder1 ---&gt; 
    &lt;cfimap 
        action="CreateFolder" 
        folder="Folder1" 
        connection="test.cf.gmail"&gt; 
    &lt;!--- Move first 2 mails from INBOX to Folder1. ---&gt; 
    &lt;cfimap 
        action="MoveMail" 
        newfolder="Folder1" 
        messagenumber="1,2" 
        stoponerror="true" 
        connection="test.cf.gmail"&gt; 
    &lt;!--- List all folders and get the information in a query. ---&gt; 
    &lt;cfimap action="listallfolders" 
        connection="test.cf.gmail" 
        name="queryname"&gt; 
    &lt;!--- Display query containing all folders information. ---&gt; 
    &lt;cfdump var="#queryname#"&gt; 
    &lt;cfimap 
        action="close" 
        connection = "test.cf.gmail"&gt; 
&lt;/body&gt; 
&lt;/html&gt;</pre>
</div>
<div class="section"><h4 class="sectiontitle">Example: 3</h4><pre>&lt;!--- Use form-based entry to access cfimap mail account. Save the form with name login.cfm. ---&gt; 
&lt;html&gt; 
&lt;head&gt; 
&lt;title&gt;IMAP Mail Client&lt;/title&gt; 
&lt;/head&gt; 
&lt;body&gt;     
&lt;cfif IsDefined("form.server")&gt; 
    &lt;!--- Make sure server, username are not empty. ---&gt; 
    &lt;cfif form.server is not "" and form.username is not ""&gt; 
        &lt;cfimap 
           server = "#form.server#" 
           username = "#form.username#" 
           action="open" 
           Secure="yes" 
           password = "#form.pwd#" 
           connection = "#form.server#"&gt; 
        &lt;cfimap 
           action="ListAllFolders" 
           connection="#form.server#" 
           name="queryname"&gt; 
        &lt;h3&gt;Folders in your Inbox &lt;cfoutput&gt;#form.username#&lt;/cfoutput&gt;&lt;/h3&gt; 
        &lt;ol&gt; 
            &lt;cfoutput query = "queryname"&gt; 
                &lt;li&gt;#NAME# - #TOTALMESSAGES# &lt;b&gt;(#UNREAD#)&lt;/b&gt;&lt;/li&gt; 
            &lt;/cfoutput&gt; 
        &lt;/ol&gt; 
        &lt;!---&lt;cfdump var="#queryname#"&gt;---&gt; 
        &lt;cfimap  action="close"           connection = "#form.server#"&gt; 
    &lt;/cfif&gt; 
    &lt;cfelse&gt; 
    &lt;form action = "login.cfm " method = "post"&gt; 
        &lt;table&gt; 
            &lt;tr&gt; 
            &lt;td&gt;Enter IMAP mail server&lt;/td&gt;&lt;td&gt;&lt;input type = "Text" name = "server"&gt;&lt;/td&gt; 
            &lt;/tr&gt; 
            &lt;tr&gt; 
            &lt;td&gt;Enter your username&lt;/td&gt;&lt;td&gt;&lt;input type = "Text" name = "username"&gt;&lt;/td&gt; 
            &lt;/tr&gt; 
            &lt;tr&gt; 
            &lt;td&gt;Enter your password&lt;/td&gt;&lt;td&gt;&lt;input type = "password" name = "pwd"&gt;&lt;/td&gt; 
            &lt;/tr&gt; 
            &lt;tr&gt; 
            &lt;td colspan="2"&gt;&lt;input type="Submit" value="Get Folder List" name="getFolderList"&gt;&lt;/td&gt; 
            &lt;/tr&gt; 
        &lt;/table&gt; 
    &lt;/form&gt; 
&lt;/cfif&gt; 
&lt;/body&gt; 
&lt;/html&gt;</pre>
</div>
</div>


<!-- BEGIN USER PREFERENCES -->
          <div id="userprefs">
          </div>
<!-- END USER PREFERENCES -->

          <div id="related">
            
            
            <div class="separator">&#160;</div>
          </div>
          <div id="footer">
<!-- BEGIN IONCOMMENTS -->
            <div id="ionComHere">
            </div>
<!-- END IONCOMMENTS -->


            <p id="creativecommons"><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text"><img id="creativecommons_img" src="images/CC.png" alt="This work is licensed under a Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License" /></a>&nbsp;Twitter™ and Facebook posts are not covered under the terms of Creative Commons.</p>
          </div>
</td>
<td width="10px"></td>
<td id="inner_rightcolumn">

</td></tr></table>
      </div>
<!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc3ff6d0ea77859461172e0811cbec22c24-7945.html" title="cfimage"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc3ff6d0ea77859461172e0811cbec18a66-7fea.html" title="cfimpersonate"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e50e0885e12057559231-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e50e0885e12057559231-8000.html"><b>ColdFusion&#160;9&#160;CFML&#160;Reference</b></a> / <a href="WSc3ff6d0ea77859461172e0811cbec17576-7ffe.html"><b>ColdFusion Tags</b></a> 
      / <a href="WSc3ff6d0ea77859461172e0811cbec18a66-8000.html"><b>Tags i</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
<!-- END CONTENT WRAPPER -->

</td>
<td id="col3">
    <div>
        <img src="images/adobe-lq.png" />
    </div>
</td>
</tr>
</table>
    </div>
<!-- END PAGE CONTENT WRAPPER -->
<script type="text/javascript">
<!--[CDATA[
scrollToNameAnchor();
// ]]-->
</script> 
<!--
    Description:
    This file generates the link to product support in the top right corner
-->

<style>
#menutop{
    position:absolute;
    top:4px;
    right:24px;
    width:auto;    
    font-size:11px;
    color:#fff;
    text-align:right;
}
#menutop a{
    color:#fff;
}
#menutop a:hover{
        text-decoration:underline;
}
</style>  
  
  
  
  
<div id="productmenu">
<!--googleoff: index-->
  <div id="menutop">


<script language=javascript type='text/javascript'>
    // darken menu text for products with light backgrounds
    var path = document.location.href.toLowerCase();
    if (path.indexOf("/acrobat/")           	> 0 ||
        path.indexOf("/acrobat.com/")       	> 0 ||
        path.indexOf("/acrobatConnectPro/") 	> 0 ||
        path.indexOf("/connect/")           	> 0 ||
        path.indexOf("/livecycledataserviceses/") > 0 ||
        path.indexOf("/muse/")         	> 0 ||
	path.indexOf("/presenter/")         	> 0 ||
        path.indexOf("/scene7/")            	> 0 ||
        path.indexOf("/flashmediaserver/")  	> 0 ||
        path.indexOf("/wave/")              	> 0 )
    {
        document.write('<style>#menutop a{color:#505050}</style>');
    }
    if (typeof('terms_AHV_PRODUCT_SUPPORT') != "undefined" && ! use_robohelp_behavior ){      
        if (path.indexOf("/muse/") > -1 ){
            var supportlink = '<a href="http://muse.adobe.com/support.html">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }else{
            var supportlink = '<a href="http://adobe.com/support">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }
        document.write( supportlink );
     }

</script> 

  </div>
<!--googleon: index-->
</div>



<style>
#online-privacy-policy{ 
    margin:10px 40px; 
    font-size:11px;
}
</style>

<p id="online-privacy-policy">
<script language="javascript">
var pageLoc = "en_US";
var metaElements = document.all ?
document.all.tags('meta') :
document.getElementsByTagName ?
document.getElementsByTagName ('meta') : new Array();
for (var m = 0; m < metaElements.length; m++) {
	if (metaElements[m].name == "lang") {
		pageLoc = metaElements[m].content;
		break;
	}
}
var ptn = /(..)-(..)/;
if (ptn.test(pageLoc)) {
	var languageCode = pageLoc.replace(ptn, "$1");
	var countryCode = pageLoc.replace(ptn, "$2");
	pageLoc = languageCode + "_" + countryCode.toUpperCase();
}

var policyLoc = "en_US";
var policyText = "Online Privacy Policy";
var policyPath = "";
var policyArray=[
"da_DK", "Online fortrolighedserklæring",
"de_DE", "Online-Datenschutzrichtlinie",
"es_ES", "Política de confidencialidad en línea",
"fi_FI", "Yksityisyyttä koskeva Online-toimintaohjelma",
"fr_FR", "Confidentialité et sécurité",
"it_IT", "Informativa sulla privacy online",
"ja_JP", "プライバシーポリシー",
"ko_KR", "Adobe 온라인 개인정보 보호정책",
"pt_BR", "Política de Confidencialidade On-line", 
"zh_CN", "在线隐私政策",
"zh_TW", "線上隱私政策"
];
var legalLoc = "en_US";
var legalText = "Legal Notices";
var legalPath = legalLoc;
var legalArray=[
"ar_AE", "إشعارات قانونية",
"bg_BG", "Юридически бележки",
"cs_CZ", "Právní upozornění",
"da_DK", "Juridiske meddelelser",
"de_DE", "Rechtliche Hinweise",
"el_GR", "Σημειώσεις νομικού περιεχομένου",
"es_ES", "Avisos legales",
"et_EE", "Juriidilised teated",
"fi_FI", "Lakisääteiset ilmoitukset",
"fr_FR", "Mentions légales",
"he_IL", "הצהרות משפטיות",
"hr_HR", "Pravne napomene",
"hu_HU", "Jogi közlemények",
"it_IT", "Informazioni legali",
"ja_JP", "法律上の注意",
"ko_KR", "법적 고지 사항",
"lt_LT", "Teisinės pastabos",
"lv_LV", "Juridisks paziņojums",
"nb_NO", "Juridiske merknader",
"nl_NL", "Juridische kennisgevingen",
"pl_PL", "Informacje prawne",
"pt_BR", "Aspectos jurídicos",
"ro_RO", "Prevederi legale",
"ru_RU", "Юридическая информация",
"sk_SK", "Právne upozornenie",
"sl_SI", "Pravni pouk",
"sv_SE", "Upphovsrätt",
"tr_TR", "Yasal uyarılar",
"uk_UA", "Юридична інформація",
"zh_CN", "法律声明",
"zh_TW", "法律注意事項"
];

ruPolicy = "http://www.adobe.com/ru/misc/privacy.html";
trPolicy = "http://www.adobe.com/tr/misc/privacy.html";

// Bug 2846992: LOC: RUS, TUR: The link to "Online Privacy Policy" should include language, currently it is not appearing.
if (pageLoc == "ru_RU") {
	policyPath = "ru";
}
else if (pageLoc == "tr_TR") {
	policyPath = "tr";
}
for (var i = 0; i < policyArray.length; i+=2) {
	if (pageLoc == policyArray[i]) {
		policyLoc = pageLoc;
		policyText = policyArray[i+1];
		var ptn = /(..)_(..)/;
		if (ptn.test(policyLoc)) {
			var countryCode = policyLoc.replace(ptn, "$2");
			policyPath = countryCode.toLowerCase();
		}
		break;
	}
}

for (var i = 0; i < legalArray.length; i+=2) {
	if (pageLoc == legalArray[i]) {
		legalLoc = pageLoc;
		legalText = legalArray[i+1];
		legalPath = legalLoc;
		break;
	}
}
if(agt.indexOf("community help client") > -1 ){
	document.write('<a href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
}else{
	//Open the privacy policy in a new window
	document.write('<a target="_blank" href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a target="_blank" href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
} 
</script>
</p>



<!-- localfooter.ssi -->

<script type="text/javascript">
    var debug = (top.location.href.indexOf("debug=true") > -1);
</script>

<script language="javascript">
document.write('<scr'+'ipt ' +
               'src="/en_US/ssi/_pod.js" ' +
               'language="javascript" ' +
               'charset="UTF-8"> ' +
               '</scr'+'ipt>');
</script>


<script type="text/javascript">
//
//  Ethnio survey code
//
/*          DocumentID      EthnioID */
/*          -------------   -------- */
var ethnio=["/en_US/flash/cs/using/WSb03e830bd6f770ee6664507612436d7dede-8000.html", "87462",
            "/en_US/creativesuite/cs/using/WSe851854fd1e0856a-4b08a77612477f69f15-8000.html",  "10441",
            "/en_US/dreamweaver/cs/using/WSEE4C0148-A6F4-4bf5-9DEF-CE06AB026214a.html",  "57412"
 
    ];
                        
    for ( var i = 0; i < ethnio.length ; i = i+2 ){
        if ( document.location.href.indexOf( ethnio[i] ) > -1 ){ 
            var headID = document.getElementsByTagName("head")[0];         
            var ethnioScript = document.createElement('script');
            ethnioScript.type = 'text/javascript';
            ethnioScript.src = 'http://ethn.io/remotes/' + ethnio[i+1];        
            if ( debug ){
                alert ("Using Ethnio script: " + ethnioScript.src );
            }else{
                headID.appendChild(ethnioScript);
            }
        }
    }
</script>



<div style="display: none;">
<!-- SiteCatalyst -->
<script language="JavaScript" type="text/javascript"><!--
var s_code=' ';
var s_docHost = window.location.hostname.toLowerCase();
var s_docURL = window.location.pathname.toLowerCase();
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
if (s_docHost.indexOf(".corp.adobe") != -1 || s_docHost.indexOf("stage.") != -1 || s_docHost.indexOf(".dev.adobe") != -1 || s_docHost.indexOf("staging.") != -1) scJsHost="";
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/omniture_s_code.js' type='text/javascript'%3E%3C/script%3E"));
//--></script>
<script type="text/javascript"><!--
var s_accountName;
s_server="www.adobe.com static content pages";
if (!window.s_account) s_accountName="mxmacromedia";
else s_accountName=window.s_account;

if (window.s_docURL.indexOf("/designcenter/") != -1)
  s_channel="Adobe Design Center";	
else if ((window.s_docHost.indexOf("labs.adobe") != -1) ||
(window.s_docHost.indexOf("labs-staging.") != -1))
  s_channel="Labs";
else if (window.s_docHost.indexOf("help.adobe.com") != -1) {
  s_channel="Support Help.adobe.com";
  if (window.s_docURL.indexOf("/en_us/") == -1) {
    s_docURLArray=s_docURL.split('/');
    s_pageName="http://help.adobe.com/"+s_docURLArray[1]+"/"+ s_docURLArray[2]+"/"+s_docURLArray[3];
    s_prop23="http://help.adobe.com"+window.location.pathname;
  }
}
else if (window.s_docHost.indexOf("kb2.adobe.com") != -1) {
  s_channel="Support Knowledgebase";
  s_prop23="http://kb2.adobe.com"+s_docURL+":";
  if (typeof(omtrProductList) != 'undefined' && omtrProductList.length > 0)
 {
    s_prop23=s_prop23+omtrProductList;
  }
}
else if (window.s_docHost.indexOf("resellers.adobe.com") != -1) {
		var s_pageName=document.getElementsByTagName("title")[0].text;
}

if (!window.scMMInclude) {
	var s_wd=window,s_tm=new Date;
	if(s_code!=' '){
		s_code=s_dc(s_accountName);
		if(s_code)document.write(s_code)
	} 
} else {
	s_wds(s_accountName);s_ca(s_accountName); 
}	

function sendAnalyticsEvent(str){var ns=s_accountName;if(str!=null)ns+=","+str;void(s_gs(ns));}
function sendLinkEvent(accnt,lnkname,type){
accnt=s_accountName;s_linkType=type;s_lnk=true;s_linkName=lnkname;void(s_gs(accnt));}
//--></script>
<noscript><img src="http://stats.adobe.com/b/ss/mxmacromedia/1/H.15-XELvs/0?pageName=http%3A//www.adobe.com%3A%20noscript&ch=http%3A//www.adobe.com%3A%20noscript&g=http%3A//www.adobe.com" height="1" width="1" border="0" alt="" /></noscript>
<!-- End SiteCatalyst -->
</div>

<script language="JavaScript" type="text/javascript">//<![CDATA[
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/atm/s_code_www.js' type='text/javascript'%3E%3C/script%3E"));
//]]></script>
<script type="text/javascript">//<![CDATA[
if(s_adobe){	
	s_adobe.server="www.adobe.com Static Content pages";
	/* Set pageName */
	s_adobe.s_URL="adobe.com"+((location.pathname.charAt(0)=='/')?location.pathname:'/'+location.pathname);
	if (s_adobe.s_URL.substring(s_adobe.s_URL.lastIndexOf('/')+1)=="") s_adobe.s_URL=s_adobe.s_URL+"index.html";
	s_adobe.s_URLSplit=s_adobe.s_URL.split("/");
	s_adobe.pageName=s_adobe.s_URLSplit.join(":");

	/* Set prop4 to language-locale */
	var s_meta=document.getElementsByTagName('meta'); 
      for (i=0; i<s_meta.length; i++) { 
        if (s_meta[i].getAttribute("http-equiv") == "Content-Language") { 
          s_adobe.prop4=s_meta[i].getAttribute("content"); 
	    s_adobe.prop4=s_adobe.prop4.replace(/\s+/g,'');
        } 
      } 
	s_adobe.t()
}
//]]></script>








  </body>
</html>