<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="lang" content="en-us" />
    <meta name="area" content="livedocs" />
    <title>Adobe&#160;ColdFusion&#160;9 * Working with data returned from a query</title>
    <link rel="shortcut icon" href="images/ColdFusionLinkIndicator.png" />
    <meta name="book" content="Developing&#160;ColdFusion 9 Applications" />
    <meta name="product" content="ColdFusion" />
    <meta name="keywords" content="" /><!--<PageMap><DataObject type="document"><Attribute name="product" value="ColdFusion"></Attribute><Attribute name="book" value="Developing&#160;ColdFusion 9 Applications"></Attribute><Attribute name="keywords" value=""></Attribute></DataObject></PageMap>-->
    
    <script type="text/javascript" language="Javascript" charset="UTF-8"><!--[CDATA[
        var currentTreeNode = "WSc3ff6d0ea77859461172e0811cbec22c24-7b35.html";
    document.cookie = "topicId=" + "WSc3ff6d0ea77859461172e0811cbec22c24-7b35.html";
// ]]--></script>
<script src="terms.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="help.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script>  <script src="utilities.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="event.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="treeview.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="toc.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script> <script src="swfobject.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>  <script src="booklist.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>
<script type="text/javascript">
<!--[CDATA[
var topictype = "topic";
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
  var linkId = document.createElement("link");
  linkId.href = "content-ie6.css";
  linkId.rel = "stylesheet";
  linkId.type = "text/css";
  headId.appendChild(linkId);
}
function initRoboHelpDOM() {
  if (use_chm_behavior) {
    hideElement("search");
  }
  if (use_robohelp_behavior) {
    hideElement("search");
    hideElement("productmenu");
    //hideElement("notyourversion");
  }
  if(!use_chc_behavior) {
    //document.getElementById("notyourversion").style.display = "inline";;
  }
}
var dirname = location.pathname.match( /.*\// );    
function setSearchUserPref(){
  if ( document.cookie.indexOf( "ah_searchpref" ) > -1 ) {
    if ( document.cookie.indexOf( dirname ) > 0 ) {
      document.search.gsa.checked = true ;
    }else{
      document.search.gsa.checked = false ;            
    }
  }
}
YAHOO.util.Event.onDOMReady(initRoboHelpDOM);
YAHOO.util.Event.onDOMReady(setSearchUserPref);
// ]]-->
</script>

<!-- ********************************** -->
<!-- START: ForeSee survey code in: /ssi/globalheader.ssi -->

<script type="text/javascript">
<!-- 
// Enable the survey for only English, German and Japanese
var agt=navigator.userAgent.toLowerCase();
if ( agt.indexOf("community help client") == -1 ){
    if ( document.location.href.indexOf("/en_US/") != -1 ){
        showSurvey();
//    }else if (document.location.href.indexOf("/de_DE/") != -1){
//         var locale="de";
//         showSurvey();
    }else if (document.location.href.indexOf("/ja_JP/") != -1 ){
         var locale="ja";
         showSurvey();
    }	
}

function showSurvey(){
	document.write('<script type="text/javascript" src="/js/foresee/foresee-trigger.js"><\/scr'+'ipt>');
}

// -->
</script>

<!-- END: ForeSee survey code -->
<!-- ******************************** -->




    <link rel="stylesheet" type="text/css" href="tree.css" />
    <link rel="stylesheet" type="text/css" href="content.css" />
    <link rel="stylesheet" type="text/css" href="localeSpecific.css" />
  </head>
  <body id="content_body" onload="window.focus();">
    <a name="top" shape="rect"><!--LeaveCommentHere--></a>
    
    <div id="mnemonic">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon" class="ColdFusion"><div class="banner"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html">Adobe&#160;ColdFusion&#160;9</a><span id="notyourversion">|&#160;
                    <a rel="nofollow" href="http://www.adobe.com/support/documentation/en/coldfusion/">Not your version?</a></span></div></div><!--googleon: index-->
    </div>
    
    <div id="searchbar">
<table id="searchbartable">
<tr>
<td colspan="2">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon"><div id="pdf"><img src="images/PDF.gif" width="16" height="16" /><a title="View Help PDF" href="coldfusion_9_dev.pdf">View Help PDF ( 23MB)</a></div></div><!--googleon: index-->
</td>
</tr>
</table>
    </div>

<!-- BEGIN SEARCH CONTENT -->
<form id="search" name="search" action="search.html" target="_self">
<script type="text/javascript">
<!--[CDATA[
if ( !use_chc_behavior ){
    if (typeof(terms_AHV_SEARCH_CONSTRAINT) != "undefined" && 
        terms_AHV_SEARCH_CONSTRAINT.length > 0 && 
        document.location.href.indexOf(".adobe.com") > 0){
        if ( typeof(terms_SEARCH_THIS_HELP_ONLY) != "undefined" && terms_SEARCH_THIS_HELP_ONLY == "ON" ) {
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                checked="checked" \
                value="1" ><\/input>'); 
                
        // Leave the "Search this help system only" checkbox unckecked
        }else{    
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                value="1" ><\/input>'); 
        }
        document.write('<span class="gsalabel">' + terms_AHV_SEARCH_CONSTRAINT + '<\/span><\/div>'); 
    }
    document.write('<input class="searchinput" \
        name="q" \
        id="q" \
        type="text" \
        maxlength="256" \
        value="' + terms_AHV_SEARCH_BUTTON + '" \
        onclick="clearSearch()"><\/input><input \
        type="button" \
        name="searchbutton" \
        class="searchbutton" \
        onclick="submit()"><\/input>'); 
} 
 
/* 
 * Start Functions 
 */
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}

// set search preferences
function setAHSearchPref(){
    if (document.search.gsa.checked == 1){
        setAHSearchCookie( dirname );
    }else{
        setAHSearchCookie( "community" );
    }
}

// Set search preferences cookie
function setAHSearchCookie( p ){
    // set cookie ah_searchpref with a value of the document path
    var expire=new Date();
    expire.setDate(expire.getDate()+365); // Cookie expires after 1 year (365 days) 
    document.cookie="ah_searchpref=" +p+ "; expires=" +expire.toGMTString()+ ";";
}

// ]]-->
</script> 
 </form>
<!-- END SEARCH CONTENT -->    



<!-- BEGIN PAGE CONTENT WRAPPER -->
    <div id="page_content_wrapper">
<!-- BEGIN PAGE WRAPPER -->
<table id="page_content_table">
<tr>

<td id="col2">
<!-- BEGIN CONTENT WRAPPER -->
<!-- BEGIN BREADCRUMBS -->

      
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc3ff6d0ea77859461172e0811cbec0ef2f-7ff6.html" title="Enhancing search results"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc3ff6d0ea77859461172e0811cbec22c24-7b4a.html" title="Using Verity Search Expressions"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Developing&#160;ColdFusion 9 Applications</b></a> / <a href="WS8f0cc78011fffa7168855f811cdb0b0cce-8000.html"><b>Accessing and Using Data</b></a> 
      / <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7b7e.html"><b>Building a Search Interface</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
      <div id="content_wrapper">
<!-- BEGIN PAGE TITLE -->
        <h1>Working with data returned from a query</h1>
<!-- END PAGE TITLE -->
<!-- BEGIN IONCOMMENTCOUNT -->
        <div id="ionCount">
        </div>
<!-- END IONCOMMENTCOUNT -->
<table id="inner_content_table" width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td>
          <div style="border-top:#ccc solid 1px;"><p> </p>
          </div>
<p id="chcPromo" style="display:none;">
<a id="chcLink" href="http://www.adobe.com/support/chc/">
<img id="chcImage" src="http://www.adobe.com/support/chc/GetMoreHelpFeatures.png"/>
</a>
</p>
<script type="text/javascript" language="javascript" charset="utf-8">
<!--
var cfgArray = [];
//cfgArray["Acrobat_10.0_Professional.helpcfg"] = "acrobatpro";
//cfgArray["Acrobat_10.0_Standard.helpcfg"] = "acrobatstd";
cfgArray["Lightroom_3.0.helpcfg"] = "lightroom";
cfgArray["PhotoshopElements_8.0_Win.helpcfg"] = "photoshopelements";
cfgArray["PhotoshopElements_8.0_Mac.helpcfg"] = "photoshopelementsmac";
cfgArray["PremiereElements_8.0_Win.helpcfg"] = "premiereelements";

//cfgArray["AfterEffects_10.0.helpcfg"] = "aftereffects";
//cfgArray["AIR.helpcfg"] = "air";
//cfgArray["ColdFusionBuilder.helpcfg"] = "coldfusion";
//cfgArray["Contribute_6.0.helpcfg"] = "contribute";
//cfgArray["DeviceCentral_3.0.helpcfg"] = "devicecentral";
//cfgArray["Dreamweaver_11.0.helpcfg"] = "dreamweaver";
//cfgArray["EncoreDVD_5.0.helpcfg"] = "encore";
//cfgArray["ExtensionManager_3.0.helpcfg"] = "extension";
//cfgArray["Fireworks_11.0.helpcfg"] = "fireworks";
//cfgArray["Flash_11.0.helpcfg"] = "flash";
//cfgArray["Flex_4.0.helpcfg"] = "flashbuilder";
//cfgArray["FlashCatalyst_1.0.helpcfg"] = "flashcatalyst";
//cfgArray["Illustrator_15.0.helpcfg"] = "illustrator";
//cfgArray["InCopy_7.0.helpcfg"] = "incopy";
//cfgArray["InDesign_7.0.helpcfg"] = "indesign";
//cfgArray["OnLocation_5.0.helpcfg"] = "onlocation";
//cfgArray["Photoshop_12.0.helpcfg"] = "photoshop";
//cfgArray["PremierePro_5.0.helpcfg"] = "premierepro";

function getLangName() {
    var lang = "en-us";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if (ptn.test(lang)) {
        var languageCode = lang.replace(ptn, "$1");
        var countryCode = lang.replace(ptn, "$2");
        lang = languageCode + "_" + countryCode.toUpperCase();
    }
    return lang;
}

function getCountryName() {
    var lang = "";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if ((ptn.test(lang)) && (lang != "en-us")) {
        var countryCode = lang.replace(ptn, "$2");
        return "/" + countryCode;
    }
    return "";
}

if ( (typeof(terms_HELPCFG) != 'undefined')  && (terms_HELPCFG.indexOf(".helpcfg") != -1) ) {
    var stage   = (document.location.href.indexOf(".stage.") != -1) ? 'stage.' : '';
    var baseUrl = 'http://www.' + stage + 'adobe.com';
    var refpage = document.location.href.replace(/#.*$/, '');
	
	if ((!use_robohelp_behavior) && (terms_HELPCFG.length > 0) && (typeof(cfgArray[terms_HELPCFG]) != 'undefined') && (cfgArray[terms_HELPCFG].length > 0)) {
		if (document.getElementById) { // DOM3 = IE5, NS6
			var newHref = baseUrl + getCountryName() + "/support/chc/" + "?helpcfg=http://help." + stage + "adobe.com/HelpCfg/" + getLangName() + "/" + terms_HELPCFG + "&url=" + refpage + "&product=" + cfgArray[terms_HELPCFG];
			var newSrc = baseUrl + getCountryName() + "/support/chc/GetMoreHelpFeatures.png";
			document.getElementById("chcPromo").style.display = "block";
			document.getElementById("chcLink").href = newHref;
			document.getElementById("chcImage").src = newSrc;
		}
	}
}

//-->
</script>



          <div id="minitoc"><div class="t"><div class="b"><div><ul id="minitoc-links"><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0ef2f-7feb"><span class="topictitle1">Recordsets and types of queries</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec22c24-7b34"><span class="topictitle1">Indexing data returned by a query</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0ef2f-7fed"><span class="topictitle1">Indexing a file returned by using a query</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0ef2f-7fea"><span class="topictitle1">Indexing a path returned by using a query</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec22c24-7b6b"><span class="topictitle1">Indexing query results obtained from an LDAP directory</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0ef2f-7fdc"><span class="topictitle1">Indexing cfpop query results</span>
</a></p></li></ul></div></div></div></div><div><p>Using
Verity, you can search data returned by a query—such as a database recordset—as
if it is a collection of documents stored on your web server. Using Verity
to search makes implementing a search interface much easier, as
well as letting users more easily find information contained in
database files. A database can direct the indexing process, by using
different values for the <samp class="codeph">type</samp> attribute of the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d04.html" target="_self">cfindex</a></samp> tag. There are also
several reasons and procedures for indexing the results of database
and other queries. </p>
</div>
<div id="WSc3ff6d0ea77859461172e0811cbec0ef2f-7feb" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0ef2f-7feb"><!-- --></a><h2 class="topictitle2">Recordsets and types of queries</h2><div><p>When indexing recordsets generated
from a query (using the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7fae.html" target="_self">cfquery</a></samp>, <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f97.html" target="_self">cfldap</a>, or <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f96.html" target="_self">cfpop</a></samp> tag), <samp class="codeph">cfindex</samp> creates
indexes based on the <samp class="codeph">type</samp> attribute and its set value:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e49811"><p>Type</p>
</th>
<th valign="top" width="NaN%" id="d17e49814"><p>Attribute values</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e49811 "><p>File</p>
</td>
<td valign="top" width="NaN%" headers="d17e49814 "><p>The <samp class="codeph">key</samp> attribute is the
name of a column in the query that contains a full filename (including
path). </p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e49811 "><p>Path</p>
</td>
<td valign="top" width="NaN%" headers="d17e49814 "><p>The <samp class="codeph">key</samp> attribute is the
name of a column in the query that contains a directory pathname.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e49811 "><p>Custom</p>
</td>
<td valign="top" width="NaN%" headers="d17e49814 "><p>The <samp class="codeph">key</samp> attribute specifies
a column name that can contain anything you want. In this case,
the <samp class="codeph">body</samp> attribute is required, and is a comma-delimited
list of the names of the columns that contain the text data to be
indexed.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>The <samp class="codeph">cfindex</samp> tag treats all collections the same,
whether they originate from a database recordset, or if they are
a collection of documents stored within your website’s root folder. </p>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec22c24-7b34" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec22c24-7b34"><!-- --></a><h2 class="topictitle2">Indexing data returned by a query</h2><div><p>Indexing
the results of a query is like indexing physical files located on
your website, with the added step that you must write a query that
retrieves the data to search. The following are the steps to perform
a Verity search on recordsets returned from a query:</p>
<ol><li><p>Create a collection.</p>
</li>
<li><p>Write a query that retrieves the data you want to search,
and generate a recordset.</p>
</li>
<li><p>Index the recordset using the <samp class="codeph">cfindex</samp> tag.</p>
<p>The <samp class="codeph">cfindex</samp> tag
indexes the recordset as if it is a collection of documents in a
folder within your website. </p>
</li>
<li><p>Search the collection. </p>
<p>The information returned from
the collection includes the database key and other selected columns.
You can then use the information as-is, or use the key value to
retrieve the entire row from the database table.</p>
</li>
</ol>
<p>Use Verity to search databases in the following cases:</p>
<ul><li><p>You want to perform full-text search on database data.
You can search Verity collections that contain textual data much
more efficiently with a Verity search than using SQL to search database
tables.</p>
</li>
<li><p>You want to give your users access to data without interacting
directly with the data source itself.</p>
</li>
<li><p>You want to improve the speed of queries.</p>
</li>
<li><p>You want users to be able to execute queries, but not update
database tables.</p>
</li>
</ul>
<p>Unlike indexing documents stored on
your web server, indexing information contained in a database requires
an additional step— first write a query (using the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7fae.html" target="_self">cfquery</a></samp>, <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f97.html" target="_self">cfldap</a>, or <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f96.html" target="_self">cfpop</a></samp> tag) that retrieves
the data you want to let your users search. You then pass the information
retrieved by the query to a <samp class="codeph">cfindex</samp> tag, which
indexes the data.</p>
<p>When indexing data with the <samp class="codeph">cfindex</samp> tag, specify
which column of the query represents the filename, which column
represents the document title, and which column (or columns) represents
the document’s body (the information that you want to make searchable).</p>
<p>When indexing a recordset retrieved from a database, the <samp class="codeph">cfindex</samp> tag
uses the following attributes that correspond to the data source:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e49934"><p>Attribute</p>
</th>
<th valign="top" width="NaN%" id="d17e49937"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e49934 "><p><samp class="codeph">key</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e49937 "><p>Primary key column of the data source table.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e49934 "><p><samp class="codeph">title</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e49937 "><p>Specifies a query column name.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e49934 "><p><samp class="codeph">body</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e49937 "><p>Columns that you want to search for the
index. </p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e49934 "><p><samp class="codeph">type</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e49937 "><p>If set to <samp class="codeph">custom</samp>, this
attribute specifies the columns that you want to index. If set to <samp class="codeph">file</samp> or <samp class="codeph">path</samp>,
this is a column that contains either a directory path and filename,
or a directory path that contains the documents to be indexed.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>Using the <samp class="codeph">cfindex</samp> tag to index tabular data
is like indexing documents, with the exception that you refer to
column names from the generated recordset in the <samp class="codeph">body</samp> attribute.
In the following example, the <samp class="codeph">type</samp> attribute is
set to <samp class="codeph">custom</samp>, specifying that the <samp class="codeph">cfindex</samp> tag
index the contents of the recordset columns Emp_ID, FirstName, LastName,
and Salary, which are identified using the <samp class="codeph">body</samp> attribute.
The Emp_ID column is listed as the <samp class="codeph">key</samp> attribute,
making it the primary key for the recordset.</p>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec22c24-7b34__WSc3ff6d0ea77859461172e0811cbec0ef2f-7fd7"><a name="WSc3ff6d0ea77859461172e0811cbec22c24-7b34__WSc3ff6d0ea77859461172e0811cbec0ef2f-7fd7"><!-- --></a><h4 class="sectiontitle">Index a ColdFusion query</h4><ol><li><p>Create a Verity collection
for the data that you want to index.</p>
<p>The following example
assumes that you have a Verity collection named CodeColl. You can
use the ColdFusion Administrator to create the collection, or you
can create the collection programmatically by using the <samp class="codeph">cfcollection</samp> tag.
For more information, see <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7b50.html">Creating a collection with the ColdFusion Administrator</a> or <a href="WS4BA63DC4-2723-4415-994E-C512B6B99EF8.html">Creating a collection with the cfcollection tag</a>.</p>
</li>
<li><p>Create a ColdFusion page with the following content:</p>
<pre>&lt;html&gt; 
&lt;head&gt; 
    &lt;title&gt;Adding Query Data to an Index&lt;/title&gt; 
&lt;/head&gt; 
&lt;body&gt; 
 
&lt;!--- Retrieve data from the table. ---&gt; 
&lt;cfquery name="getEmps" datasource="cfdocexamples"&gt; 
    SELECT * FROM EMPLOYEE 
&lt;/cfquery&gt; 
 
&lt;!--- Update the collection with the above query results. ---&gt; 
&lt;cfindex  
    query="getEmps" 
    collection="CodeColl" 
    action="Update" 
    <strong>type="Custom"</strong> 
    <strong>key="Emp_ID"</strong> 
    <strong>title="Emp_ID"</strong> 
    <strong>body="Emp_ID,FirstName,LastName,Salary"&gt;</strong> 
 
&lt;h2&gt;Indexing Complete&lt;/h2&gt; 
 
&lt;!--- Output the record set. ---&gt; 
&lt;p&gt;Your collection now includes the following items:&lt;/p&gt; 
&lt;cfoutput query="getEmps"&gt; 
    &lt;p&gt;#Emp_ID# #FirstName# #LastName# #Salary#&lt;/p&gt; 
&lt;/cfoutput&gt; 
&lt;/body&gt; 
&lt;/html&gt;</pre>
</li>
<li><p>Save the file as collection_db_index.cfm in the myapps directory
under the web root directory.</p>
</li>
<li><p>Open the file in the web browser to index the collection.</p>
<p>The
resulting recordset appears.</p>
</li>
</ol>
</div>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec22c24-7b34__WSc3ff6d0ea77859461172e0811cbec0ef2f-7fe8"><a name="WSc3ff6d0ea77859461172e0811cbec22c24-7b34__WSc3ff6d0ea77859461172e0811cbec0ef2f-7fe8"><!-- --></a><h4 class="sectiontitle">Search and display the query results</h4><ol><li><p>Create a ColdFusion
page with the following content:</p>
<pre>&lt;html&gt; 
&lt;head&gt; 
    &lt;title&gt;Searching a collection&lt;/title&gt; 
&lt;/head&gt; 
&lt;body&gt; 
 
&lt;h2&gt;Searching a collection&lt;/h2&gt; 
 
&lt;form method="post" action="collection_db_results.cfm"&gt; 
    &lt;p&gt;Collection name: &lt;input type="text" name="collname" size="30" maxLength="30"&gt;&lt;/p&gt; 
 
    &lt;p&gt;Enter search term(s) in the box below. You can use AND, OR, NOT,  
    and parentheses. Surround an exact phrase with quotation marks.&lt;/p&gt; 
    &lt;p&gt;&lt;input type="text" name="criteria" size="50" maxLength="50"&gt; 
    &lt;/p&gt; 
    &lt;p&gt;&lt;input type="submit" value="Search"&gt;&lt;/p&gt; 
&lt;/form&gt; 
 
&lt;/body&gt; 
&lt;/html&gt;</pre>
</li>
<li><p>Save the file as collection_db_search_form.cfm in the myapps
directory under the <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">web_root</i>.</p>
<p>This file is like collection_search_form.cfm,
except the form uses collection_db_results.cfm, which you create
in the next step, as its action page.</p>
</li>
<li><p>Create another ColdFusion page with the following content:</p>
<pre>&lt;html&gt; 
&lt;head&gt; 
&lt;title&gt;Search Results&lt;/title&gt; 
&lt;/head&gt; 
 
&lt;body&gt; 
 
&lt;cfsearch  
        collection="#Form.collname#" 
        name="getEmps" 
        criteria="#Form.Criteria#" 
    maxrows = "100"&gt; 
 
&lt;!--- Output the record set. ---&gt; 
&lt;cfoutput&gt; 
Your search returned #getEmps.RecordCount# file(s). 
&lt;/cfoutput&gt; 
 
&lt;cfoutput query="getEmps"&gt; 
    &lt;p&gt;&lt;table&gt; 
    &lt;tr&gt;&lt;td&gt;Title: &lt;/td&gt;&lt;td&gt;#Title#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Score: &lt;/td&gt;&lt;td&gt;#Score#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Key: &lt;/td&gt;&lt;td&gt;#Key#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Summary: &lt;/td&gt;&lt;td&gt;#Summary#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Custom 1:&lt;/td&gt;&lt;td&gt;#Custom1#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Column list: &lt;/td&gt;&lt;td&gt;#ColumnList#&lt;/td&gt;&lt;/tr&gt; 
&lt;/table&gt;&lt;/p&gt; 
 
&lt;/cfoutput&gt; 
&lt;/body&gt; 
&lt;/html&gt;</pre>
</li>
<li><p>Save the file as collection_db_results.cfm in the myapps
directory under the <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">web_root</i>.</p>
</li>
<li><p>View collection_db_search_form.cfm in the web browser and
enter the name of the collection and search terms.</p>
</li>
</ol>
</div>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0ef2f-7fed" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0ef2f-7fed"><!-- --></a><h2 class="topictitle2">Indexing a file returned by using a query</h2><div><p>You can index an individual file that uses a query by retrieving
a table row whose contents are a filename. In this case, the key
specifies the column that contains the complete filename. The file
is indexed using the <samp class="codeph">cfindex</samp> tag as if it is a document
under the web server root folder.</p>
<p>In the following example, the <samp class="codeph">cfindex</samp> tag’s <samp class="codeph">type</samp> attribute
has been set to <samp class="codeph">file</samp>, and the specified key is
the name of the column that contains the full path to the file and
the filename. </p>
<pre>&lt;cfquery name="getEmps" datasource="cfdocexamples"&gt; 
SELECT * FROM EMPLOYEE WHERE EMP_ID = 1 
&lt;/cfquery&gt; 
&lt;cfindex  
    query="getEmps" 
    collection="CodeColl" 
    action="Update" 
    <strong>type="file"</strong> 
    <strong>key="Contract_File" </strong> 
    title="Contract_File" 
    body="Emp_ID,FirstName,LastName,Contract_File"&gt;</pre>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0ef2f-7fed__WSc3ff6d0ea77859461172e0811cbec0ef2f-7fec"><a name="WSc3ff6d0ea77859461172e0811cbec0ef2f-7fed__WSc3ff6d0ea77859461172e0811cbec0ef2f-7fec"><!-- --></a><h4 class="sectiontitle">Search and display the file</h4><div class="para"><img src="images/dingbat.png" />&#160;Create a ColdFusion page
that contains the following content:<pre>&lt;!--- Output the record set.---&gt; 
&lt;p&gt;Your collection now includes the following items:&lt;/p&gt; 
&lt;cfoutput query="getEmps"&gt; 
&lt;p&gt;#Emp_ID# #FirstName# #LastName# #Contract_File#&lt;/p&gt; 
&lt;/cfoutput&gt; 
&lt;cfsearch  
    collection="#Form.collname#" 
    name="getEmps" 
    criteria="#Form.Criteria#" 
    maxrows = "100"&gt; 
 
&lt;!--- Output the filename contained in the record set. ---&gt; 
&lt;cfoutput&gt; 
Your search returned #getEmps.RecordCount# file(s). 
&lt;/cfoutput&gt; 
&lt;cfoutput query="getEmps"&gt; 
&lt;p&gt;&lt;table&gt; 
    &lt;tr&gt;&lt;td&gt;Title: &lt;/td&gt;&lt;td&gt;#Title#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Score: &lt;/td&gt;&lt;td&gt;#Score#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Key: &lt;/td&gt;&lt;td&gt;#Key#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Summary: &lt;/td&gt;&lt;td&gt;#Summary#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Custom 1:&lt;/td&gt;&lt;td&gt;#Custom1#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Column list: &lt;/td&gt;&lt;td&gt;#ColumnList#&lt;/td&gt;&lt;/tr&gt; 
&lt;/table&gt;&lt;/p&gt; 
&lt;/cfoutput&gt;</pre>
</div>
</div>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0ef2f-7fea" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0ef2f-7fea"><!-- --></a><h2 class="topictitle2">Indexing a path returned by using a query</h2><div><p>You can index a directory path to a document (or collection
of documents) using a query by retrieving a row whose contents are
a full directory path name. In this case, the key specifies the
column that contains the complete directory path. Documents located
in the directory path are indexed using the <samp class="codeph">cfindex</samp> tag
as if they are under the web server root folder.</p>
<p>In this example, the <samp class="codeph">type</samp> attribute is set to <samp class="codeph">path</samp>,
and the <samp class="codeph">key</samp> attribute is assigned the column name
Project_Docs. The Project_Docs column contains directory paths,
which Verity indexes as if they are specified as a fixed path pointing
to a collection of documents without the use of a query.</p>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0ef2f-7fea__WSc3ff6d0ea77859461172e0811cbec0ef2f-7fe5"><a name="WSc3ff6d0ea77859461172e0811cbec0ef2f-7fea__WSc3ff6d0ea77859461172e0811cbec0ef2f-7fe5"><!-- --></a><h4 class="sectiontitle">Index a directory path within a query</h4><ol><li><p>Create a ColdFusion
page that contains the following content:</p>
<pre>&lt;cfquery name="getEmps" datasource="cfdocexamples"&gt; 
SELECT * FROM EMPLOYEE WHERE Emp_ID = 15 
&lt;/cfquery&gt; 
&lt;!--- Update the collection with the above query results. ---&gt; 
&lt;!--- Key specifies a column that contains a directory path. ---&gt; 
&lt;cfindex  
    query="getEmps" 
    collection="CodeColl" 
    action="update" 
    <strong>type="path"</strong> 
    <strong>key="Project_Docs"</strong> 
    title="Project_Docs" 
    body="Emp_ID,FirstName,LastName,Project_Docs"&gt; 
 
&lt;h2&gt;Indexing Complete&lt;/h2&gt; 
&lt;p&gt;Your collection now includes the following items:&lt;/p&gt; 
&lt;cfoutput query="getEmps"&gt; 
&lt;p&gt;#Emp_ID# #FirstName# #LastName# #Project_Docs#&lt;/p&gt; 
&lt;/cfoutput&gt;</pre>
</li>
<li><p>Save the file as indexdir.cfm in the myapps directory.</p>
</li>
</ol>
<p>The
ColdFusion <samp class="codeph">cfindex</samp> tag indexes the contents of
the specified directory path.</p>
</div>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0ef2f-7fea__WSc3ff6d0ea77859461172e0811cbec0ef2f-7fe6"><a name="WSc3ff6d0ea77859461172e0811cbec0ef2f-7fea__WSc3ff6d0ea77859461172e0811cbec0ef2f-7fe6"><!-- --></a><h4 class="sectiontitle">Search and display the directory path</h4><ol><li><p>Create a ColdFusion
page that contains the following content:</p>
<pre>&lt;cfsearch  
    collection="#Form.collname#" 
    name="getEmps" 
    criteria="#Form.Criteria#" 
    maxrows = "100"&gt; 
 
&lt;!--- Output the directory path contained in the record set. ---&gt; 
&lt;cfoutput&gt; 
Your search returned #getEmps.RecordCount# file(s). 
&lt;/cfoutput&gt; 
 
&lt;cfoutput query="getEmps"&gt; 
&lt;p&gt;&lt;table&gt; 
    &lt;tr&gt;&lt;td&gt;Title: &lt;/td&gt;&lt;td&gt;#Title#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Score: &lt;/td&gt;&lt;td&gt;#Score#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Key: &lt;/td&gt;&lt;td&gt;#Key#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Summary: &lt;/td&gt;&lt;td&gt;#Summary#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Custom 1:&lt;/td&gt;&lt;td&gt;#Custom1#&lt;/td&gt;&lt;/tr&gt; 
    &lt;tr&gt;&lt;td&gt;Column list: &lt;/td&gt;&lt;td&gt;#ColumnList#&lt;/td&gt;&lt;/tr&gt; 
&lt;/table&gt;&lt;/p&gt; 
&lt;/cfoutput&gt;</pre>
</li>
<li><p>Save the file as displaydir.cfm.</p>
</li>
</ol>
</div>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec22c24-7b6b" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec22c24-7b6b"><!-- --></a><h2 class="topictitle2">Indexing query results obtained from an LDAP directory</h2><div><p>The widespread use of the Lightweight
Directory Access Protocol (LDAP) to build searchable directory structures,
internally and across the web, gives you opportunities to add value
to the sites that you create. You can index contact information
or other data from an LDAP-accessible server and let users search
it. </p>
<p>When creating an index from an LDAP query, remember the following
considerations:</p>
<ul><li><p>Because LDAP structures vary greatly, you must know the
directory schema of the server and the exact name of every LDAP
attribute that you intend to use in a query.</p>
</li>
<li><p>The records on an LDAP server can be subject to frequent
change.</p>
</li>
</ul>
<p>In the following example, the search criterion is records with
a telephone number in the 617 area code. Generally, LDAP servers
use the Distinguished Name (<samp class="codeph">dn</samp>) attribute as the
unique identifier for each record so that attribute is used as the <samp class="codeph">key</samp> value
for the index. </p>
<pre>&lt;!--- Run the LDAP query. ---&gt; 
&lt;cfldap name="OrgList" 
    server="myserver" 
    action="query" 
    attributes="o, telephonenumber, dn, mail" 
    scope="onelevel" 
    filter="(|(O=a*) (O=b*))" 
    sort="o" 
    start="c=US"&gt; 
 
&lt;!--- Output query record set. ---&gt; 
&lt;cfoutput query="OrgList"&gt; 
    DN: #dn# &lt;br&gt; 
    O: #o# &lt;br&gt; 
    TELEPHONENUMBER: #telephonenumber# &lt;br&gt; 
    MAIL: #mail# &lt;br&gt; 
=============================&lt;br&gt; 
&lt;/cfoutput&gt; 
 
&lt;!--- Index the record set. ---&gt; 
&lt;cfindex action="update" 
    collection="ldap_query" 
    key="dn" 
    type="custom" 
    title="o" 
    query="OrgList" 
    body="telephonenumber"&gt; 
 
&lt;!--- Search the collection. ---&gt; 
&lt;!--- Use the wildcard * to contain the search string. ---&gt; 
&lt;cfsearch collection="ldap_query" 
    name="s_ldap" 
    criteria="*617*" 
    maxrows = "100"&gt; 
 
&lt;!--- Output returned records. ---&gt; 
&lt;cfoutput query="s_ldap"&gt; 
    #Key#, #Title#, #Body# &lt;br&gt; 
&lt;/cfoutput&gt;</pre>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0ef2f-7fdc" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0ef2f-7fdc"><!-- --></a><h2 class="topictitle2">Indexing cfpop query results</h2><div><p>The
contents of mail servers are volatile; specifically, the message
number is reset as messages are added and deleted. To avoid mismatches
between the unique message number identifiers on the server and
in the Verity collection, reindex the collection before processing
a search.</p>
<p>As with the other query types, provide a unique value for the <samp class="codeph">key</samp> attribute
and enter the data fields to index in the <samp class="codeph">body</samp> attribute.</p>
<p>The following example updates the pop_query collection with the
current mail for user1, and searches and returns the message number
and subject line for all messages that contain the word <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">action</i>:</p>
<pre>&lt;!--- Run POP query. ---&gt; 
&lt;cfpop action="getall" 
    name="p_messages" 
    server="mail.company.com" 
    userName="user1" 
    password="user1"&gt; 
 
&lt;!--- Output POP query record set. ---&gt; 
&lt;cfoutput query="p_messages"&gt; 
    #messagenumber# &lt;br&gt; 
    #from# &lt;br&gt; 
    #to# &lt;br&gt; 
    #subject# &lt;br&gt; 
    #body# &lt;br&gt; 
&lt;hr&gt; 
&lt;/cfoutput&gt; 
 
&lt;!--- Index record set. ---&gt; 
&lt;cfindex action="refresh" 
    collection="pop_query" 
    key="messagenumber" 
    type="custom" 
    title="subject" 
    query="p_messages" 
    body="body"&gt; 
 
&lt;!--- Search messages for the word "action". ---&gt; 
&lt;cfsearch collection="pop_query" 
    name="s_messages" 
    criteria="action" 
    maxrows = "100"&gt; 
     
&lt;!--- Output search record set. ---&gt; 
&lt;cfoutput query="s_messages"&gt; 
    #key#, #title# &lt;br&gt; 
&lt;/cfoutput&gt;</pre>
</div></div>


<!-- BEGIN USER PREFERENCES -->
          <div id="userprefs">
          </div>
<!-- END USER PREFERENCES -->

          <div id="related">
            
            
            <div class="separator"><a href="#top"><img src="images/BTT.jpg" /></a>&#160;</div>
          </div>
          <div id="footer">
<!-- BEGIN IONCOMMENTS -->
            <div id="ionComHere">
            </div>
<!-- END IONCOMMENTS -->


            <p id="creativecommons"><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text"><img id="creativecommons_img" src="images/CC.png" alt="This work is licensed under a Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License" /></a>&nbsp;Twitter™ and Facebook posts are not covered under the terms of Creative Commons.</p>
          </div>
</td>
<td width="10px"></td>
<td id="inner_rightcolumn">

</td></tr></table>
      </div>
<!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc3ff6d0ea77859461172e0811cbec0ef2f-7ff6.html" title="Enhancing search results"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc3ff6d0ea77859461172e0811cbec22c24-7b4a.html" title="Using Verity Search Expressions"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Developing&#160;ColdFusion 9 Applications</b></a> / <a href="WS8f0cc78011fffa7168855f811cdb0b0cce-8000.html"><b>Accessing and Using Data</b></a> 
      / <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7b7e.html"><b>Building a Search Interface</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
<!-- END CONTENT WRAPPER -->

</td>
<td id="col3">
    <div>
        <img src="images/adobe-lq.png" />
    </div>
</td>
</tr>
</table>
    </div>
<!-- END PAGE CONTENT WRAPPER -->
<script type="text/javascript">
<!--[CDATA[
scrollToNameAnchor();
// ]]-->
</script> 
<!--
    Description:
    This file generates the link to product support in the top right corner
-->

<style>
#menutop{
    position:absolute;
    top:4px;
    right:24px;
    width:auto;    
    font-size:11px;
    color:#fff;
    text-align:right;
}
#menutop a{
    color:#fff;
}
#menutop a:hover{
        text-decoration:underline;
}
</style>  
  
  
  
  
<div id="productmenu">
<!--googleoff: index-->
  <div id="menutop">


<script language=javascript type='text/javascript'>
    // darken menu text for products with light backgrounds
    var path = document.location.href.toLowerCase();
    if (path.indexOf("/acrobat/")           	> 0 ||
        path.indexOf("/acrobat.com/")       	> 0 ||
        path.indexOf("/acrobatConnectPro/") 	> 0 ||
        path.indexOf("/connect/")           	> 0 ||
        path.indexOf("/livecycledataserviceses/") > 0 ||
        path.indexOf("/muse/")         	> 0 ||
	path.indexOf("/presenter/")         	> 0 ||
        path.indexOf("/scene7/")            	> 0 ||
        path.indexOf("/flashmediaserver/")  	> 0 ||
        path.indexOf("/wave/")              	> 0 )
    {
        document.write('<style>#menutop a{color:#505050}</style>');
    }
    if (typeof('terms_AHV_PRODUCT_SUPPORT') != "undefined" && ! use_robohelp_behavior ){      
        if (path.indexOf("/muse/") > -1 ){
            var supportlink = '<a href="http://muse.adobe.com/support.html">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }else{
            var supportlink = '<a href="http://adobe.com/support">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }
        document.write( supportlink );
     }

</script> 

  </div>
<!--googleon: index-->
</div>



<style>
#online-privacy-policy{ 
    margin:10px 40px; 
    font-size:11px;
}
</style>

<p id="online-privacy-policy">
<script language="javascript">
var pageLoc = "en_US";
var metaElements = document.all ?
document.all.tags('meta') :
document.getElementsByTagName ?
document.getElementsByTagName ('meta') : new Array();
for (var m = 0; m < metaElements.length; m++) {
	if (metaElements[m].name == "lang") {
		pageLoc = metaElements[m].content;
		break;
	}
}
var ptn = /(..)-(..)/;
if (ptn.test(pageLoc)) {
	var languageCode = pageLoc.replace(ptn, "$1");
	var countryCode = pageLoc.replace(ptn, "$2");
	pageLoc = languageCode + "_" + countryCode.toUpperCase();
}

var policyLoc = "en_US";
var policyText = "Online Privacy Policy";
var policyPath = "";
var policyArray=[
"da_DK", "Online fortrolighedserklæring",
"de_DE", "Online-Datenschutzrichtlinie",
"es_ES", "Política de confidencialidad en línea",
"fi_FI", "Yksityisyyttä koskeva Online-toimintaohjelma",
"fr_FR", "Confidentialité et sécurité",
"it_IT", "Informativa sulla privacy online",
"ja_JP", "プライバシーポリシー",
"ko_KR", "Adobe 온라인 개인정보 보호정책",
"pt_BR", "Política de Confidencialidade On-line", 
"zh_CN", "在线隐私政策",
"zh_TW", "線上隱私政策"
];
var legalLoc = "en_US";
var legalText = "Legal Notices";
var legalPath = legalLoc;
var legalArray=[
"ar_AE", "إشعارات قانونية",
"bg_BG", "Юридически бележки",
"cs_CZ", "Právní upozornění",
"da_DK", "Juridiske meddelelser",
"de_DE", "Rechtliche Hinweise",
"el_GR", "Σημειώσεις νομικού περιεχομένου",
"es_ES", "Avisos legales",
"et_EE", "Juriidilised teated",
"fi_FI", "Lakisääteiset ilmoitukset",
"fr_FR", "Mentions légales",
"he_IL", "הצהרות משפטיות",
"hr_HR", "Pravne napomene",
"hu_HU", "Jogi közlemények",
"it_IT", "Informazioni legali",
"ja_JP", "法律上の注意",
"ko_KR", "법적 고지 사항",
"lt_LT", "Teisinės pastabos",
"lv_LV", "Juridisks paziņojums",
"nb_NO", "Juridiske merknader",
"nl_NL", "Juridische kennisgevingen",
"pl_PL", "Informacje prawne",
"pt_BR", "Aspectos jurídicos",
"ro_RO", "Prevederi legale",
"ru_RU", "Юридическая информация",
"sk_SK", "Právne upozornenie",
"sl_SI", "Pravni pouk",
"sv_SE", "Upphovsrätt",
"tr_TR", "Yasal uyarılar",
"uk_UA", "Юридична інформація",
"zh_CN", "法律声明",
"zh_TW", "法律注意事項"
];

ruPolicy = "http://www.adobe.com/ru/misc/privacy.html";
trPolicy = "http://www.adobe.com/tr/misc/privacy.html";

// Bug 2846992: LOC: RUS, TUR: The link to "Online Privacy Policy" should include language, currently it is not appearing.
if (pageLoc == "ru_RU") {
	policyPath = "ru";
}
else if (pageLoc == "tr_TR") {
	policyPath = "tr";
}
for (var i = 0; i < policyArray.length; i+=2) {
	if (pageLoc == policyArray[i]) {
		policyLoc = pageLoc;
		policyText = policyArray[i+1];
		var ptn = /(..)_(..)/;
		if (ptn.test(policyLoc)) {
			var countryCode = policyLoc.replace(ptn, "$2");
			policyPath = countryCode.toLowerCase();
		}
		break;
	}
}

for (var i = 0; i < legalArray.length; i+=2) {
	if (pageLoc == legalArray[i]) {
		legalLoc = pageLoc;
		legalText = legalArray[i+1];
		legalPath = legalLoc;
		break;
	}
}
if(agt.indexOf("community help client") > -1 ){
	document.write('<a href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
}else{
	//Open the privacy policy in a new window
	document.write('<a target="_blank" href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a target="_blank" href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
} 
</script>
</p>



<!-- localfooter.ssi -->

<script type="text/javascript">
    var debug = (top.location.href.indexOf("debug=true") > -1);
</script>

<script language="javascript">
document.write('<scr'+'ipt ' +
               'src="/en_US/ssi/_pod.js" ' +
               'language="javascript" ' +
               'charset="UTF-8"> ' +
               '</scr'+'ipt>');
</script>


<script type="text/javascript">
//
//  Ethnio survey code
//
/*          DocumentID      EthnioID */
/*          -------------   -------- */
var ethnio=["/en_US/flash/cs/using/WSb03e830bd6f770ee6664507612436d7dede-8000.html", "87462",
            "/en_US/creativesuite/cs/using/WSe851854fd1e0856a-4b08a77612477f69f15-8000.html",  "10441",
            "/en_US/dreamweaver/cs/using/WSEE4C0148-A6F4-4bf5-9DEF-CE06AB026214a.html",  "57412"
 
    ];
                        
    for ( var i = 0; i < ethnio.length ; i = i+2 ){
        if ( document.location.href.indexOf( ethnio[i] ) > -1 ){ 
            var headID = document.getElementsByTagName("head")[0];         
            var ethnioScript = document.createElement('script');
            ethnioScript.type = 'text/javascript';
            ethnioScript.src = 'http://ethn.io/remotes/' + ethnio[i+1];        
            if ( debug ){
                alert ("Using Ethnio script: " + ethnioScript.src );
            }else{
                headID.appendChild(ethnioScript);
            }
        }
    }
</script>



<div style="display: none;">
<!-- SiteCatalyst -->
<script language="JavaScript" type="text/javascript"><!--
var s_code=' ';
var s_docHost = window.location.hostname.toLowerCase();
var s_docURL = window.location.pathname.toLowerCase();
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
if (s_docHost.indexOf(".corp.adobe") != -1 || s_docHost.indexOf("stage.") != -1 || s_docHost.indexOf(".dev.adobe") != -1 || s_docHost.indexOf("staging.") != -1) scJsHost="";
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/omniture_s_code.js' type='text/javascript'%3E%3C/script%3E"));
//--></script>
<script type="text/javascript"><!--
var s_accountName;
s_server="www.adobe.com static content pages";
if (!window.s_account) s_accountName="mxmacromedia";
else s_accountName=window.s_account;

if (window.s_docURL.indexOf("/designcenter/") != -1)
  s_channel="Adobe Design Center";	
else if ((window.s_docHost.indexOf("labs.adobe") != -1) ||
(window.s_docHost.indexOf("labs-staging.") != -1))
  s_channel="Labs";
else if (window.s_docHost.indexOf("help.adobe.com") != -1) {
  s_channel="Support Help.adobe.com";
  if (window.s_docURL.indexOf("/en_us/") == -1) {
    s_docURLArray=s_docURL.split('/');
    s_pageName="http://help.adobe.com/"+s_docURLArray[1]+"/"+ s_docURLArray[2]+"/"+s_docURLArray[3];
    s_prop23="http://help.adobe.com"+window.location.pathname;
  }
}
else if (window.s_docHost.indexOf("kb2.adobe.com") != -1) {
  s_channel="Support Knowledgebase";
  s_prop23="http://kb2.adobe.com"+s_docURL+":";
  if (typeof(omtrProductList) != 'undefined' && omtrProductList.length > 0)
 {
    s_prop23=s_prop23+omtrProductList;
  }
}
else if (window.s_docHost.indexOf("resellers.adobe.com") != -1) {
		var s_pageName=document.getElementsByTagName("title")[0].text;
}

if (!window.scMMInclude) {
	var s_wd=window,s_tm=new Date;
	if(s_code!=' '){
		s_code=s_dc(s_accountName);
		if(s_code)document.write(s_code)
	} 
} else {
	s_wds(s_accountName);s_ca(s_accountName); 
}	

function sendAnalyticsEvent(str){var ns=s_accountName;if(str!=null)ns+=","+str;void(s_gs(ns));}
function sendLinkEvent(accnt,lnkname,type){
accnt=s_accountName;s_linkType=type;s_lnk=true;s_linkName=lnkname;void(s_gs(accnt));}
//--></script>
<noscript><img src="http://stats.adobe.com/b/ss/mxmacromedia/1/H.15-XELvs/0?pageName=http%3A//www.adobe.com%3A%20noscript&ch=http%3A//www.adobe.com%3A%20noscript&g=http%3A//www.adobe.com" height="1" width="1" border="0" alt="" /></noscript>
<!-- End SiteCatalyst -->
</div>

<script language="JavaScript" type="text/javascript">//<![CDATA[
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/atm/s_code_www.js' type='text/javascript'%3E%3C/script%3E"));
//]]></script>
<script type="text/javascript">//<![CDATA[
if(s_adobe){	
	s_adobe.server="www.adobe.com Static Content pages";
	/* Set pageName */
	s_adobe.s_URL="adobe.com"+((location.pathname.charAt(0)=='/')?location.pathname:'/'+location.pathname);
	if (s_adobe.s_URL.substring(s_adobe.s_URL.lastIndexOf('/')+1)=="") s_adobe.s_URL=s_adobe.s_URL+"index.html";
	s_adobe.s_URLSplit=s_adobe.s_URL.split("/");
	s_adobe.pageName=s_adobe.s_URLSplit.join(":");

	/* Set prop4 to language-locale */
	var s_meta=document.getElementsByTagName('meta'); 
      for (i=0; i<s_meta.length; i++) { 
        if (s_meta[i].getAttribute("http-equiv") == "Content-Language") { 
          s_adobe.prop4=s_meta[i].getAttribute("content"); 
	    s_adobe.prop4=s_adobe.prop4.replace(/\s+/g,'');
        } 
      } 
	s_adobe.t()
}
//]]></script>








  </body>
</html>