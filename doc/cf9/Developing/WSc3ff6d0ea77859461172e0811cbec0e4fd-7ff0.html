<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="lang" content="en-us" />
    <meta name="area" content="livedocs" />
    <title>Adobe&#160;ColdFusion&#160;9 * Query of Queries user guide</title>
    <link rel="shortcut icon" href="images/ColdFusionLinkIndicator.png" />
    <meta name="book" content="Developing&#160;ColdFusion 9 Applications" />
    <meta name="product" content="ColdFusion" />
    <meta name="keywords" content="" /><!--<PageMap><DataObject type="document"><Attribute name="product" value="ColdFusion"></Attribute><Attribute name="book" value="Developing&#160;ColdFusion 9 Applications"></Attribute><Attribute name="keywords" value=""></Attribute></DataObject></PageMap>-->
    
    <script type="text/javascript" language="Javascript" charset="UTF-8"><!--[CDATA[
        var currentTreeNode = "WSc3ff6d0ea77859461172e0811cbec0e4fd-7ff0.html";
    document.cookie = "topicId=" + "WSc3ff6d0ea77859461172e0811cbec0e4fd-7ff0.html";
// ]]--></script>
<script src="terms.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="help.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script>  <script src="utilities.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="event.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="treeview.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="toc.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script> <script src="swfobject.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>  <script src="booklist.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>
<script type="text/javascript">
<!--[CDATA[
var topictype = "topic";
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
  var linkId = document.createElement("link");
  linkId.href = "content-ie6.css";
  linkId.rel = "stylesheet";
  linkId.type = "text/css";
  headId.appendChild(linkId);
}
function initRoboHelpDOM() {
  if (use_chm_behavior) {
    hideElement("search");
  }
  if (use_robohelp_behavior) {
    hideElement("search");
    hideElement("productmenu");
    //hideElement("notyourversion");
  }
  if(!use_chc_behavior) {
    //document.getElementById("notyourversion").style.display = "inline";;
  }
}
var dirname = location.pathname.match( /.*\// );    
function setSearchUserPref(){
  if ( document.cookie.indexOf( "ah_searchpref" ) > -1 ) {
    if ( document.cookie.indexOf( dirname ) > 0 ) {
      document.search.gsa.checked = true ;
    }else{
      document.search.gsa.checked = false ;            
    }
  }
}
YAHOO.util.Event.onDOMReady(initRoboHelpDOM);
YAHOO.util.Event.onDOMReady(setSearchUserPref);
// ]]-->
</script>

<!-- ********************************** -->
<!-- START: ForeSee survey code in: /ssi/globalheader.ssi -->

<script type="text/javascript">
<!-- 
// Enable the survey for only English, German and Japanese
var agt=navigator.userAgent.toLowerCase();
if ( agt.indexOf("community help client") == -1 ){
    if ( document.location.href.indexOf("/en_US/") != -1 ){
        showSurvey();
//    }else if (document.location.href.indexOf("/de_DE/") != -1){
//         var locale="de";
//         showSurvey();
    }else if (document.location.href.indexOf("/ja_JP/") != -1 ){
         var locale="ja";
         showSurvey();
    }	
}

function showSurvey(){
	document.write('<script type="text/javascript" src="/js/foresee/foresee-trigger.js"><\/scr'+'ipt>');
}

// -->
</script>

<!-- END: ForeSee survey code -->
<!-- ******************************** -->




    <link rel="stylesheet" type="text/css" href="tree.css" />
    <link rel="stylesheet" type="text/css" href="content.css" />
    <link rel="stylesheet" type="text/css" href="localeSpecific.css" />
  </head>
  <body id="content_body" onload="window.focus();">
    <a name="top" shape="rect"><!--LeaveCommentHere--></a>
    
    <div id="mnemonic">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon" class="ColdFusion"><div class="banner"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html">Adobe&#160;ColdFusion&#160;9</a><span id="notyourversion">|&#160;
                    <a rel="nofollow" href="http://www.adobe.com/support/documentation/en/coldfusion/">Not your version?</a></span></div></div><!--googleon: index-->
    </div>
    
    <div id="searchbar">
<table id="searchbartable">
<tr>
<td colspan="2">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon"><div id="pdf"><img src="images/PDF.gif" width="16" height="16" /><a title="View Help PDF" href="coldfusion_9_dev.pdf">View Help PDF ( 23MB)</a></div></div><!--googleon: index-->
</td>
</tr>
</table>
    </div>

<!-- BEGIN SEARCH CONTENT -->
<form id="search" name="search" action="search.html" target="_self">
<script type="text/javascript">
<!--[CDATA[
if ( !use_chc_behavior ){
    if (typeof(terms_AHV_SEARCH_CONSTRAINT) != "undefined" && 
        terms_AHV_SEARCH_CONSTRAINT.length > 0 && 
        document.location.href.indexOf(".adobe.com") > 0){
        if ( typeof(terms_SEARCH_THIS_HELP_ONLY) != "undefined" && terms_SEARCH_THIS_HELP_ONLY == "ON" ) {
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                checked="checked" \
                value="1" ><\/input>'); 
                
        // Leave the "Search this help system only" checkbox unckecked
        }else{    
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                value="1" ><\/input>'); 
        }
        document.write('<span class="gsalabel">' + terms_AHV_SEARCH_CONSTRAINT + '<\/span><\/div>'); 
    }
    document.write('<input class="searchinput" \
        name="q" \
        id="q" \
        type="text" \
        maxlength="256" \
        value="' + terms_AHV_SEARCH_BUTTON + '" \
        onclick="clearSearch()"><\/input><input \
        type="button" \
        name="searchbutton" \
        class="searchbutton" \
        onclick="submit()"><\/input>'); 
} 
 
/* 
 * Start Functions 
 */
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}

// set search preferences
function setAHSearchPref(){
    if (document.search.gsa.checked == 1){
        setAHSearchCookie( dirname );
    }else{
        setAHSearchCookie( "community" );
    }
}

// Set search preferences cookie
function setAHSearchCookie( p ){
    // set cookie ah_searchpref with a value of the document path
    var expire=new Date();
    expire.setDate(expire.getDate()+365); // Cookie expires after 1 year (365 days) 
    document.cookie="ah_searchpref=" +p+ "; expires=" +expire.toGMTString()+ ";";
}

// ]]-->
</script> 
 </form>
<!-- END SEARCH CONTENT -->    



<!-- BEGIN PAGE CONTENT WRAPPER -->
    <div id="page_content_wrapper">
<!-- BEGIN PAGE WRAPPER -->
<table id="page_content_table">
<tr>

<td id="col2">
<!-- BEGIN CONTENT WRAPPER -->
<!-- BEGIN BREADCRUMBS -->

      
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc3ff6d0ea77859461172e0811cbec0e4fd-7ff9.html" title="About Query of Queries"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc3ff6d0ea77859461172e0811cbec22c24-7c24.html" title="Managing LDAP Directories"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Developing&#160;ColdFusion 9 Applications</b></a> / <a href="WS8f0cc78011fffa7168855f811cdb0b0cce-8000.html"><b>Accessing and Using Data</b></a> 
      / <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7bb8.html"><b>Using Query of Queries</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
      <div id="content_wrapper">
<!-- BEGIN PAGE TITLE -->
        <h1>Query of Queries user guide</h1>
<!-- END PAGE TITLE -->
<!-- BEGIN IONCOMMENTCOUNT -->
        <div id="ionCount">
        </div>
<!-- END IONCOMMENTCOUNT -->
<table id="inner_content_table" width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td>
          <div style="border-top:#ccc solid 1px;"><p> </p>
          </div>
<p id="chcPromo" style="display:none;">
<a id="chcLink" href="http://www.adobe.com/support/chc/">
<img id="chcImage" src="http://www.adobe.com/support/chc/GetMoreHelpFeatures.png"/>
</a>
</p>
<script type="text/javascript" language="javascript" charset="utf-8">
<!--
var cfgArray = [];
//cfgArray["Acrobat_10.0_Professional.helpcfg"] = "acrobatpro";
//cfgArray["Acrobat_10.0_Standard.helpcfg"] = "acrobatstd";
cfgArray["Lightroom_3.0.helpcfg"] = "lightroom";
cfgArray["PhotoshopElements_8.0_Win.helpcfg"] = "photoshopelements";
cfgArray["PhotoshopElements_8.0_Mac.helpcfg"] = "photoshopelementsmac";
cfgArray["PremiereElements_8.0_Win.helpcfg"] = "premiereelements";

//cfgArray["AfterEffects_10.0.helpcfg"] = "aftereffects";
//cfgArray["AIR.helpcfg"] = "air";
//cfgArray["ColdFusionBuilder.helpcfg"] = "coldfusion";
//cfgArray["Contribute_6.0.helpcfg"] = "contribute";
//cfgArray["DeviceCentral_3.0.helpcfg"] = "devicecentral";
//cfgArray["Dreamweaver_11.0.helpcfg"] = "dreamweaver";
//cfgArray["EncoreDVD_5.0.helpcfg"] = "encore";
//cfgArray["ExtensionManager_3.0.helpcfg"] = "extension";
//cfgArray["Fireworks_11.0.helpcfg"] = "fireworks";
//cfgArray["Flash_11.0.helpcfg"] = "flash";
//cfgArray["Flex_4.0.helpcfg"] = "flashbuilder";
//cfgArray["FlashCatalyst_1.0.helpcfg"] = "flashcatalyst";
//cfgArray["Illustrator_15.0.helpcfg"] = "illustrator";
//cfgArray["InCopy_7.0.helpcfg"] = "incopy";
//cfgArray["InDesign_7.0.helpcfg"] = "indesign";
//cfgArray["OnLocation_5.0.helpcfg"] = "onlocation";
//cfgArray["Photoshop_12.0.helpcfg"] = "photoshop";
//cfgArray["PremierePro_5.0.helpcfg"] = "premierepro";

function getLangName() {
    var lang = "en-us";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if (ptn.test(lang)) {
        var languageCode = lang.replace(ptn, "$1");
        var countryCode = lang.replace(ptn, "$2");
        lang = languageCode + "_" + countryCode.toUpperCase();
    }
    return lang;
}

function getCountryName() {
    var lang = "";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if ((ptn.test(lang)) && (lang != "en-us")) {
        var countryCode = lang.replace(ptn, "$2");
        return "/" + countryCode;
    }
    return "";
}

if ( (typeof(terms_HELPCFG) != 'undefined')  && (terms_HELPCFG.indexOf(".helpcfg") != -1) ) {
    var stage   = (document.location.href.indexOf(".stage.") != -1) ? 'stage.' : '';
    var baseUrl = 'http://www.' + stage + 'adobe.com';
    var refpage = document.location.href.replace(/#.*$/, '');
	
	if ((!use_robohelp_behavior) && (terms_HELPCFG.length > 0) && (typeof(cfgArray[terms_HELPCFG]) != 'undefined') && (cfgArray[terms_HELPCFG].length > 0)) {
		if (document.getElementById) { // DOM3 = IE5, NS6
			var newHref = baseUrl + getCountryName() + "/support/chc/" + "?helpcfg=http://help." + stage + "adobe.com/HelpCfg/" + getLangName() + "/" + terms_HELPCFG + "&url=" + refpage + "&product=" + cfgArray[terms_HELPCFG];
			var newSrc = baseUrl + getCountryName() + "/support/chc/GetMoreHelpFeatures.png";
			document.getElementById("chcPromo").style.display = "block";
			document.getElementById("chcLink").href = newHref;
			document.getElementById("chcImage").src = newSrc;
		}
	}
}

//-->
</script>



          <div id="minitoc"><div class="t"><div class="b"><div><ul id="minitoc-links"><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fff"><span class="topictitle1">Using dot notation</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fee"><span class="topictitle1">Using joins</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fed"><span class="topictitle1">Using unions</span>
</a></p><ul><li><p><a href="#WSf01dbd23413dda0e-473edbc812013c12636-7ffd"><span class="topictitle2">Using aliases for column names</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e-473edbc812013c12636-7ffc"><span class="topictitle2">Duplicate rows and multiple tables</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e-473edbc812013c12636-7ffb"><span class="topictitle2">Parentheses and evaluation order</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e-473edbc812013c12636-7ffa"><span class="topictitle2">Using other keywords with UNION</span>
</a></p></li></ul></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe7"><span class="topictitle1">Using conditional operators</span>
</a></p><ul><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe6"><span class="topictitle2">Test conditional</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe3"><span class="topictitle2">Null conditional</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe0"><span class="topictitle2">Comparison conditional</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fdd"><span class="topictitle2">BETWEEN conditional</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fda"><span class="topictitle2">IN conditional</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd7"><span class="topictitle2">LIKE conditional</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd4"><span class="topictitle2">Case sensitivity</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd2"><span class="topictitle2">Escaping wildcards</span>
</a></p></li></ul></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec22c24-627b"><span class="topictitle1">Managing data types for columns</span>
</a></p><ul><li><p><a href="#WSF1685330-45B9-4bcd-9087-04F8F1B56B44"><span class="topictitle2">Specify column data types in the QueryNew function</span>
</a></p></li><li><p><a href="#WS5227A9F8-A34A-4171-96E7-ED19C1468366"><span class="topictitle2">Specify the column data types in the QueryAddColumn function</span>
</a></p></li></ul></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec22c24-7b7b"><span class="topictitle1">Using the CAST function</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fcc"><span class="topictitle1">Using aggregate functions</span>
</a></p><ul><li><p><a href="#WSf01dbd23413dda0e-473edbc812013c12636-7ff9"><span class="topictitle2">Arbitrary expressions in aggregate functions</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e-473edbc812013c12636-7ff8"><span class="topictitle2">Aggregate functions in arbitrary expressions</span>
</a></p></li></ul></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc7"><span class="topictitle1">Using group by and having expressions</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc5"><span class="topictitle1">Using ORDER BY clauses</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc2"><span class="topictitle1">Using aliases</span>
</a></p><ul><li><p><a href="#WS1615079D-5ECA-4b02-8268-7920E74072DD"><span class="topictitle2">Examples</span>
</a></p></li></ul></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fbd"><span class="topictitle1">Handling null values</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fbc"><span class="topictitle1">Concatenating strings</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec22c24-7008"><span class="topictitle1">Escaping reserved keywords</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fb9"><span class="topictitle1">Using Queries of Queries with dates</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0e4fd-7fb8"><span class="topictitle1">Understanding Query of Queries performance</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec22c24-7b7a"><span class="topictitle1">Understanding Query of Queries processing</span>
</a></p><ul><li><p><a href="#WSf01dbd23413dda0e-473edbc812013c12636-7ff7"><span class="topictitle2">Comparing columns with different data types</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e-473edbc812013c12636-7ff6"><span class="topictitle2">Passing queries by reference</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e-473edbc812013c12636-7ff5"><span class="topictitle2">Managing complex objects</span>
</a></p></li></ul></li></ul></div></div></div></div><div><p>If you know SQL or have interacted with
databases, you might be familiar with some of the Query of Queries
functionality.</p>
</div>
<div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fff" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fff"><!-- --></a><h2 class="topictitle2">Using dot notation</h2><div><p>Query
of Queries supports using dot notation in table names.</p>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fff__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fef"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fff__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fef"><!-- --></a><h4 class="sectiontitle">Example</h4><p>If
a structure named A contains a field named B, which contains a table
named Products, you can refer to the table with dot notation, as
follows:</p>
<pre>SELECT tape_ID, length 
FROM A.B.Products;</pre>
</div>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fee" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fee"><!-- --></a><h2 class="topictitle2">Using joins</h2><div><p>A join operation uses a single
SELECT statement to return a result set from multiple, related tables,
typically those tables with a primary key - foreign key relationship.
The two SQL clauses that perform joins are:</p>
<ul><li><p><strong>WHERE clause</strong>: Query of Queries supports joins
through a WHERE clause.</p>
</li>
<li><p><strong>INNER JOIN and OUTER JOIN</strong>: Query of Queries does not
support joins through INNER JOIN or OUTER JOIN clauses.</p>
</li>
</ul>
<div class="note"><span class="notetitle">Note:  </span>Query of Queries supports joins between two
tables only.</div>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fed" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fed"><!-- --></a><h2 class="topictitle2">Using unions</h2><div><p>The UNION operator lets you combine
the results of two or more SELECT expressions into a single recordset.
The original tables must have the same number of columns, and corresponding
columns must be UNION-compatible data types. Columns are UNION-compatible
data types if they meet one of the following conditions:</p>
<ul><li><p>The same data type; for example, both Tinyint</p>
</li>
<li><p>Both Numeric; for example, Tinyint, Smallint, Integer, Bigint,
Double, Float, Real, Decimal, or Numeric</p>
</li>
<li><p>Both Characters; for example, Char, Varchar, or LongVarchar</p>
</li>
<li><p>Both Dates; for example, Time, TimeStamp, or Date</p>
</li>
</ul>
<div class="note"><span class="notetitle">Note:  </span>Query Of Queries does not support ODBC-formatted
dates and times.</div>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fed__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fec"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fed__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fec"><!-- --></a><h4 class="sectiontitle">Syntax</h4><pre>select_expression = select_expression UNION [ALL] select_expression</pre>
</div>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fed__WSc3ff6d0ea77859461172e0811cbec0e4fd-7feb"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fed__WSc3ff6d0ea77859461172e0811cbec0e4fd-7feb"><!-- --></a><h4 class="sectiontitle">Example</h4><p>This
example uses the following tables:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th colspan="2" valign="top" id="d17e43500"><p>Table1</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e43500 "><p>Type(int)</p>
</td>
<td valign="top" width="NaN%" headers="d17e43500 "><p>Name(varchar)</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e43500 "><p>1</p>
</td>
<td valign="top" width="NaN%" headers="d17e43500 "><p>Tennis</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e43500 "><p>2 </p>
</td>
<td valign="top" width="NaN%" headers="d17e43500 "><p>Baseball</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e43500 "><p>3</p>
</td>
<td valign="top" width="NaN%" headers="d17e43500 "><p>Football</p>
</td>
</tr>
</tbody>
</table>
</div>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th colspan="2" valign="top" id="d17e43538"><p>Table2</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e43538 "><p>ID(int)</p>
</td>
<td valign="top" width="NaN%" headers="d17e43538 "><p>Sport(varchar)</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e43538 "><p>3</p>
</td>
<td valign="top" width="NaN%" headers="d17e43538 "><p>Football</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e43538 "><p>4</p>
</td>
<td valign="top" width="NaN%" headers="d17e43538 "><p>Volleyball</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e43538 "><p>5</p>
</td>
<td valign="top" width="NaN%" headers="d17e43538 "><p>PingPong</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>To combine Table1 and Table2, use a UNION
statement, as follows:</p>
<pre>SELECT * FROM Table1  
UNION  
SELECT * FROM Table2 </pre>
<p>The UNION statement produces
the following result (UNION) table:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th colspan="2" valign="top" id="d17e43582"><p>Result table</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e43582 "><p>Type(int)</p>
</td>
<td valign="top" width="NaN%" headers="d17e43582 "><p>Name(varchar)</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e43582 "><p>1</p>
</td>
<td valign="top" width="NaN%" headers="d17e43582 "><p>Tennis</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e43582 "><p>2 </p>
</td>
<td valign="top" width="NaN%" headers="d17e43582 "><p>Baseball</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e43582 "><p>3</p>
</td>
<td valign="top" width="NaN%" headers="d17e43582 "><p>Football</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e43582 "><p>4</p>
</td>
<td valign="top" width="NaN%" headers="d17e43582 "><p>Volleyball</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e43582 "><p>5</p>
</td>
<td valign="top" width="NaN%" headers="d17e43582 "><p>PingPong</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div id="WSf01dbd23413dda0e-473edbc812013c12636-7ffd" class="nochunk"><a name="WSf01dbd23413dda0e-473edbc812013c12636-7ffd"><!-- --></a><h3 class="topictitle3">Using aliases for column names</h3><div><p>The
column names of a UNION table are the column names in the result
set of the first SELECT statement in the UNION operation; Query
of Queries ignores the column names in the other SELECT statement.
To change the column names of the result table, you can use an alias,
as follows:</p>
<pre>Select Type as SportType, Name as SportName from Table1 
UNION 
Select * from Table2</pre>
</div></div><div id="WSf01dbd23413dda0e-473edbc812013c12636-7ffc" class="nochunk"><a name="WSf01dbd23413dda0e-473edbc812013c12636-7ffc"><!-- --></a><h3 class="topictitle3">Duplicate rows and multiple tables</h3><div><p>By default, the UNION operator removes duplicate rows from
the result table. If you use the keyword ALL, then duplicates are
included.</p>
<p>You can combine an unlimited number of tables using the UNION
operator, for example: </p>
<pre>Select * from Table1 
UNION  
Select * from Table2 
UNION  
Select * from Table3 
... </pre>
</div></div><div id="WSf01dbd23413dda0e-473edbc812013c12636-7ffb" class="nochunk"><a name="WSf01dbd23413dda0e-473edbc812013c12636-7ffb"><!-- --></a><h3 class="topictitle3">Parentheses and evaluation order</h3><div><p>By
default, the Query of Queries SQL engine evaluates a statement containing UNION
operators from left to right. You can use parentheses to change
the order of evaluation. For example, the following two statements
are different: </p>
<pre>/* First statement. */  
SELECT * FROM TableA 
UNION ALL  
<strong>(SELECT * FROM TableB </strong> 
    <strong>UNION </strong> 
    <strong>SELECT * FROM TableC</strong> 
<strong>) </strong> 
 
/* Second statement. */  
<strong>(SELECT * FROM TableA </strong> 
    <strong>UNION ALL </strong> 
    <strong>SELECT * FROM TableB </strong> 
<strong>) </strong> 
UNION  
SELECT * FROM TableC </pre>
<p>In the first statement, there are no duplicates in the union
between TableB and TableC. Then, in the union between that set and
TableA, the ALL keyword includes the duplicates. In the second statement,
duplicates are included in the union between TableA and TableB but
are eliminated in the subsequent union with TableC. The ALL keyword
has no effect on the final result of this expression. </p>
</div></div><div id="WSf01dbd23413dda0e-473edbc812013c12636-7ffa" class="nochunk"><a name="WSf01dbd23413dda0e-473edbc812013c12636-7ffa"><!-- --></a><h3 class="topictitle3">Using other keywords with UNION</h3><div><p>When you perform a UNION, the individual SELECT statements
cannot have their own ORDER BY or COMPUTE clauses. You can only
have one ORDER BY or COMPUTE clause after the last SELECT statement;
this clause is applied to the final, combined result set. You can
only specify GROUP BY and HAVING expressions in the individual SELECT
statements. </p>
</div></div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe7" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe7"><!-- --></a><h2 class="topictitle2">Using conditional operators</h2><div><p>Query of Queries lets you use the following conditional
operators in your SQL statements:</p>
</div><div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe6" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe6"><!-- --></a><h3 class="topictitle3">Test conditional</h3><div><p>This conditional tests whether a Boolean expression is
True, False, or Unknown. </p>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe6__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe5"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe6__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe5"><!-- --></a><h4 class="sectiontitle">Syntax</h4><pre>cond_test ::= expression [IS [NOT] {TRUE | FALSE | UNKNOWN} ]</pre>
</div>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe6__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe4"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe6__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe4"><!-- --></a><h4 class="sectiontitle">Example</h4><pre>SELECT _isValid FROM Chemicals 
WHERE _isValid IS true;</pre>
</div>
</div></div><div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe3" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe3"><!-- --></a><h3 class="topictitle3">Null conditional</h3><div><p>This conditional tests whether an expression is null.</p>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe3__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe2"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe3__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe2"><!-- --></a><h4 class="sectiontitle">Syntax</h4><pre>null_cond ::= expression IS [NOT] NULL </pre>
</div>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe3__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe1"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe3__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe1"><!-- --></a><h4 class="sectiontitle">Example</h4><pre>SELECT bloodVal FROM Standards 
WHERE bloodVal IS NOT null;</pre>
</div>
</div></div><div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe0" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe0"><!-- --></a><h3 class="topictitle3">Comparison conditional</h3><div><p>This conditional lets you compare an expression against
another expression of the same data type (Numeric, String, Date,
or Boolean). You can use it to selectively retrieve only the relevant
rows of a recordset.</p>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe0__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fdf"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe0__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fdf"><!-- --></a><h4 class="sectiontitle">Syntax</h4><pre>comparison_cond ::= expression [&gt; | &gt;= | &lt;&gt; | != | &lt; | &lt;=] expression </pre>
</div>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe0__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fde"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fe0__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fde"><!-- --></a><h4 class="sectiontitle">Example</h4><p>The
following example uses a comparison conditional to retrieve only
those dogs whose IQ is at least 150:</p>
<pre>SELECT dog_name, dog_IQ 
FROM Dogs 
WHERE dog_IQ &gt;= 150;</pre>
</div>
</div></div><div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fdd" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fdd"><!-- --></a><h3 class="topictitle3">BETWEEN conditional</h3><div><p>This conditional lets you compare an expression against
another expression. You can use it to selectively retrieve only
the relevant rows of a recordset. Like the comparison conditional,
the BETWEEN conditional also compares; however, the BETWEEN conditional
compares against a range of values. Therefore, its syntax requires
two values, which are inclusive, a minimum and a maximum. Separate these
values with the AND keyword.</p>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fdd__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fdc"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fdd__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fdc"><!-- --></a><h4 class="sectiontitle">Syntax</h4><pre>between_cond ::= expression [NOT] BETWEEN expression AND expression </pre>
</div>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fdd__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fdb"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fdd__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fdb"><!-- --></a><h4 class="sectiontitle">Example</h4><p>The
following example uses a BETWEEN conditional to retrieve only those
dogs whose IQ is between 150 and 165, inclusive:</p>
<pre>SELECT dog_name, dog_IQ 
FROM Dogs 
WHERE dog_IQ BETWEEN 150 AND 165;</pre>
</div>
</div></div><div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fda" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fda"><!-- --></a><h3 class="topictitle3">IN conditional</h3><div><p>This conditional lets you specify a comma-delimited list
of conditions to match. It is similar in function to the OR conditional.
In addition to being more legible when working with long lists,
the IN conditional can contain another SELECT statement.</p>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fda__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd9"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fda__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd9"><!-- --></a><h4 class="sectiontitle">Syntax</h4><pre>in_cond ::= expression [NOT] IN (expression_list) </pre>
</div>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fda__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd8"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fda__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd8"><!-- --></a><h4 class="sectiontitle">Example</h4><p>The
following example uses the IN conditional to retrieve only those
dogs who were born at either Ken’s Kennels or Barb’s Breeders:</p>
<pre>SELECT dog_name, dog_IQ, Kennel_ID 
FROM Dogs 
WHERE kennel_ID IN ('Kens','Barbs');</pre>
</div>
</div></div><div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd7" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd7"><!-- --></a><h3 class="topictitle3">LIKE conditional</h3><div><p>This conditional lets you perform wildcard searches, in
which you compare your data to search patterns. This strategy differs
from other conditionals, such as BETWEEN or IN, because the LIKE
conditional compares your data to a value that is partially unknown.</p>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd7__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd6"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd7__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd6"><!-- --></a><h4 class="sectiontitle">Syntax</h4><pre>like_cond ::= left_string_exp [NOT] LIKE right_string_exp [ESCAPE escape_char] </pre>
<p>The
left_string_exp can be either a constant string, or a column reference
to a string column. The right_string_exp can be either a column
reference to a string column, or a search pattern. A <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">search pattern</i> is
a search condition that consists of literal text and at least one
wildcard character. A <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">wildcard character</i> is a special character
that represents an unknown part of a search pattern, and is interpreted as
follows: </p>
<ul><li><p>The underscore (_) represents any single
character. </p>
</li>
<li><p>The percent sign (%) represents zero or more characters.</p>
</li>
<li><p>Brackets [ ] represents any character in the range.</p>
</li>
<li><p>Brackets with a caret [^] represent any character not in
the range.</p>
</li>
<li><p>All other characters represent themselves. </p>
</li>
</ul>
<div class="note"><span class="notetitle">Note:  </span>Earlier versions of ColdFusion do not support
bracketed ranges.</div>
</div>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd7__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd5"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd7__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd5"><!-- --></a><h4 class="sectiontitle">Examples</h4><p>The
following example uses the LIKE conditional to retrieve only those
dogs of the breed Terrier, whether the dog is a Boston Terrier,
Jack Russell Terrier, Scottish Terrier, and so on:</p>
<pre>SELECT dog_name, dog_IQ, breed 
FROM Dogs 
WHERE breed LIKE '%Terrier';</pre>
<p>The following examples
are select statements that use bracketed ranges:</p>
<pre>SELECT lname FROM Suspects WHERE lname LIKE 'A[^c]%'; 
SELECT lname FROM Suspects WHERE lname LIKE '[a-m]%'; 
SELECT lname FROM Suspects WHERE lname LIKE '%[]'; 
SELECT lname FROM Suspects WHERE lname LIKE 'A[%]%'; 
SELECT lname FROM Suspects WHERE lname LIKE 'A[^c-f]%';</pre>
</div>
</div></div><div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd4" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd4"><!-- --></a><h3 class="topictitle3">Case sensitivity</h3><div><p>Unlike
the rest of ColdFusion, Query of Queries is case-sensitive. However,
Query of Queries supports two string functions, <samp class="codeph">UPPER()</samp> and <samp class="codeph">LOWER()</samp>,
which you can use to achieve case-insensitive matching.</p>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd4__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd3"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd4__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd3"><!-- --></a><h4 class="sectiontitle">Examples</h4><p>The
following example matches only 'Sylvester':</p>
<pre>SELECT dog_name 
FROM Dogs 
WHERE dog_name LIKE 'Sylvester';</pre>
<p>The following example
is not case sensitive; it uses the <samp class="codeph">LOWER()</samp> function
to treat 'Sylvester', 'sylvester', 'SYLVESTER', and so on, as all
lowercase, and matches them with the all lowercase string, ‘sylvester’:</p>
<pre>SELECT dog_name 
FROM Dogs 
WHERE LOWER(dog_name) LIKE 'sylvester';</pre>
<p>If you use
a variable on the right side of the LIKE conditional and want to
ensure that the comparison is not case-sensitive, use the <samp class="codeph">LCase</samp> or <samp class="codeph">UCase</samp> function
to force the variable text to be all of one case, as in the following
example:</p>
<pre>WHERE LOWER(dog_name) LIKE '#LCase(FORM.SearchString)#';</pre>
</div>
</div></div><div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd2" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd2"><!-- --></a><h3 class="topictitle3">Escaping wildcards</h3><div><p>You
can specify your own escape character by using the conditional ESCAPE clause.</p>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd2__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd1"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd2__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fd1"><!-- --></a><h4 class="sectiontitle">Example</h4><p>The
following example uses the ESCAPE clause to enable a search for
a literal percent sign (%), which ColdFusion normally interprets
as a wildcard character:</p>
<pre>SELECT emp_discount 
FROM Benefits 
WHERE emp_discount LIKE '10\%'  
ESCAPE '\';</pre>
</div>
</div></div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec22c24-627b" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec22c24-627b"><!-- --></a><h2 class="topictitle2">Managing data types for columns</h2><div><p>A Query of Queries
requires that every column has metadata that defines the data type
of the column. All queries that ColdFusion creates have metadata. However,
a query created with <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f94.html" target="_self">QueryNew</a></samp> function
that omits the second parameter does not contain metadata. You use
this optional second parameter to define the data type of each column
in the query.</p>
</div><div id="WSF1685330-45B9-4bcd-9087-04F8F1B56B44" class="nochunk"><a name="WSF1685330-45B9-4bcd-9087-04F8F1B56B44"><!-- --></a><h3 class="topictitle3">Specify column data types in the QueryNew function</h3><div><div class="para"><img src="images/dingbat.png" />&#160;Type
a <samp class="codeph">QueryNew</samp> function, specifying the column names
in the first parameter and the data types in the second parameter,
as the following example shows:<pre>&lt;cfset qInstruments = queryNew("name, instrument, years_playing", "CF_SQL_VARCHAR, CF_SQL_VARCHAR, CF_SQL_INTEGER")&gt;</pre>
<div class="note"><span class="notetitle">Note:  </span>To see the metadata for a Query of Queries, use
the <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7dd9.html" target="_self">GetMetaData</a> function.</div>
</div>
</div></div><div id="WS5227A9F8-A34A-4171-96E7-ED19C1468366" class="nochunk"><a name="WS5227A9F8-A34A-4171-96E7-ED19C1468366"><!-- --></a><h3 class="topictitle3">Specify the column data types in the QueryAddColumn function</h3><div><ol><li><p>Create a query by specifying the QueryNew function
with no parameters.</p>
<pre>&lt;!--- Make a query. ---&gt; 
&lt;cfset myQuery = QueryNew("")&gt;</pre>
</li>
<li><p>Add
and populate a column with the <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7b7c.html" target="_self">QueryAddColumn</a> function,
specifying the data type in the third parameter:</p>
<pre>&lt;!--- Create an array. ---&gt; 
&lt;cfset FastFoodArray = ArrayNew(1)&gt; 
&lt;cfset FastFoodArray[1] = "French Fries"&gt; 
&lt;cfset FastFoodArray[2] = "Hot Dogs"&gt; 
&lt;cfset FastFoodArray[3] = "Fried Clams"&gt; 
&lt;cfset FastFoodArray[4] = "Thick Shakes"&gt; 
&lt;!--- Use the array to add a column to the query. ---&gt; 
&lt;cfset nColumnNumber = QueryAddColumn(myQuery, "FastFood", "CF_SQL_VARCHAR", 
    FastFoodArray)&gt;</pre>
</li>
</ol>
<p>If you do not specify the data type, ColdFusion examines the
first 50 rows of each column to determine the data type when performing
conditional expressions. </p>
<p>In some cases, ColdFusion can guess a data type that is inappropriate
for your application. In particular, if you use columns in a WHERE
clause or other conditional expression, the data types must be compatible.
If they are not compatible, use the CAST function to recast one
of the columns to a compatible data type. For more information on
casting, see <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7b7b.html">Using the CAST function</a>. For more information on data type compatibility,
see <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7b7a.html">Understanding Query of Queries processing</a>.</p>
<div class="note"><span class="notetitle">Note:  </span>Specifying the data type in the <samp class="codeph">QueryNew</samp> function
helps you avoid compatibility issues.</div>
</div></div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec22c24-7b7b" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec22c24-7b7b"><!-- --></a><h2 class="topictitle2">Using the CAST function</h2><div><p>In some cases, the data type of a
column is not compatible with the processing you want to do. For
example, query columns returned by the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7ffc.html" target="_self">cfhttp</a></samp> tag are all of type
CF_SQL_VARCHAR, even if the contents are numeric. In this case,
use the Query of Queries CAST function to convert a column value
into an expression of the correct data type.</p>
<p>The syntax for the CAST function is as follows:</p>
<pre>CAST ( expression AS castType )</pre>
<p>Where <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">castType</i> is one of the following:</p>
<ul><li><p>BINARY</p>
</li>
<li><p>BIGINIT</p>
</li>
<li><p>BIT</p>
</li>
<li><p>DATE</p>
</li>
<li><p>DECIMAL</p>
</li>
<li><p>DOUBLE</p>
</li>
<li><p>INTEGER</p>
</li>
<li><p>TIME</p>
</li>
<li><p>TIMESTAMP</p>
</li>
<li><p>VARCHAR</p>
</li>
</ul>
<p>For example: </p>
<pre>&lt;cfhttp url="http://quote.yahoo.com/download/quotes.csv?Symbols=csco,jnpr&amp;format=sc1l1&amp;ext=.csv" 
    method="GET" 
    name="qStockItems" 
    columns="Symbol,Change,LastTradedPrice" 
    textqualifier="""" 
    delimiter="," 
    firstrowasheaders="no"&gt; 
&lt;cfoutput&gt; 
    &lt;cfdump var="#qStockItems#"&gt; 
    &lt;cfdump var="#qStockItems.getColumnNames()#"&gt; 
&lt;/cfoutput&gt; 
 
&lt;cfoutput&gt; 
&lt;cfloop index="i" from="1" to="#arrayLen(qStockItems.getColumnNames())#"&gt; 
    #qStockItems.getMetaData().getColumnTypeName(javaCast("int",i))#&lt;br/&gt; 
&lt;/cfloop&gt; 
&lt;/cfoutput&gt; 
&lt;cftry&gt; 
    &lt;cfquery name="hello" dbtype="query"&gt; 
        SELECT SUM(CAST(qStockItems.LastTradedPrice as INTEGER))  
        AS SUMNOW from qStockItems 
    &lt;/cfquery&gt; 
    &lt;cfcatch&gt;Error in Query of Queries&lt;/cfcatch&gt; 
&lt;/cftry&gt; 
 
&lt;cfoutput&gt; 
    &lt;cfdump var="#hello#"&gt; 
&lt;/cfoutput&gt;</pre>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fcc" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fcc"><!-- --></a><h2 class="topictitle2">Using aggregate functions</h2><div><p>Aggregate
functions operate on a set of data and return a single value. Use
these functions for retrieving summary information from a table,
as opposed to retrieving an entire table and then operating on the
recordset of the entire table.</p>
<p>Consider using aggregate functions to perform the following operations:</p>
<ul><li><p>To display the average of a column</p>
</li>
<li><p>To count the number of rows for a column</p>
</li>
<li><p>To find the earliest date in a column</p>
</li>
</ul>
<p>Since not every relational database management system (RDBMS)
supports all aggregate functions, refer to the documentation of
your database. The following table lists the aggregate functions
that Query of Queries supports:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e44052"><p>Function</p>
</th>
<th valign="top" width="NaN%" id="d17e44055"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e44052 "><p>AVG()</p>
</td>
<td valign="top" width="NaN%" headers="d17e44055 "><p>Returns the average (mean) for a column.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e44052 "><p>COUNT()</p>
</td>
<td valign="top" width="NaN%" headers="d17e44055 "><p>Returns the number of rows in a column.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e44052 "><p>MAX()</p>
</td>
<td valign="top" width="NaN%" headers="d17e44055 "><p>Returns the largest value of a column.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e44052 "><p>MIN()</p>
</td>
<td valign="top" width="NaN%" headers="d17e44055 "><p>Returns the lowest value of a column.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e44052 "><p>SUM()</p>
</td>
<td valign="top" width="NaN%" headers="d17e44055 "><p>Returns the sum of values of a column.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fcc__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fcb"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fcc__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fcb"><!-- --></a><h4 class="sectiontitle">Syntax</h4><pre>aggregate_func ::= &lt;COUNT&gt;(* | column_name) | AVG | SUM | MIN | MAX) 
([ALL | DISTINCT] numeric_exp)</pre>
</div>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fcc__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fca"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fcc__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fca"><!-- --></a><h4 class="sectiontitle">Example</h4><p>The
following example uses the <samp class="codeph">AVG()</samp> function to retrieve
the average IQ of all terriers:</p>
<pre>SELECT dog_name, AVG(dog_IQ) AS avg_IQ 
FROM Dogs 
WHERE breed LIKE '%Terrier';</pre>
</div>
</div><div id="WSf01dbd23413dda0e-473edbc812013c12636-7ff9" class="nochunk"><a name="WSf01dbd23413dda0e-473edbc812013c12636-7ff9"><!-- --></a><h3 class="topictitle3">Arbitrary expressions in aggregate functions</h3><div><p>Query of Queries supports aggregate functions of any arbitrary
expression, as follows:</p>
<pre>SELECT lorange, count(lorange+hirange)  
FROM roysched 
GROUP BY lorange;</pre>
</div></div><div id="WSf01dbd23413dda0e-473edbc812013c12636-7ff8" class="nochunk"><a name="WSf01dbd23413dda0e-473edbc812013c12636-7ff8"><!-- --></a><h3 class="topictitle3">Aggregate functions in arbitrary expressions</h3><div><p>Query of Queries supports mathematical expressions that
include aggregate functions, as follows:</p>
<pre>SELECT MIN(lorange) + MAX(hirange) 
FROM roysched 
GROUP BY lorange;</pre>
</div></div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc7" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc7"><!-- --></a><h2 class="topictitle2">Using group by and having expressions</h2><div><p>Query of Queries supports the use of any arbitrary arithmetic
expression, as long as it is referenced by an alias.</p>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc7__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc6"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc7__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc6"><!-- --></a><h4 class="sectiontitle">Examples</h4><p>The
following code is correct:</p>
<pre><strong>SELECT (lorange + hirange)/2 AS midrange,</strong> 
COUNT(*) 
FROM roysched 
<strong>GROUP BY midrange;</strong></pre>
<p>The following code is correct:</p>
<pre>SELECT (lorange+hirange)/2 AS x,  
<strong>COUNT(*)</strong> 
<strong>FROM roysched GROUP BY x </strong>     
HAVING x &gt; 10000;</pre>
<p>The following code is not supported
in Query of Queries:</p>
<pre><strong>SELECT (lorange + hirange)/2 AS midrange,</strong> 
COUNT(*) 
FROM roysched 
<strong>GROUP BY (lorange + hirange)/2;</strong></pre>
</div>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc5" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc5"><!-- --></a><h2 class="topictitle2">Using ORDER BY clauses</h2><div><p>Query of Queries supports the ORDER BY clause to sort.
Make sure that it is the last clause in your SELECT statement. You
can sort by multiple columns, by relative column position, by nonselected
columns. You can specify a descending sort direction with the DESC
keyword (by default, most RDBMS sorts are ascending, which makes
the ASC keyword unnecessary).</p>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc5__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc4"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc5__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc4"><!-- --></a><h4 class="sectiontitle">Syntax</h4><pre>order_by_column ::= ( &lt;IDENTIFIER&gt; | &lt;INTEGER_LITERAL&gt; ) [&lt;ASC&gt; | &lt;DESC&gt;]</pre>
</div>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc5__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc3"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc5__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc3"><!-- --></a><h4 class="sectiontitle">Example</h4><p>The
following example shows a simple sort using an ORDER BY clause:</p>
<pre>SELECT acetylcholine_levels, dopamine_levels 
FROM results 
ORDER BY dopamine_levels</pre>
<p>The following example shows
a more complex sort; results are first sorted by ascending levels
of dopamine, then by descending levels of acetylcholine. The ASC
keyword is unnecessary, and is used only for legibility.</p>
<pre>SELECT acetylcholine_levels, dopamine_levels 
FROM results 
ORDER BY 2 ASC, 1 DESC</pre>
</div>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc2" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc2"><!-- --></a><h2 class="topictitle2">Using aliases</h2><div><p>Query of Queries supports the use of database column aliases.
An <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">alias</i> is an alternate name for a database field or value.
Query of Queries lets you reuse an alias in the same SQL statement.</p>
<p>One way to create an alias is to concatenate (append) two or
more columns to generate a value. For example, you can concatenate
a first name and a last name to create the value fullname. Because
the new value does not exist in a database, you refer to it by its
alias. The AS keyword assigns the alias in the SELECT statement.</p>
</div><div id="WS1615079D-5ECA-4b02-8268-7920E74072DD" class="nochunk"><a name="WS1615079D-5ECA-4b02-8268-7920E74072DD"><!-- --></a><h3 class="topictitle3">Examples</h3><div><p>Query of Queries supports alias substitutions in the ORDER
BY, GROUP BY, and HAVING clauses. </p>
<div class="note"><span class="notetitle">Note:  </span>Query of Queries does not support aliases for
table names.</div>
<pre><strong>SELECT FirstName + ' ' + LastName AS fullname</strong> 
from Employee;</pre>
<p>The following examples rely on these two master queries:</p>
<pre>&lt;cfquery name="employee" datasource="2pubs"&gt; 
    SELECT * FROM employee 
&lt;/cfquery&gt; 
 
&lt;cfquery name="roysched" datasource="2pubs"&gt; 
    SELECT * FROM roysched 
&lt;/cfquery&gt;</pre>
<div class="section" id="WS1615079D-5ECA-4b02-8268-7920E74072DD__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc0"><a name="WS1615079D-5ECA-4b02-8268-7920E74072DD__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fc0"><!-- --></a><h4 class="sectiontitle">ORDER BY example</h4><pre>&lt;cfquery name="order_by" dbtype="query"&gt; 
    <strong>SELECT (job_id || job_lvl)/2 AS job_value</strong> 
    FROM employee  
    <strong>ORDER BY job_value</strong> 
&lt;/cfquery&gt;</pre>
</div>
<div class="section" id="WS1615079D-5ECA-4b02-8268-7920E74072DD__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fbf"><a name="WS1615079D-5ECA-4b02-8268-7920E74072DD__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fbf"><!-- --></a><h4 class="sectiontitle">GROUP BY example</h4><pre>&lt;cfquery name="group_by" dbtype="query"&gt; 
    SELECT lorange || hirange AS x, count(hirange)  
    FROM roysched  
    <strong>GROUP BY x</strong>     
&lt;/cfquery&gt;</pre>
</div>
<div class="section" id="WS1615079D-5ECA-4b02-8268-7920E74072DD__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fbe"><a name="WS1615079D-5ECA-4b02-8268-7920E74072DD__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fbe"><!-- --></a><h4 class="sectiontitle">HAVING example</h4><pre>&lt;cfquery name="having" dbtype="query"&gt; 
    <strong>SELECT (lorange || hirange)/2 AS x, </strong> 
    <strong>COUNT(*)</strong> 
    <strong>FROM roysched GROUP BY x </strong> 
    <strong>HAVING x &gt; 10000</strong> 
&lt;/cfquery&gt;</pre>
</div>
</div></div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fbd" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fbd"><!-- --></a><h2 class="topictitle2">Handling null values</h2><div><p>Query of Queries uses Boolean logic to handle conditional
expressions. Proper handling of NULL values requires the use of
ternary logic. The <samp class="codeph">IS [NOT] NULL</samp> clause works correctly
in Query of Queries. However the following expressions do not work
properly when the column breed is NULL:</p>
<pre>WHERE (breed &gt; 'A') 
WHERE NOT (breed &gt; 'A') </pre>
<p>The correct behavior should not include NULL breed columns in
the result set of either expression. To avoid this limitation, add
an explicit rule to the conditionals and rewrite them in the following
forms:</p>
<pre>WHERE breed IS NOT NULL AND (breed &gt; 'A') 
WHERE breed IS NOT NULL AND not (breed &gt; 'A')</pre>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fbc" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fbc"><!-- --></a><h2 class="topictitle2">Concatenating strings</h2><div><p>Query
of Queries support two string concatenation operators: + and ||,
as the following examples show:</p>
<pre>LASTNAME + ', ' + FIRSTNAME 
LASTNAME || ', ' || FIRSTNAME</pre>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec22c24-7008" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec22c24-7008"><!-- --></a><h2 class="topictitle2">Escaping reserved keywords</h2><div><p>ColdFusion has a list of reserved keywords, which are typically
part of the SQL language and are not normally used for names of
columns or tables. To escape a reserved keyword for a column name
or table name, enclose it in brackets.</p>
<div class="important"><span class="importanttitle">Important:  </span>Earlier versions of ColdFusion let you
use some reserved keywords without escaping them.</div>
<div class="section" id="WSc3ff6d0ea77859461172e0811cbec22c24-7008__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fba"><a name="WSc3ff6d0ea77859461172e0811cbec22c24-7008__WSc3ff6d0ea77859461172e0811cbec0e4fd-7fba"><!-- --></a><h4 class="sectiontitle">Examples</h4><p>Query
of Queries supports the following SELECT statement examples:</p>
<pre>SELECT [from] FROM parts; 
SELECT [group].firstname FROM [group]; 
SELECT [group].[from] FROM [group];</pre>
<p>Query of Queries
does not support nested escapes, such as in the following example:</p>
<pre>SELECT [[from]] FROM T;</pre>
<p>The
following table lists ColdFusion reserved keywords:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><tbody><tr><td valign="top" width="NaN%"><p>ABSOLUTE</p>
</td>
<td valign="top" width="NaN%"><p>ACTION</p>
</td>
<td valign="top" width="NaN%"><p>ADD</p>
</td>
<td valign="top" width="NaN%"><p>ALL</p>
</td>
<td valign="top" width="NaN%"><p>ALLOCATE</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>ALTER</p>
</td>
<td valign="top" width="NaN%"><p>AND</p>
</td>
<td valign="top" width="NaN%"><p>ANY</p>
</td>
<td valign="top" width="NaN%"><p>ARE</p>
</td>
<td valign="top" width="NaN%"><p>AS</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>ASC</p>
</td>
<td valign="top" width="NaN%"><p>ASSERTION</p>
</td>
<td valign="top" width="NaN%"><p>AT</p>
</td>
<td valign="top" width="NaN%"><p>AUTHORIZATION</p>
</td>
<td valign="top" width="NaN%"><p>AVG</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>BEGIN</p>
</td>
<td valign="top" width="NaN%"><p>BETWEEN</p>
</td>
<td valign="top" width="NaN%"><p>BIT</p>
</td>
<td valign="top" width="NaN%"><p>BIT_LENGTH</p>
</td>
<td valign="top" width="NaN%"><p>BOTH</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>BY</p>
</td>
<td valign="top" width="NaN%"><p>CASCADE</p>
</td>
<td valign="top" width="NaN%"><p>CASCADED</p>
</td>
<td valign="top" width="NaN%"><p>CASE</p>
</td>
<td valign="top" width="NaN%"><p>CAST</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>CATALOG</p>
</td>
<td valign="top" width="NaN%"><p>CHAR</p>
</td>
<td valign="top" width="NaN%"><p>CHARACTER</p>
</td>
<td valign="top" width="NaN%"><p>CHARACTER_LENGTH</p>
</td>
<td valign="top" width="NaN%"><p>CHAR_LENGTH</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>CHECK</p>
</td>
<td valign="top" width="NaN%"><p>CLOSE</p>
</td>
<td valign="top" width="NaN%"><p>COALESCE</p>
</td>
<td valign="top" width="NaN%"><p>COLLATE</p>
</td>
<td valign="top" width="NaN%"><p>COLLATION</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>COLUMN</p>
</td>
<td valign="top" width="NaN%"><p>COMMIT</p>
</td>
<td valign="top" width="NaN%"><p>CONNECT</p>
</td>
<td valign="top" width="NaN%"><p>CONNECTION</p>
</td>
<td valign="top" width="NaN%"><p>CONSTRAINT</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>CONSTRAINTS</p>
</td>
<td valign="top" width="NaN%"><p>CONTINUE</p>
</td>
<td valign="top" width="NaN%"><p>CONVERT</p>
</td>
<td valign="top" width="NaN%"><p>CORRESPONDING</p>
</td>
<td valign="top" width="NaN%"><p>COUNT</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>CREATE</p>
</td>
<td valign="top" width="NaN%"><p>CROSS</p>
</td>
<td valign="top" width="NaN%"><p>CURRENT</p>
</td>
<td valign="top" width="NaN%"><p>CURRENT_DATE</p>
</td>
<td valign="top" width="NaN%"><p>CURRENT_TIME</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>CURRENT_TIMESTAMP</p>
</td>
<td valign="top" width="NaN%"><p>CURRENT_USER</p>
</td>
<td valign="top" width="NaN%"><p>CURSOR</p>
</td>
<td valign="top" width="NaN%"><p>DATE</p>
</td>
<td valign="top" width="NaN%"><p>DAY</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>DEALLOCATE</p>
</td>
<td valign="top" width="NaN%"><p>DEC</p>
</td>
<td valign="top" width="NaN%"><p>DECIMAL</p>
</td>
<td valign="top" width="NaN%"><p>DECLARE</p>
</td>
<td valign="top" width="NaN%"><p>DEFAULT</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>DEFERRABLE</p>
</td>
<td valign="top" width="NaN%"><p>DEFERRED</p>
</td>
<td valign="top" width="NaN%"><p>DELETE</p>
</td>
<td valign="top" width="NaN%"><p>DESC</p>
</td>
<td valign="top" width="NaN%"><p>DESCRIBE</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>DESCRIPTOR</p>
</td>
<td valign="top" width="NaN%"><p>DIAGNOSTICS</p>
</td>
<td valign="top" width="NaN%"><p>DISCONNECT</p>
</td>
<td valign="top" width="NaN%"><p>DISTINCT</p>
</td>
<td valign="top" width="NaN%"><p>DOMAIN</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>DOUBLE</p>
</td>
<td valign="top" width="NaN%"><p>DROP</p>
</td>
<td valign="top" width="NaN%"><p>ELSE</p>
</td>
<td valign="top" width="NaN%"><p>END</p>
</td>
<td valign="top" width="NaN%"><p>END-EXEC</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>ESCAPE</p>
</td>
<td valign="top" width="NaN%"><p>EXCEPT</p>
</td>
<td valign="top" width="NaN%"><p>EXCEPTION</p>
</td>
<td valign="top" width="NaN%"><p>EXEC</p>
</td>
<td valign="top" width="NaN%"><p>EXECUTE</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>EXISTS</p>
</td>
<td valign="top" width="NaN%"><p>EXTERNAL</p>
</td>
<td valign="top" width="NaN%"><p>EXTRACT</p>
</td>
<td valign="top" width="NaN%"><p>FALSE</p>
</td>
<td valign="top" width="NaN%"><p>FETCH</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>FIRST</p>
</td>
<td valign="top" width="NaN%"><p>FLOAT</p>
</td>
<td valign="top" width="NaN%"><p>FOR</p>
</td>
<td valign="top" width="NaN%"><p>FOREIGN</p>
</td>
<td valign="top" width="NaN%"><p>FOUND</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>FROM</p>
</td>
<td valign="top" width="NaN%"><p>FULL</p>
</td>
<td valign="top" width="NaN%"><p>GET</p>
</td>
<td valign="top" width="NaN%"><p>GLOBAL</p>
</td>
<td valign="top" width="NaN%"><p>GO</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>GOTO</p>
</td>
<td valign="top" width="NaN%"><p>GRANT</p>
</td>
<td valign="top" width="NaN%"><p>GROUP</p>
</td>
<td valign="top" width="NaN%"><p>HAVING</p>
</td>
<td valign="top" width="NaN%"><p>HOUR</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>IDENTITY</p>
</td>
<td valign="top" width="NaN%"><p>IMMEDIATE</p>
</td>
<td valign="top" width="NaN%"><p>IN</p>
</td>
<td valign="top" width="NaN%"><p>INDICATOR</p>
</td>
<td valign="top" width="NaN%"><p>INITIALLY</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>INNER</p>
</td>
<td valign="top" width="NaN%"><p>INPUT</p>
</td>
<td valign="top" width="NaN%"><p>INSENSITIVE</p>
</td>
<td valign="top" width="NaN%"><p>INSERT</p>
</td>
<td valign="top" width="NaN%"><p>INT</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>INTEGER</p>
</td>
<td valign="top" width="NaN%"><p>INTERSECT</p>
</td>
<td valign="top" width="NaN%"><p>INTERVAL</p>
</td>
<td valign="top" width="NaN%"><p>INTO</p>
</td>
<td valign="top" width="NaN%"><p>IS</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>ISOLATION</p>
</td>
<td valign="top" width="NaN%"><p>JOIN</p>
</td>
<td valign="top" width="NaN%"><p>KEY</p>
</td>
<td valign="top" width="NaN%"><p>LANGUAGE</p>
</td>
<td valign="top" width="NaN%"><p>LAST</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>LEADING</p>
</td>
<td valign="top" width="NaN%"><p>LEFT</p>
</td>
<td valign="top" width="NaN%"><p>LEVEL</p>
</td>
<td valign="top" width="NaN%"><p>LIKE</p>
</td>
<td valign="top" width="NaN%"><p>LOCAL</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>LOWER</p>
</td>
<td valign="top" width="NaN%"><p>MATCH</p>
</td>
<td valign="top" width="NaN%"><p>MAX</p>
</td>
<td valign="top" width="NaN%"><p>MIN</p>
</td>
<td valign="top" width="NaN%"><p>MINUTE</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>MODULE</p>
</td>
<td valign="top" width="NaN%"><p>MONTH</p>
</td>
<td valign="top" width="NaN%"><p>NAMES</p>
</td>
<td valign="top" width="NaN%"><p>NATIONAL</p>
</td>
<td valign="top" width="NaN%"><p>NATURAL</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>NCHAR</p>
</td>
<td valign="top" width="NaN%"><p>NEXT</p>
</td>
<td valign="top" width="NaN%"><p>NO</p>
</td>
<td valign="top" width="NaN%"><p>NOT</p>
</td>
<td valign="top" width="NaN%"><p>NULL</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>NULLIF</p>
</td>
<td valign="top" width="NaN%"><p>NUMERIC</p>
</td>
<td valign="top" width="NaN%"><p>OCTET_LENGTH</p>
</td>
<td valign="top" width="NaN%"><p>OF</p>
</td>
<td valign="top" width="NaN%"><p>ON</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>ONLY</p>
</td>
<td valign="top" width="NaN%"><p>OPEN</p>
</td>
<td valign="top" width="NaN%"><p>OPTION</p>
</td>
<td valign="top" width="NaN%"><p>OR</p>
</td>
<td valign="top" width="NaN%"><p>ORDER</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>OUTER</p>
</td>
<td valign="top" width="NaN%"><p>OUTPUT</p>
</td>
<td valign="top" width="NaN%"><p>OVERLAPS</p>
</td>
<td valign="top" width="NaN%"><p>PAD</p>
</td>
<td valign="top" width="NaN%"><p>PARTIAL</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>POSITION</p>
</td>
<td valign="top" width="NaN%"><p>PRECISION</p>
</td>
<td valign="top" width="NaN%"><p>PREPARE</p>
</td>
<td valign="top" width="NaN%"><p>PRESERVE</p>
</td>
<td valign="top" width="NaN%"><p>PRIMARY</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>PRIOR</p>
</td>
<td valign="top" width="NaN%"><p>PRIVILEGES</p>
</td>
<td valign="top" width="NaN%"><p>PROCEDURE</p>
</td>
<td valign="top" width="NaN%"><p>PUBLIC</p>
</td>
<td valign="top" width="NaN%"><p>READ</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>REAL</p>
</td>
<td valign="top" width="NaN%"><p>REFERENCES</p>
</td>
<td valign="top" width="NaN%"><p>RELATIVE</p>
</td>
<td valign="top" width="NaN%"><p>RESTRICT</p>
</td>
<td valign="top" width="NaN%"><p>REVOKE</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>RIGHT</p>
</td>
<td valign="top" width="NaN%"><p>ROLLBACK</p>
</td>
<td valign="top" width="NaN%"><p>ROWS</p>
</td>
<td valign="top" width="NaN%"><p>SCHEMA</p>
</td>
<td valign="top" width="NaN%"><p>SCROLL</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>SECOND</p>
</td>
<td valign="top" width="NaN%"><p>SECTION</p>
</td>
<td valign="top" width="NaN%"><p>SELECT</p>
</td>
<td valign="top" width="NaN%"><p>SESSION</p>
</td>
<td valign="top" width="NaN%"><p>SESSION_USER</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>SET</p>
</td>
<td valign="top" width="NaN%"><p>SMALLINT</p>
</td>
<td valign="top" width="NaN%"><p>SOME</p>
</td>
<td valign="top" width="NaN%"><p>SPACE</p>
</td>
<td valign="top" width="NaN%"><p>&#160;</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>SQL</p>
</td>
<td valign="top" width="NaN%"><p>SQLCODE</p>
</td>
<td valign="top" width="NaN%"><p>SQLERROR</p>
</td>
<td valign="top" width="NaN%"><p>SQLSTATE</p>
</td>
<td valign="top" width="NaN%"><p>SUBSTRING</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>SUM</p>
</td>
<td valign="top" width="NaN%"><p>SYSTEM_USER</p>
</td>
<td valign="top" width="NaN%"><p>TABLE</p>
</td>
<td valign="top" width="NaN%"><p>TEMPORARY</p>
</td>
<td valign="top" width="NaN%"><p>THEN</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>TIME</p>
</td>
<td valign="top" width="NaN%"><p>TIMESTAMP</p>
</td>
<td valign="top" width="NaN%"><p>TIMEZONE_HOUR</p>
</td>
<td valign="top" width="NaN%"><p>TIMEZONE_MINUTE</p>
</td>
<td valign="top" width="NaN%"><p>TO</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>TRAILING</p>
</td>
<td valign="top" width="NaN%"><p>TRANSACTION</p>
</td>
<td valign="top" width="NaN%"><p>TRANSLATE</p>
</td>
<td valign="top" width="NaN%"><p>TRANSLATION</p>
</td>
<td valign="top" width="NaN%"><p>TRIM</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>TRUE</p>
</td>
<td valign="top" width="NaN%"><p>UNION</p>
</td>
<td valign="top" width="NaN%"><p>UNIQUE</p>
</td>
<td valign="top" width="NaN%"><p>UNKNOWN</p>
</td>
<td valign="top" width="NaN%"><p>UPDATE</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>UPPER</p>
</td>
<td valign="top" width="NaN%"><p>USAGE</p>
</td>
<td valign="top" width="NaN%"><p>USER</p>
</td>
<td valign="top" width="NaN%"><p>USING</p>
</td>
<td valign="top" width="NaN%"><p>VALUE</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>VALUES</p>
</td>
<td valign="top" width="NaN%"><p>VARCHAR</p>
</td>
<td valign="top" width="NaN%"><p>VARYING</p>
</td>
<td valign="top" width="NaN%"><p>VIEW</p>
</td>
<td valign="top" width="NaN%"><p>WHEN</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>WHENEVER</p>
</td>
<td valign="top" width="NaN%"><p>WHERE</p>
</td>
<td valign="top" width="NaN%"><p>WITH</p>
</td>
<td valign="top" width="NaN%"><p>WORK</p>
</td>
<td valign="top" width="NaN%"><p>WRITE</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>YEAR</p>
</td>
<td valign="top" width="NaN%"><p>ZONE</p>
</td>
<td valign="top" width="NaN%"><p>&#160;</p>
</td>
<td valign="top" width="NaN%"><p>&#160;</p>
</td>
<td valign="top" width="NaN%"><p>&#160;</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fb9" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fb9"><!-- --></a><h2 class="topictitle2">Using Queries of Queries with dates</h2><div><p>If you create a query object with
the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f94.html" target="_self">QueryNew</a></samp> function
and populate a column with date constants, ColdFusion stores the
dates as a string inside the query object until a Query of Queries
is applied to the query object. When ColdFusion applies a Query
of Queries to the query object, it converts the string representations
into date objects. </p>
<p>Query of Queries supports date constants in SQL and ODBC format,
as follows:</p>
<ul><li><p><strong>SQL format</strong>: Dates, times, or timestamps in one
of the following format:</p>
<ul><li><p><strong>Date string</strong>: <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">yyyy-mm-dd</i>,
for example, 1955-06-13.</p>
</li>
<li><p><strong>Time string</strong>: <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">hh:mm:ss[.[nnn]]</i>, for example,
14:34:30.75.</p>
</li>
<li><p><strong>Timestamp string</strong>: <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">yyyy-mm-dd hh:mm:ss[.[nnn]]</i>,
for example, 1924-01-14 12:00:00.000.</p>
</li>
</ul>
</li>
<li><p><strong>ODBC format</strong>: Dates, times, or timestamps in one of
the following format:</p>
<ul><li><p><strong>Date string</strong>: <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">{d 'value'}</i>,
for example, {d '2004-07-06'}.</p>
</li>
<li><p><strong>Time string</strong>: <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">{t 'value'}</i>, for example, {t '13:45:30'}.</p>
</li>
<li><p><strong>Timestamp string</strong>: <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">{ts 'value'}</i>, for example,
{ts '2004-07-06 13:45:30'}.</p>
</li>
</ul>
</li>
</ul>
<div class="tip"><img src="images/tip_help.png" />If you want to convert the date to its original
format, use the <samp class="codeph">DateFormat</samp><i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema"> function and apply the "mm/dd/yy" mask. </i></div></div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fb8" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0e4fd-7fb8"><!-- --></a><h2 class="topictitle2">Understanding Query of Queries performance</h2><div><p>Query
of Queries performs well on single-table query objects that were
accessed directly from a database. This happens because ColdFusion
stores meta information for a query object accessed from a database.</p>
<p>When working with a query resulting in a SQL join, Query of Queries
performs as follows:</p>
<ol><li><p>Query of Queries is efficient for simple joins in which
only one equality exists between two column references or constants,
for example:</p>
<pre>SELECT T1.a, b, c, d FROM T1, T2 WHERE T1.a = T2.a</pre>
</li>
<li><p>Query of Queries is less efficient for joins in which the
predicate contains multiple expressions, for example:</p>
<pre>SELECT T1.a, b, c, d FROM T1, T2  
WHERE T1.a = T2.a AND T1.b + T1.c = T2.b + T2.c</pre>
</li>
</ol>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec22c24-7b7a" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec22c24-7b7a"><!-- --></a><h2 class="topictitle2">Understanding Query of Queries processing</h2><div><p>Query of Queries can process the following:</p>
<ul><li><p>Column comparisons</p>
</li>
<li><p>Queries passed by reference</p>
</li>
<li><p>Complex objects</p>
</li>
</ul>
</div><div id="WSf01dbd23413dda0e-473edbc812013c12636-7ff7" class="nochunk"><a name="WSf01dbd23413dda0e-473edbc812013c12636-7ff7"><!-- --></a><h3 class="topictitle3">Comparing columns with different data types</h3><div><p>Starting with ColdFusion MX 7, ColdFusion includes enhancements
that allow you to compare columns with different data types.</p>
<p>If
one of the operands has a known column type (only constants have
an unknown column type), Query of Queries tries to coerce the constant
with an unknown type to the type of the operand with metadata. The
pairs of allowed coercions are as follows:</p>
<ul><li><p>Binary, string</p>
</li>
<li><p>Dates, string</p>
</li>
<li><p>Numeric, bigdecimal</p>
</li>
<li><p>Boolean, numeric</p>
</li>
</ul>
<p>That is, ColdFusion can coerce between binary and string, but
not between date and string.</p>
<p>If both operands have known data types, the types must be the
same. The only exception is that ColdFusion can coerce among integer,
float, and double.</p>
<p>If both operands are constants, ColdFusion tries to coerce the
values, first to the most restrictive type, then to the least restrictive
type.</p>
<ul><li><p>First to binary then to string.</p>
</li>
<li><p>First to date then to string.</p>
</li>
<li><p>First to boolean then to numeric.</p>
</li>
</ul>
</div></div><div id="WSf01dbd23413dda0e-473edbc812013c12636-7ff6" class="nochunk"><a name="WSf01dbd23413dda0e-473edbc812013c12636-7ff6"><!-- --></a><h3 class="topictitle3">Passing queries by reference</h3><div><p>A Query of Queries is copied by reference from its related
query; which means that ColdFusion does not create a query when
you create a Query of Queries. It also means that changes to a Query
of Queries, such as ordering, modifying, and deleting data, are
also applied to the base query object.</p>
<p>If you do not want the original query to change, use the <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f9b.html" target="_self">Duplicate</a> function to create a copy
and create the Query of Queries using the copied query.</p>
</div></div><div id="WSf01dbd23413dda0e-473edbc812013c12636-7ff5" class="nochunk"><a name="WSf01dbd23413dda0e-473edbc812013c12636-7ff5"><!-- --></a><h3 class="topictitle3">Managing complex objects</h3><div><p>You cannot use Query Of Queries on a recordset that contains
complex objects, such as arrays and structures.</p>
<div class="note"><span class="notetitle">Note:  </span>You can store a recordset in a complex object.</div>
</div></div></div>


<!-- BEGIN USER PREFERENCES -->
          <div id="userprefs">
          </div>
<!-- END USER PREFERENCES -->

          <div id="related">
            
            
            <div class="separator"><a href="#top"><img src="images/BTT.jpg" /></a>&#160;</div>
          </div>
          <div id="footer">
<!-- BEGIN IONCOMMENTS -->
            <div id="ionComHere">
            </div>
<!-- END IONCOMMENTS -->


            <p id="creativecommons"><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text"><img id="creativecommons_img" src="images/CC.png" alt="This work is licensed under a Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License" /></a>&nbsp;Twitter™ and Facebook posts are not covered under the terms of Creative Commons.</p>
          </div>
</td>
<td width="10px"></td>
<td id="inner_rightcolumn">

</td></tr></table>
      </div>
<!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc3ff6d0ea77859461172e0811cbec0e4fd-7ff9.html" title="About Query of Queries"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc3ff6d0ea77859461172e0811cbec22c24-7c24.html" title="Managing LDAP Directories"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Developing&#160;ColdFusion 9 Applications</b></a> / <a href="WS8f0cc78011fffa7168855f811cdb0b0cce-8000.html"><b>Accessing and Using Data</b></a> 
      / <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7bb8.html"><b>Using Query of Queries</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
<!-- END CONTENT WRAPPER -->

</td>
<td id="col3">
    <div>
        <img src="images/adobe-lq.png" />
    </div>
</td>
</tr>
</table>
    </div>
<!-- END PAGE CONTENT WRAPPER -->
<script type="text/javascript">
<!--[CDATA[
scrollToNameAnchor();
// ]]-->
</script> 
<!--
    Description:
    This file generates the link to product support in the top right corner
-->

<style>
#menutop{
    position:absolute;
    top:4px;
    right:24px;
    width:auto;    
    font-size:11px;
    color:#fff;
    text-align:right;
}
#menutop a{
    color:#fff;
}
#menutop a:hover{
        text-decoration:underline;
}
</style>  
  
  
  
  
<div id="productmenu">
<!--googleoff: index-->
  <div id="menutop">


<script language=javascript type='text/javascript'>
    // darken menu text for products with light backgrounds
    var path = document.location.href.toLowerCase();
    if (path.indexOf("/acrobat/")           	> 0 ||
        path.indexOf("/acrobat.com/")       	> 0 ||
        path.indexOf("/acrobatConnectPro/") 	> 0 ||
        path.indexOf("/connect/")           	> 0 ||
        path.indexOf("/livecycledataserviceses/") > 0 ||
        path.indexOf("/muse/")         	> 0 ||
	path.indexOf("/presenter/")         	> 0 ||
        path.indexOf("/scene7/")            	> 0 ||
        path.indexOf("/flashmediaserver/")  	> 0 ||
        path.indexOf("/wave/")              	> 0 )
    {
        document.write('<style>#menutop a{color:#505050}</style>');
    }
    if (typeof('terms_AHV_PRODUCT_SUPPORT') != "undefined" && ! use_robohelp_behavior ){      
        if (path.indexOf("/muse/") > -1 ){
            var supportlink = '<a href="http://muse.adobe.com/support.html">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }else{
            var supportlink = '<a href="http://adobe.com/support">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }
        document.write( supportlink );
     }

</script> 

  </div>
<!--googleon: index-->
</div>



<style>
#online-privacy-policy{ 
    margin:10px 40px; 
    font-size:11px;
}
</style>

<p id="online-privacy-policy">
<script language="javascript">
var pageLoc = "en_US";
var metaElements = document.all ?
document.all.tags('meta') :
document.getElementsByTagName ?
document.getElementsByTagName ('meta') : new Array();
for (var m = 0; m < metaElements.length; m++) {
	if (metaElements[m].name == "lang") {
		pageLoc = metaElements[m].content;
		break;
	}
}
var ptn = /(..)-(..)/;
if (ptn.test(pageLoc)) {
	var languageCode = pageLoc.replace(ptn, "$1");
	var countryCode = pageLoc.replace(ptn, "$2");
	pageLoc = languageCode + "_" + countryCode.toUpperCase();
}

var policyLoc = "en_US";
var policyText = "Online Privacy Policy";
var policyPath = "";
var policyArray=[
"da_DK", "Online fortrolighedserklæring",
"de_DE", "Online-Datenschutzrichtlinie",
"es_ES", "Política de confidencialidad en línea",
"fi_FI", "Yksityisyyttä koskeva Online-toimintaohjelma",
"fr_FR", "Confidentialité et sécurité",
"it_IT", "Informativa sulla privacy online",
"ja_JP", "プライバシーポリシー",
"ko_KR", "Adobe 온라인 개인정보 보호정책",
"pt_BR", "Política de Confidencialidade On-line", 
"zh_CN", "在线隐私政策",
"zh_TW", "線上隱私政策"
];
var legalLoc = "en_US";
var legalText = "Legal Notices";
var legalPath = legalLoc;
var legalArray=[
"ar_AE", "إشعارات قانونية",
"bg_BG", "Юридически бележки",
"cs_CZ", "Právní upozornění",
"da_DK", "Juridiske meddelelser",
"de_DE", "Rechtliche Hinweise",
"el_GR", "Σημειώσεις νομικού περιεχομένου",
"es_ES", "Avisos legales",
"et_EE", "Juriidilised teated",
"fi_FI", "Lakisääteiset ilmoitukset",
"fr_FR", "Mentions légales",
"he_IL", "הצהרות משפטיות",
"hr_HR", "Pravne napomene",
"hu_HU", "Jogi közlemények",
"it_IT", "Informazioni legali",
"ja_JP", "法律上の注意",
"ko_KR", "법적 고지 사항",
"lt_LT", "Teisinės pastabos",
"lv_LV", "Juridisks paziņojums",
"nb_NO", "Juridiske merknader",
"nl_NL", "Juridische kennisgevingen",
"pl_PL", "Informacje prawne",
"pt_BR", "Aspectos jurídicos",
"ro_RO", "Prevederi legale",
"ru_RU", "Юридическая информация",
"sk_SK", "Právne upozornenie",
"sl_SI", "Pravni pouk",
"sv_SE", "Upphovsrätt",
"tr_TR", "Yasal uyarılar",
"uk_UA", "Юридична інформація",
"zh_CN", "法律声明",
"zh_TW", "法律注意事項"
];

ruPolicy = "http://www.adobe.com/ru/misc/privacy.html";
trPolicy = "http://www.adobe.com/tr/misc/privacy.html";

// Bug 2846992: LOC: RUS, TUR: The link to "Online Privacy Policy" should include language, currently it is not appearing.
if (pageLoc == "ru_RU") {
	policyPath = "ru";
}
else if (pageLoc == "tr_TR") {
	policyPath = "tr";
}
for (var i = 0; i < policyArray.length; i+=2) {
	if (pageLoc == policyArray[i]) {
		policyLoc = pageLoc;
		policyText = policyArray[i+1];
		var ptn = /(..)_(..)/;
		if (ptn.test(policyLoc)) {
			var countryCode = policyLoc.replace(ptn, "$2");
			policyPath = countryCode.toLowerCase();
		}
		break;
	}
}

for (var i = 0; i < legalArray.length; i+=2) {
	if (pageLoc == legalArray[i]) {
		legalLoc = pageLoc;
		legalText = legalArray[i+1];
		legalPath = legalLoc;
		break;
	}
}
if(agt.indexOf("community help client") > -1 ){
	document.write('<a href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
}else{
	//Open the privacy policy in a new window
	document.write('<a target="_blank" href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a target="_blank" href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
} 
</script>
</p>



<!-- localfooter.ssi -->

<script type="text/javascript">
    var debug = (top.location.href.indexOf("debug=true") > -1);
</script>

<script language="javascript">
document.write('<scr'+'ipt ' +
               'src="/en_US/ssi/_pod.js" ' +
               'language="javascript" ' +
               'charset="UTF-8"> ' +
               '</scr'+'ipt>');
</script>


<script type="text/javascript">
//
//  Ethnio survey code
//
/*          DocumentID      EthnioID */
/*          -------------   -------- */
var ethnio=["/en_US/flash/cs/using/WSb03e830bd6f770ee6664507612436d7dede-8000.html", "87462",
            "/en_US/creativesuite/cs/using/WSe851854fd1e0856a-4b08a77612477f69f15-8000.html",  "10441",
            "/en_US/dreamweaver/cs/using/WSEE4C0148-A6F4-4bf5-9DEF-CE06AB026214a.html",  "57412"
 
    ];
                        
    for ( var i = 0; i < ethnio.length ; i = i+2 ){
        if ( document.location.href.indexOf( ethnio[i] ) > -1 ){ 
            var headID = document.getElementsByTagName("head")[0];         
            var ethnioScript = document.createElement('script');
            ethnioScript.type = 'text/javascript';
            ethnioScript.src = 'http://ethn.io/remotes/' + ethnio[i+1];        
            if ( debug ){
                alert ("Using Ethnio script: " + ethnioScript.src );
            }else{
                headID.appendChild(ethnioScript);
            }
        }
    }
</script>



<div style="display: none;">
<!-- SiteCatalyst -->
<script language="JavaScript" type="text/javascript"><!--
var s_code=' ';
var s_docHost = window.location.hostname.toLowerCase();
var s_docURL = window.location.pathname.toLowerCase();
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
if (s_docHost.indexOf(".corp.adobe") != -1 || s_docHost.indexOf("stage.") != -1 || s_docHost.indexOf(".dev.adobe") != -1 || s_docHost.indexOf("staging.") != -1) scJsHost="";
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/omniture_s_code.js' type='text/javascript'%3E%3C/script%3E"));
//--></script>
<script type="text/javascript"><!--
var s_accountName;
s_server="www.adobe.com static content pages";
if (!window.s_account) s_accountName="mxmacromedia";
else s_accountName=window.s_account;

if (window.s_docURL.indexOf("/designcenter/") != -1)
  s_channel="Adobe Design Center";	
else if ((window.s_docHost.indexOf("labs.adobe") != -1) ||
(window.s_docHost.indexOf("labs-staging.") != -1))
  s_channel="Labs";
else if (window.s_docHost.indexOf("help.adobe.com") != -1) {
  s_channel="Support Help.adobe.com";
  if (window.s_docURL.indexOf("/en_us/") == -1) {
    s_docURLArray=s_docURL.split('/');
    s_pageName="http://help.adobe.com/"+s_docURLArray[1]+"/"+ s_docURLArray[2]+"/"+s_docURLArray[3];
    s_prop23="http://help.adobe.com"+window.location.pathname;
  }
}
else if (window.s_docHost.indexOf("kb2.adobe.com") != -1) {
  s_channel="Support Knowledgebase";
  s_prop23="http://kb2.adobe.com"+s_docURL+":";
  if (typeof(omtrProductList) != 'undefined' && omtrProductList.length > 0)
 {
    s_prop23=s_prop23+omtrProductList;
  }
}
else if (window.s_docHost.indexOf("resellers.adobe.com") != -1) {
		var s_pageName=document.getElementsByTagName("title")[0].text;
}

if (!window.scMMInclude) {
	var s_wd=window,s_tm=new Date;
	if(s_code!=' '){
		s_code=s_dc(s_accountName);
		if(s_code)document.write(s_code)
	} 
} else {
	s_wds(s_accountName);s_ca(s_accountName); 
}	

function sendAnalyticsEvent(str){var ns=s_accountName;if(str!=null)ns+=","+str;void(s_gs(ns));}
function sendLinkEvent(accnt,lnkname,type){
accnt=s_accountName;s_linkType=type;s_lnk=true;s_linkName=lnkname;void(s_gs(accnt));}
//--></script>
<noscript><img src="http://stats.adobe.com/b/ss/mxmacromedia/1/H.15-XELvs/0?pageName=http%3A//www.adobe.com%3A%20noscript&ch=http%3A//www.adobe.com%3A%20noscript&g=http%3A//www.adobe.com" height="1" width="1" border="0" alt="" /></noscript>
<!-- End SiteCatalyst -->
</div>

<script language="JavaScript" type="text/javascript">//<![CDATA[
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/atm/s_code_www.js' type='text/javascript'%3E%3C/script%3E"));
//]]></script>
<script type="text/javascript">//<![CDATA[
if(s_adobe){	
	s_adobe.server="www.adobe.com Static Content pages";
	/* Set pageName */
	s_adobe.s_URL="adobe.com"+((location.pathname.charAt(0)=='/')?location.pathname:'/'+location.pathname);
	if (s_adobe.s_URL.substring(s_adobe.s_URL.lastIndexOf('/')+1)=="") s_adobe.s_URL=s_adobe.s_URL+"index.html";
	s_adobe.s_URLSplit=s_adobe.s_URL.split("/");
	s_adobe.pageName=s_adobe.s_URLSplit.join(":");

	/* Set prop4 to language-locale */
	var s_meta=document.getElementsByTagName('meta'); 
      for (i=0; i<s_meta.length; i++) { 
        if (s_meta[i].getAttribute("http-equiv") == "Content-Language") { 
          s_adobe.prop4=s_meta[i].getAttribute("content"); 
	    s_adobe.prop4=s_adobe.prop4.replace(/\s+/g,'');
        } 
      } 
	s_adobe.t()
}
//]]></script>








  </body>
</html>