<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="lang" content="en-us" />
    <meta name="area" content="livedocs" />
    <title>Adobe&#160;ColdFusion&#160;9 * Creating data grids with the cfgrid tag</title>
    <link rel="shortcut icon" href="images/ColdFusionLinkIndicator.png" />
    <meta name="book" content="Developing&#160;ColdFusion 9 Applications" />
    <meta name="product" content="ColdFusion" />
    <meta name="keywords" content="" /><!--<PageMap><DataObject type="document"><Attribute name="product" value="ColdFusion"></Attribute><Attribute name="book" value="Developing&#160;ColdFusion 9 Applications"></Attribute><Attribute name="keywords" value=""></Attribute></DataObject></PageMap>-->
    
    <script type="text/javascript" language="Javascript" charset="UTF-8"><!--[CDATA[
        var currentTreeNode = "WSc3ff6d0ea77859461172e0811cbec22c24-7acf.html";
    document.cookie = "topicId=" + "WSc3ff6d0ea77859461172e0811cbec22c24-7acf.html";
// ]]--></script>
<script src="terms.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="help.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script>  <script src="utilities.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="event.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="treeview.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="toc.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script> <script src="swfobject.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>  <script src="booklist.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>
<script type="text/javascript">
<!--[CDATA[
var topictype = "topic";
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
  var linkId = document.createElement("link");
  linkId.href = "content-ie6.css";
  linkId.rel = "stylesheet";
  linkId.type = "text/css";
  headId.appendChild(linkId);
}
function initRoboHelpDOM() {
  if (use_chm_behavior) {
    hideElement("search");
  }
  if (use_robohelp_behavior) {
    hideElement("search");
    hideElement("productmenu");
    //hideElement("notyourversion");
  }
  if(!use_chc_behavior) {
    //document.getElementById("notyourversion").style.display = "inline";;
  }
}
var dirname = location.pathname.match( /.*\// );    
function setSearchUserPref(){
  if ( document.cookie.indexOf( "ah_searchpref" ) > -1 ) {
    if ( document.cookie.indexOf( dirname ) > 0 ) {
      document.search.gsa.checked = true ;
    }else{
      document.search.gsa.checked = false ;            
    }
  }
}
YAHOO.util.Event.onDOMReady(initRoboHelpDOM);
YAHOO.util.Event.onDOMReady(setSearchUserPref);
// ]]-->
</script>

<!-- ********************************** -->
<!-- START: ForeSee survey code in: /ssi/globalheader.ssi -->

<script type="text/javascript">
<!-- 
// Enable the survey for only English, German and Japanese
var agt=navigator.userAgent.toLowerCase();
if ( agt.indexOf("community help client") == -1 ){
    if ( document.location.href.indexOf("/en_US/") != -1 ){
        showSurvey();
//    }else if (document.location.href.indexOf("/de_DE/") != -1){
//         var locale="de";
//         showSurvey();
    }else if (document.location.href.indexOf("/ja_JP/") != -1 ){
         var locale="ja";
         showSurvey();
    }	
}

function showSurvey(){
	document.write('<script type="text/javascript" src="/js/foresee/foresee-trigger.js"><\/scr'+'ipt>');
}

// -->
</script>

<!-- END: ForeSee survey code -->
<!-- ******************************** -->




    <link rel="stylesheet" type="text/css" href="tree.css" />
    <link rel="stylesheet" type="text/css" href="content.css" />
    <link rel="stylesheet" type="text/css" href="localeSpecific.css" />
  </head>
  <body id="content_body" onload="window.focus();">
    <a name="top" shape="rect"><!--LeaveCommentHere--></a>
    
    <div id="mnemonic">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon" class="ColdFusion"><div class="banner"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html">Adobe&#160;ColdFusion&#160;9</a><span id="notyourversion">|&#160;
                    <a rel="nofollow" href="http://www.adobe.com/support/documentation/en/coldfusion/">Not your version?</a></span></div></div><!--googleon: index-->
    </div>
    
    <div id="searchbar">
<table id="searchbartable">
<tr>
<td colspan="2">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon"><div id="pdf"><img src="images/PDF.gif" width="16" height="16" /><a title="View Help PDF" href="coldfusion_9_dev.pdf">View Help PDF ( 23MB)</a></div></div><!--googleon: index-->
</td>
</tr>
</table>
    </div>

<!-- BEGIN SEARCH CONTENT -->
<form id="search" name="search" action="search.html" target="_self">
<script type="text/javascript">
<!--[CDATA[
if ( !use_chc_behavior ){
    if (typeof(terms_AHV_SEARCH_CONSTRAINT) != "undefined" && 
        terms_AHV_SEARCH_CONSTRAINT.length > 0 && 
        document.location.href.indexOf(".adobe.com") > 0){
        if ( typeof(terms_SEARCH_THIS_HELP_ONLY) != "undefined" && terms_SEARCH_THIS_HELP_ONLY == "ON" ) {
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                checked="checked" \
                value="1" ><\/input>'); 
                
        // Leave the "Search this help system only" checkbox unckecked
        }else{    
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                value="1" ><\/input>'); 
        }
        document.write('<span class="gsalabel">' + terms_AHV_SEARCH_CONSTRAINT + '<\/span><\/div>'); 
    }
    document.write('<input class="searchinput" \
        name="q" \
        id="q" \
        type="text" \
        maxlength="256" \
        value="' + terms_AHV_SEARCH_BUTTON + '" \
        onclick="clearSearch()"><\/input><input \
        type="button" \
        name="searchbutton" \
        class="searchbutton" \
        onclick="submit()"><\/input>'); 
} 
 
/* 
 * Start Functions 
 */
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}

// set search preferences
function setAHSearchPref(){
    if (document.search.gsa.checked == 1){
        setAHSearchCookie( dirname );
    }else{
        setAHSearchCookie( "community" );
    }
}

// Set search preferences cookie
function setAHSearchCookie( p ){
    // set cookie ah_searchpref with a value of the document path
    var expire=new Date();
    expire.setDate(expire.getDate()+365); // Cookie expires after 1 year (365 days) 
    document.cookie="ah_searchpref=" +p+ "; expires=" +expire.toGMTString()+ ";";
}

// ]]-->
</script> 
 </form>
<!-- END SEARCH CONTENT -->    



<!-- BEGIN PAGE CONTENT WRAPPER -->
    <div id="page_content_wrapper">
<!-- BEGIN PAGE WRAPPER -->
<table id="page_content_table">
<tr>

<td id="col2">
<!-- BEGIN CONTENT WRAPPER -->
<!-- BEGIN BREADCRUMBS -->

      
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc3ff6d0ea77859461172e0811cbec22c24-7ab7.html" title="Building slider bar controls"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc3ff6d0ea77859461172e0811cbec22c24-7add.html" title="Embedding Java applets"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Developing&#160;ColdFusion 9 Applications</b></a> / <a href="WSc3ff6d0ea77859461172e0811cdd70508c-8000.html"><b>Requesting and Presenting Information</b></a> 
      / <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7e7d.html"><b>Building Dynamic Forms with cfform Tags</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
      <div id="content_wrapper">
<!-- BEGIN PAGE TITLE -->
        <h1>Creating data grids with the cfgrid tag</h1>
<!-- END PAGE TITLE -->
<!-- BEGIN IONCOMMENTCOUNT -->
        <div id="ionCount">
        </div>
<!-- END IONCOMMENTCOUNT -->
<table id="inner_content_table" width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td>
          <div style="border-top:#ccc solid 1px;"><p> </p>
          </div>
<p id="chcPromo" style="display:none;">
<a id="chcLink" href="http://www.adobe.com/support/chc/">
<img id="chcImage" src="http://www.adobe.com/support/chc/GetMoreHelpFeatures.png"/>
</a>
</p>
<script type="text/javascript" language="javascript" charset="utf-8">
<!--
var cfgArray = [];
//cfgArray["Acrobat_10.0_Professional.helpcfg"] = "acrobatpro";
//cfgArray["Acrobat_10.0_Standard.helpcfg"] = "acrobatstd";
cfgArray["Lightroom_3.0.helpcfg"] = "lightroom";
cfgArray["PhotoshopElements_8.0_Win.helpcfg"] = "photoshopelements";
cfgArray["PhotoshopElements_8.0_Mac.helpcfg"] = "photoshopelementsmac";
cfgArray["PremiereElements_8.0_Win.helpcfg"] = "premiereelements";

//cfgArray["AfterEffects_10.0.helpcfg"] = "aftereffects";
//cfgArray["AIR.helpcfg"] = "air";
//cfgArray["ColdFusionBuilder.helpcfg"] = "coldfusion";
//cfgArray["Contribute_6.0.helpcfg"] = "contribute";
//cfgArray["DeviceCentral_3.0.helpcfg"] = "devicecentral";
//cfgArray["Dreamweaver_11.0.helpcfg"] = "dreamweaver";
//cfgArray["EncoreDVD_5.0.helpcfg"] = "encore";
//cfgArray["ExtensionManager_3.0.helpcfg"] = "extension";
//cfgArray["Fireworks_11.0.helpcfg"] = "fireworks";
//cfgArray["Flash_11.0.helpcfg"] = "flash";
//cfgArray["Flex_4.0.helpcfg"] = "flashbuilder";
//cfgArray["FlashCatalyst_1.0.helpcfg"] = "flashcatalyst";
//cfgArray["Illustrator_15.0.helpcfg"] = "illustrator";
//cfgArray["InCopy_7.0.helpcfg"] = "incopy";
//cfgArray["InDesign_7.0.helpcfg"] = "indesign";
//cfgArray["OnLocation_5.0.helpcfg"] = "onlocation";
//cfgArray["Photoshop_12.0.helpcfg"] = "photoshop";
//cfgArray["PremierePro_5.0.helpcfg"] = "premierepro";

function getLangName() {
    var lang = "en-us";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if (ptn.test(lang)) {
        var languageCode = lang.replace(ptn, "$1");
        var countryCode = lang.replace(ptn, "$2");
        lang = languageCode + "_" + countryCode.toUpperCase();
    }
    return lang;
}

function getCountryName() {
    var lang = "";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if ((ptn.test(lang)) && (lang != "en-us")) {
        var countryCode = lang.replace(ptn, "$2");
        return "/" + countryCode;
    }
    return "";
}

if ( (typeof(terms_HELPCFG) != 'undefined')  && (terms_HELPCFG.indexOf(".helpcfg") != -1) ) {
    var stage   = (document.location.href.indexOf(".stage.") != -1) ? 'stage.' : '';
    var baseUrl = 'http://www.' + stage + 'adobe.com';
    var refpage = document.location.href.replace(/#.*$/, '');
	
	if ((!use_robohelp_behavior) && (terms_HELPCFG.length > 0) && (typeof(cfgArray[terms_HELPCFG]) != 'undefined') && (cfgArray[terms_HELPCFG].length > 0)) {
		if (document.getElementById) { // DOM3 = IE5, NS6
			var newHref = baseUrl + getCountryName() + "/support/chc/" + "?helpcfg=http://help." + stage + "adobe.com/HelpCfg/" + getLangName() + "/" + terms_HELPCFG + "&url=" + refpage + "&product=" + cfgArray[terms_HELPCFG];
			var newSrc = baseUrl + getCountryName() + "/support/chc/GetMoreHelpFeatures.png";
			document.getElementById("chcPromo").style.display = "block";
			document.getElementById("chcLink").href = newHref;
			document.getElementById("chcImage").src = newSrc;
		}
	}
}

//-->
</script>



          <div id="minitoc"><div class="t"><div class="b"><div><ul id="minitoc-links"><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0fb54-7fe5"><span class="topictitle1">Working with a data grid and entering data</span>
</a></p><ul><li><p><a href="#WSf01dbd23413dda0e-54691e821200fe88a2a-7ff9"><span class="topictitle2">Populate a grid from a query</span>
</a></p></li></ul></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0fb54-7ff6"><span class="topictitle1">Creating an editable grid</span>
</a></p><ul><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0fb54-7fd3"><span class="topictitle2">Controlling cell contents</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0fb54-7fe1"><span class="topictitle2">How user edits are returned</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0fb54-7fe6"><span class="topictitle2">Example: editing data in a grid</span>
</a></p><ul><li><p><a href="#WSf01dbd23413dda0e-54691e821200fe88a2a-7ff8"><span class="topictitle3">Create the editable grid</span>
</a></p></li></ul></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0fb54-7fcf"><span class="topictitle2">Updating the database with the cfgridupdate tag</span>
</a></p><ul><li><p><a href="#WSf01dbd23413dda0e-54691e821200fe88a2a-7ff7"><span class="topictitle3">Update the data source with the cfgridupdate tag</span>
</a></p></li></ul></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0fb54-7fe4"><span class="topictitle2">Updating the database with the cfquery tag</span>
</a></p><ul><li><p><a href="#WSf01dbd23413dda0e-54691e821200fe88a2a-7ff6"><span class="topictitle3">Update the data source with the cfquery tag</span>
</a></p></li></ul></li></ul></li></ul></div></div></div></div><div><p>The <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7baf.html" target="_self">cfgrid</a></samp> tag creates a <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7fb7.html" target="_self">cfform</a></samp> grid control that
resembles a spreadsheet table and can contain data populated from
a <samp class="codeph">cfquery</samp> tag or from other sources of data. As
with other <samp class="codeph">cfform</samp> tags, the <samp class="codeph">cfgrid</samp> tag
offers a wide range of data formatting options, as well as the option
of validating user selections with a JavaScript validation script.</p>
<p>You can also perform the following tasks with a <samp class="codeph">cfgrid</samp> tag:</p>
<ul><li><p>Sort data in the grid alphanumerically.</p>
</li>
<li><p>Update, insert, and delete data.</p>
</li>
<li><p>Display images in the grid.</p>
</li>
</ul>
<div class="note"><span class="notetitle">Note:  </span>Flash format grids support a subset of the features
available in applet format grids. For details on features supported
in each format, see the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7baf.html" target="_self">cfgrid</a></samp> tag in the CFML Reference.</div>
<p>Users can sort the grid entries in ascending order by double-clicking
any column header. Double-clicking again sorts the grid in descending
order. In applet format, you can also add sort buttons to the grid
control.</p>
<p>When users select grid data and submit the form, ColdFusion passes
the selection information as form variables to the application page
specified in the <samp class="codeph">cfform</samp><samp class="codeph">action</samp> attribute.</p>
<p>Just as the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d84.html" target="_self">cftree</a></samp> tag uses the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d83.html" target="_self">cftreeitem</a></samp> tag, the <samp class="codeph">cfgrid</samp> tag
uses the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7adc.html" target="_self">cfgridcolumn</a></samp> and <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7a9e.html" target="_self">cfgridrow</a></samp> tags. You can define
a wide range of row and column formatting options, as well as a
column name, data type, selection options, and so on. You use the <samp class="codeph">cfgridcolumn</samp> tag
to define individual columns in the grid or associate a query column
with a grid column. </p>
<p>Use the <samp class="codeph">cfgridrow</samp> tag to define a grid that
does not use a query as the source for row data. If a query attribute
is specified in the <samp class="codeph">cfgrid</samp> tag, the <samp class="codeph">cfgridrow</samp> tags
are ignored.</p>
<p>The <samp class="codeph">cfgrid</samp> tag provides many attributes that
control grid behavior and appearance. Only the most important of
these attributes are described here. For detailed information on
these attributes, see the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7baf.html" target="_self">cfgrid</a></samp> tag in the <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">CFML Reference</i><samp class="codeph">.</samp></p>
</div>
<div id="WSc3ff6d0ea77859461172e0811cbec0fb54-7fe5" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0fb54-7fe5"><!-- --></a><h2 class="topictitle2">Working with a data grid and entering data</h2><div><p>The
following image shows an example applet format grid created using
a <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7baf.html" target="_self">cfgrid</a></samp> tag.</p>
<p>The following table describes some navigating tips:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e70789"><p>Action</p>
</th>
<th valign="top" width="NaN%" id="d17e70792"><p>Procedure</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e70789 "><p>Sorting grid rows</p>
</td>
<td valign="top" width="NaN%" headers="d17e70792 "><p>Double-click the column header to sort a
column in ascending order. Double-click again to sort the rows in
descending order.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e70789 "><p>Rearranging columns</p>
</td>
<td valign="top" width="NaN%" headers="d17e70792 "><p>Click any column heading and drag the column
to a new position.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e70789 "><p>Determining editable grid areas</p>
</td>
<td valign="top" width="NaN%" headers="d17e70792 "><p>When you click an editable cell, it is surrounded
by a yellow box. </p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e70789 "><p>Determining noneditable grid areas</p>
</td>
<td valign="top" width="NaN%" headers="d17e70792 "><p>When you click a cell (or row or column)
that you cannot edit, its background color changes. The default
color is salmon pink. </p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e70789 "><p>Editing a grid cell</p>
</td>
<td valign="top" width="NaN%" headers="d17e70792 "><p>Double-click the cell. Press Return when
you finish entering the data.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e70789 "><p>Deleting a row</p>
</td>
<td valign="top" width="NaN%" headers="d17e70792 "><p>Click any cell in the row and click the
Delete button. (Not available in Flash format grids.)</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e70789 "><p>Inserting a row</p>
</td>
<td valign="top" width="NaN%" headers="d17e70792 "><p>Click the Insert button. An empty row appears
at the bottom of the grid. To enter a value in each cell, double-click
the cell, enter the value, and click Return. (Not available in Flash
format grids.)</p>
</td>
</tr>
</tbody>
</table>
</div>
</div><div id="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff9" class="nochunk"><a name="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff9"><!-- --></a><h3 class="topictitle3">Populate a grid from a query</h3><div><ol><li><p>Create a ColdFusion page named grid1.cfm with the
following contents: </p>
<pre>&lt;cfquery name="empdata" datasource="cfdocexamples"&gt; 
    SELECT * FROM Employee 
&lt;/cfquery&gt; 
 
&lt;cfform name="Form1" action="submit.cfm" &gt; 
    <strong>&lt;cfgrid name="employee_grid" query="empdata"</strong> 
            <strong>selectmode="single"&gt;</strong> 
        <strong>&lt;cfgridcolumn name="Emp_ID"&gt;</strong> 
        <strong>&lt;cfgridcolumn name="LastName"&gt;</strong> 
        <strong>&lt;cfgridcolumn name="Dept_ID"&gt;</strong> 
    &lt;/cfgrid&gt; 
    &lt;br&gt; 
    &lt;cfinput name="submitit" type="Submit" value="Submit"&gt; 
&lt;/cfform&gt;</pre>
<div class="note"><span class="notetitle">Note:  </span>Use the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7adc.html" target="_self">cfgridcolumn</a></samp><samp class="codeph">display="No"</samp> attribute
to hide columns that you want to include in the grid but not expose
to an end user. You typically use this attribute to include columns
such as the table’s primary key column in the results returned by
the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7baf.html" target="_self">cfgrid</a></samp><i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema"> tag.</i></div>
</li>
<li><p>Save the file and view it in your browser. </p>
</li>
</ol>
<div class="section" id="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff9__WSc3ff6d0ea77859461172e0811cbec0fb54-7ff9"><a name="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff9__WSc3ff6d0ea77859461172e0811cbec0fb54-7ff9"><!-- --></a><h4 class="sectiontitle">Reviewing the code</h4><p>The following table describes the highlighted
code and its function:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e70899"><p>Code</p>
</th>
<th valign="top" width="NaN%" id="d17e70902"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e70899 "><p><samp class="codeph">&lt;cfgrid name="employee_grid" query="empdata"</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e70902 "><p>Creates a grid named employee_grid and populate
it with the results of the query empdata.</p>
<p>If you specify a <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7baf.html" target="_self">cfgrid</a> tag with a query attribute
defined and no corresponding <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7adc.html" target="_self">cfgridcolumn</a> attributes, the grid
contains all the columns in the query.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e70899 "><p><samp class="codeph">selectmode="single"&gt;</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e70902 "><p>Allows the user to select only one cell;
does not allow editing. Other modes are row, column, and edit.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e70899 "><p><samp class="codeph">&lt;cfgridcolumn name="Emp_ID"&gt;</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e70902 "><p>Puts the contents of the Emp_ID column in
the query results in the first column of the grid.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e70899 "><p><samp class="codeph">&lt;cfgridcolumn name="LastName"&gt;</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e70902 "><p>Puts the contents of the LastName column
in the query results in the second column of the grid.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e70899 "><p><samp class="codeph">&lt;cfgridcolumn name="Dept_ID"&gt;</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e70902 "><p>Puts the contents of the Dept_ID column
in the query results in the third column of the grid.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0fb54-7ff6" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0fb54-7ff6"><!-- --></a><h2 class="topictitle2">Creating an editable grid</h2><div><p>You
can build grids to allow users to edit data within them. Users can
edit individual cell data, as well as insert, update, or delete
rows. To enable grid editing, you specify <samp class="codeph">selectmode="edit" </samp>in
the <samp class="codeph">cfgrid</samp> tag. </p>
<p>You can let users add or delete grid rows by setting the <samp class="codeph">insert</samp> or <samp class="codeph">delete</samp> attributes
in the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7baf.html" target="_self">cfgrid</a></samp> tag to Yes. Setting
the <samp class="codeph">insert</samp> and <samp class="codeph">delete</samp> attribute
to Yes causes the <samp class="codeph">cfgrid</samp> tag to display Insert
and Delete buttons as part of the grid.</p>
<p>You can use a grid in two ways to change your ColdFusion data
sources:</p>
<ul><li><p>Create a page to which you pass the <samp class="codeph">cfgrid</samp> form
variables. In that page, perform <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7fae.html" target="_self">cfquery</a></samp> operations to update
data source records based on the form values returned by the <samp class="codeph">cfgrid</samp> tag.</p>
</li>
<li><p>Pass grid edits to a page that includes the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7c7c.html" target="_self">cfgridupdate</a></samp> tag, which automatically
extracts the form variable values and passes that data directly
to the data source.</p>
</li>
</ul>
<p>Using the <samp class="codeph">cfquery</samp> tag gives you complete control
over interactions with your data source. The <samp class="codeph">cfgridupdate</samp> tag
provides a much simpler interface for operations that do not require
the same level of control.</p>
</div><div id="WSc3ff6d0ea77859461172e0811cbec0fb54-7fd3" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0fb54-7fd3"><!-- --></a><h3 class="topictitle3">Controlling cell contents</h3><div><p>You
can control the data that a user can enter into a <samp class="codeph">cfgrid</samp> cell
in the following ways:</p>
<ul><li><p>By default, a cell is not editable. Use the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7baf.html" target="_self">cfgrid</a></samp> attribute <samp class="codeph">selectmode="edit"</samp> to
edit cell contents. </p>
</li>
<li><p>Use the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7adc.html" target="_self">cfgridcolumn</a></samp><samp class="codeph">type</samp> attribute
to control sorting order, to make the fields check boxes, or to
display an image.</p>
</li>
<li><p>Use the <samp class="codeph">cfgridcolumn</samp><samp class="codeph">values</samp> attribute
to specify a drop-down list of values from which the user can choose.
You can use the <samp class="codeph">valuesDisplay</samp> attribute to provide
a list of items to display that differs from the actual values that
you enter in the database. You can use the <samp class="codeph">valuesDelimiter</samp> attribute to
specify the separator between values in the <samp class="codeph">values</samp><samp class="codeph">valuesDisplay</samp> lists.</p>
</li>
<li><p>Although the <samp class="codeph">cfgrid</samp> tag does not have a <samp class="codeph">validate</samp> attribute,
it does have an <samp class="codeph">onValidate</samp> attribute that lets
you specify a JavaScript function to perform validation.</p>
</li>
</ul>
<p>For more information on controlling the cell contents, see the
attribute descriptions for the <samp class="codeph">cfgridcolumn</samp> tag
in the <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">CFML Reference</i>.</p>
</div></div><div id="WSc3ff6d0ea77859461172e0811cbec0fb54-7fe1" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0fb54-7fe1"><!-- --></a><h3 class="topictitle3">How user edits are returned</h3><div><p>When a user inserts or deletes
a row in a grid or changes any cells in a row and submits the grid,
ColdFusion creates the following arrays as Form variables:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e71105"><p>Array name</p>
</th>
<th valign="top" width="NaN%" id="d17e71108"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e71105 "><p>gridname.colname</p>
</td>
<td valign="top" width="NaN%" headers="d17e71108 "><p>Stores the new values of inserted, deleted,
or updated cells. (Entries for deleted cells contain empty strings.)</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e71105 "><p>gridname.Original.colname </p>
</td>
<td valign="top" width="NaN%" headers="d17e71108 "><p>Stores the original values of inserted,
deleted, or updated cells.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e71105 "><p>gridname.RowStatus.Action</p>
</td>
<td valign="top" width="NaN%" headers="d17e71108 "><p>Stores the type of change made to the grid
rows: D for delete, I for insert, or U for update. </p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="note"><span class="notetitle">Note:  </span>The periods in these names are <strong>not</strong> structure
separators; they are part of the text of the array name.</div>
<p>ColdFusion creates a <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">gridname.colname</i> array and a <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">gridname.Original.colname </i>array
for each column in the grid. For each inserted, deleted, or changed
row in the grid, ColdFusion creates a row in each of these arrays. </p>
<p>For example, the following arrays are created if you update a <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7baf.html" target="_self">cfgrid</a></samp> tag called mygrid
that consists of two displayable columns (col1, col2) and one hidden column
(col3): </p>
<pre>Form.mygrid.col1 
Form.mygrid.col2 
Form.mygrid.col3 
Form.mygrid.original.col1 
Form.mygrid.original.col2 
Form.mygrid.original.col3 
Form.mygrid.RowStatus.Action</pre>
<p>The value of the array index increments for each row that is
added, deleted, or changed, and does not indicate a grid row number.
All rows for a particular change have the same index in all arrays.
Unchanged rows do not have entries in the arrays.</p>
<p>If the user changes a single cell in col2, the following array
elements contain the edit operation, the edited cell value, and
the original cell value:</p>
<pre>Form.mygrid.RowStatus.Action[1] 
Form.mygrid.col2[1] 
Form.mygrid.original.col2[1]</pre>
<p>If the user changes the values of the cells in col1 and col3
in one row and the cell in col2 in another row, the information
about the original and changed values is in the following array
entries:</p>
<pre>Form.mygrid.RowStatus.Action[1] 
Form.mygrid.col1[1] 
Form.mygrid.original.col1[1] 
Form.mygrid.col3[1] 
Form.mygrid.original.col3[1] 
Form.mygrid.RowStatus.Action[2] 
Form.mygrid.col2[2] 
Form.mygrid.original.col2[2]</pre>
<p>The remaining cells in the arrays (for example, Form.mygrid.col2[1]
and Form.mygrid.original.col2[1]) have the original, unchanged values.</p>
</div></div><div id="WSc3ff6d0ea77859461172e0811cbec0fb54-7fe6" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0fb54-7fe6"><!-- --></a><h3 class="topictitle3">Example: editing data in a grid</h3><div><p>The following example creates an editable
grid. For code brevity, the example handles only three of the fields
in the Employee table. A more realistic example would include, at
a minimum, all seven table fields. It can also hide the contents of
the Emp_ID column or display the Department name (from the Departmt table),
instead of the Department ID.</p>
</div><div id="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff8" class="nochunk"><a name="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff8"><!-- --></a><h4 class="topictitle4">Create the editable grid</h4><div><ol><li><p>Create a ColdFusion page with the following content: </p>
<pre>&lt;cfquery name="empdata" datasource="cfdocexamples"&gt; 
    SELECT * FROM Employee 
&lt;/cfquery&gt; 
 
&lt;cfform name="GridForm" 
    action="handle_grid.cfm"&gt; 
 
    &lt;cfgrid name="employee_grid" 
        height=425 
        width=300 
        vspace=10 
        selectmode="edit" 
        query="empdata" 
        insert="Yes" 
        delete="Yes"&gt; 
         
        &lt;cfgridcolumn name="Emp_ID" 
            header="Emp ID" 
            width=50 
            headeralign="center" 
            headerbold="Yes" 
            select="No"&gt; 
 
        &lt;cfgridcolumn name="LastName" 
            header="Last Name" 
            width=100 
            headeralign="center" 
            headerbold="Yes"&gt; 
 
        &lt;cfgridcolumn name="Dept_ID" 
            header="Dept" 
            width=35 
            headeralign="center" 
            headerbold="Yes"&gt; 
 
    &lt;/cfgrid&gt; 
    &lt;br&gt; 
    &lt;cfinput name="submitit" type="Submit" value="Submit"&gt; 
&lt;/cfform&gt;</pre>
</li>
<li><p>Save the file as grid2.cfm.</p>
</li>
<li><p>View the results in your browser.</p>
</li>
</ol>
<div class="section" id="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff8__WSc3ff6d0ea77859461172e0811cbec0fb54-7fe3"><a name="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff8__WSc3ff6d0ea77859461172e0811cbec0fb54-7fe3"><!-- --></a><h4 class="sectiontitle">Reviewing the code</h4><p>The following table describes the code and its
function:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e71204"><p>Code</p>
</th>
<th valign="top" width="NaN%" id="d17e71207"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e71204 "><div class="para"><pre>&lt;cfgrid name="employee_grid" 
    height=425 
    width=300 
    vspace=10 
    selectmode="edit" 
    query="empdata" 
    insert="Yes" 
    delete="Yes"&gt;</pre>
</div>
</td>
<td valign="top" width="NaN%" headers="d17e71207 "><p>Populates a <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7baf.html" target="_self">cfgrid</a> control with data from the
empdata query. Selecting a grid cell enables you to edit it. You
can insert and delete rows. The grid is 425 X 300 pixels and has
10 pixels of space above and below it.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e71204 "><div class="para"><pre>&lt;cfgridcolumn name="Emp_ID" 
    header="Emp ID" 
    width=50 
    headeralign="center" 
    headerbold="Yes" 
    select="No"&gt;</pre>
</div>
</td>
<td valign="top" width="NaN%" headers="d17e71207 "><p>Creates a 50-pixel wide column for the data
in the Emp_ID column of the data source. Centers a header named
Emp ID and makes it bold. </p>
<p>Does not allow users to select
fields in this column for editing. Since this field is the table’s primary
key, users should not be able to change it for existing records,
and the DBMS should generate this field as an autoincrement value.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e71204 "><div class="para"><pre>&lt;cfgridcolumn name="LastName" 
    header="Last Name" 
    width=100 
    headeralign="center" 
    headerbold="Yes"&gt;</pre>
</div>
</td>
<td valign="top" width="NaN%" headers="d17e71207 "><p>Creates a 100-pixel wide column for the
data in the LastName column of the data source. Centers a header
named Last Name and makes it bold. </p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e71204 "><div class="para"><pre>&lt;cfgridcolumn name="Dept_ID" 
    header="Dept" 
    width=35 
    headeralign="center" 
    headerbold="Yes"&gt;</pre>
</div>
</td>
<td valign="top" width="NaN%" headers="d17e71207 "><p>Creates a 35-pixel wide column for the data
in the Dept_ID column of the data source. Centers a header named
Dept and makes it bold. </p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div></div><div id="WSc3ff6d0ea77859461172e0811cbec0fb54-7fcf" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0fb54-7fcf"><!-- --></a><h3 class="topictitle3">Updating the database with the cfgridupdate tag</h3><div><p>The <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7c7c.html" target="_self">cfgridupdate</a></samp> tag provides
a simple mechanism for updating the database, including inserting
and deleting records. It can add, update, and delete records simultaneously.
It is convenient because it automatically handles collecting the <samp class="codeph">cfgrid</samp> changes
from the various form variables, and generates appropriate SQL statements
to update your data source.</p>
<p>In most cases, use the <samp class="codeph">cfgridupdate</samp> tag to update
your database. However, this tag does not provide the complete SQL
control that the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7fae.html" target="_self">cfquery</a></samp> tag provides. In
particular, the <samp class="codeph">cfgridupdate</samp> tag has the following
characteristics: </p>
<ul><li><p>You can update only a single table.</p>
</li>
<li><p>Rows are deleted first, then rows are inserted, then any
changes are made to existing rows. You cannot modify the order of
changes.</p>
</li>
<li><p>Updating stops when an error occurs. It is possible that
some database changes are made, but the tag does not provide any
information on them.</p>
</li>
</ul>
</div><div id="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff7" class="nochunk"><a name="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff7"><!-- --></a><h4 class="topictitle4">Update the data source with the cfgridupdate tag</h4><div><ol><li><p>Create a ColdFusion page with the following contents: </p>
<pre>&lt;html&gt; 
&lt;head&gt; 
    &lt;title&gt;Update grid values&lt;/title&gt; 
&lt;/head&gt; 
&lt;body&gt; 
 
&lt;h3&gt;Updating grid using cfgridupdate tag.&lt;/h3&gt; 
 
<strong>&lt;cfgridupdate grid="employee_grid"</strong> 
    <strong>datasource="cfdocexamples"</strong> 
    <strong>tablename="Employee"&gt;</strong> 
     
Click &lt;a href="grid2.cfm"&gt;here&lt;/a&gt; to display updated grid. 
     
    &lt;/body&gt; 
&lt;/html&gt;</pre>
</li>
<li><p>Save the file as handle_grid.cfm.</p>
</li>
<li><p>View the grid2.cfm page in your browser, change the grid,
and then submit them.</p>
</li>
</ol>
<div class="note"><span class="notetitle">Note:  </span>To update a grid cell, modify the cell contents,
and then press Return. </div>
<div class="section" id="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff7__WSc3ff6d0ea77859461172e0811cbec0fb54-7fd4"><a name="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff7__WSc3ff6d0ea77859461172e0811cbec0fb54-7fd4"><!-- --></a><h4 class="sectiontitle">Reviewing the code</h4><p>The following table describes the highlighted
code and its function:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e71325"><p>Code</p>
</th>
<th valign="top" width="NaN%" id="d17e71328"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e71325 "><p><samp class="codeph">&lt;cfgridupdate grid="employee_grid"</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e71328 "><p>Updates the database from the Employee_grid
grid.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e71325 "><p><samp class="codeph">datasource="cfdocexamples"</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e71328 "><p>Updates the cfdocexamples data source.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e71325 "><p><samp class="codeph">tablename="Employee"</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e71328 "><p>Updates the Employee table.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div></div><div id="WSc3ff6d0ea77859461172e0811cbec0fb54-7fe4" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0fb54-7fe4"><!-- --></a><h3 class="topictitle3">Updating the database with the cfquery tag</h3><div><p>You
can use the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7fae.html" target="_self">cfquery</a></samp> tag to update your
database from the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7baf.html" target="_self">cfgrid</a></samp> changes. This tag
provides you with full control over how the updates are made and
lets you handle any errors that arise.</p>
</div><div id="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff6" class="nochunk"><a name="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff6"><!-- --></a><h4 class="topictitle4">Update the data source with the cfquery tag</h4><div><ol><li><p>Create a ColdFusion page with the following content: </p>
<pre>&lt;html&gt; 
&lt;head&gt; 
    &lt;title&gt;Catch submitted grid values&lt;/title&gt; 
&lt;/head&gt; 
&lt;body&gt; 
 
&lt;h3&gt;Grid values for Form.employee_grid row updates&lt;/h3&gt; 
 
&lt;cfif isdefined("Form.employee_grid.rowstatus.action")&gt; 
 
    &lt;cfloop index = "counter" from = "1" to = 
        #arraylen(Form.employee_grid.rowstatus.action)#&gt; 
 
        &lt;cfoutput&gt; 
            The row action for #counter# is: 
            #Form.employee_grid.rowstatus.action[counter]# 
            &lt;br&gt; 
        &lt;/cfoutput&gt; 
 
        &lt;cfif Form.employee_grid.rowstatus.action[counter] is "D"&gt; 
            &lt;cfquery name="DeleteExistingEmployee"  
                datasource="cfdocexamples"&gt; 
                DELETE FROM Employee 
                WHERE Emp_ID=&lt;cfqueryparam 
                            value="#Form.employee_grid.original.Emp_ID[counter]#"  
                            CFSQLType="CF_SQL_INTEGER" &gt; 
            &lt;/cfquery&gt; 
 
        &lt;cfelseif Form.employee_grid.rowstatus.action[counter] is "U"&gt; 
            &lt;cfquery name="UpdateExistingEmployee" 
                datasource="cfdocexamples"&gt; 
                UPDATE Employee 
                SET  
                    LastName=&lt;cfqueryparam  
                            value="#Form.employee_grid.LastName[counter]#"  
                            CFSQLType="CF_SQL_VARCHAR" &gt;, 
                    Dept_ID=&lt;cfqueryparam  
                            value="#Form.employee_grid.Dept_ID[counter]#"  
                            CFSQLType="CF_SQL_INTEGER" &gt; 
                WHERE Emp_ID=&lt;cfqueryparam 
                    value="#Form.employee_grid.original.Emp_ID[counter]#"  
                    CFSQLType="CF_SQL_INTEGER"&gt; 
            &lt;/cfquery&gt; 
 
        &lt;cfelseif Form.employee_grid.rowstatus.action[counter] is "I"&gt; 
            &lt;cfquery name="InsertNewEmployee" 
                datasource="cfdocexamples"&gt; 
                INSERT into Employee (LastName, Dept_ID) 
                VALUES (&lt;cfqueryparam  
                    value="#Form.employee_grid.LastName[counter]#"  
                            CFSQLType="CF_SQL_VARCHAR" &gt;, 
                        &lt;cfqueryparam value="#Form.employee_grid.Dept_ID[counter]#"  
                            CFSQLType="CF_SQL_INTEGER" &gt;) 
            &lt;/cfquery&gt; 
 
        &lt;/cfif&gt; 
    &lt;/cfloop&gt; 
&lt;/cfif&gt; 
 
Click &lt;a href="grid2.cfm"&gt;here&lt;/a&gt; to display updated grid.     
 
&lt;/body&gt; 
&lt;/html&gt;</pre>
</li>
<li><p>Rename your existing handle_grid.cfm file as handle_grid2.cfm
to save it, and then save this file as handle_grid.cfm.</p>
</li>
<li><p>View the grid2.cfm page in your browser, change the grid,
and then submit them.</p>
</li>
</ol>
<div class="section" id="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff6__WSc3ff6d0ea77859461172e0811cbec0fb54-7fd2"><a name="WSf01dbd23413dda0e-54691e821200fe88a2a-7ff6__WSc3ff6d0ea77859461172e0811cbec0fb54-7fd2"><!-- --></a><h4 class="sectiontitle">Reviewing the code</h4><p>The following table describes the code and its
function:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e71401"><p>Code</p>
</th>
<th valign="top" width="NaN%" id="d17e71404"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e71401 "><div class="para"><pre>&lt;cfif isdefined("Form.employee_grid.rowstatus.action")&gt; 
    &lt;cfloop index = "counter" from = "1" to = #arraylen(Form.employee_grid.rowstatus.action)#&gt;</pre>
</div>
</td>
<td valign="top" width="NaN%" headers="d17e71404 "><p>If there is an array of edit types, changes
the table. Otherwise, does nothing. Loops through the remaining code
once for each row to be changed. The <samp class="codeph">counter</samp> variable
is the common index into the arrays of change information for the
row being changed.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e71401 "><div class="para"><pre>&lt;cfoutput&gt; 
    The row action for #counter# is: 
    #Form.employee_grid.rowstatus.action[counter]# 
    &lt;br&gt; 
&lt;/cfoutput&gt;</pre>
</div>
</td>
<td valign="top" width="NaN%" headers="d17e71404 "><p>Displays the action code for this row: U
for update, I for insert, or D for delete.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e71401 "><div class="para"><pre>&lt;cfif Form.employee_grid.rowstatus.action[counter] is "D"&gt; 
    &lt;cfquery name="DeleteExistingEmployee"  
        datasource="cfdocexamples"&gt; 
        DELETE FROM Employee 
        WHERE Emp_ID=&lt;cfqueryparam value="#Form.employee_grid.original.Emp_ID[counter]#"  
            CFSQLType="CF_SQL_INTEGER" &gt; 
    &lt;/cfquery&gt;</pre>
</div>
</td>
<td valign="top" width="NaN%" headers="d17e71404 "><p>If the action is to delete a row, generates
a SQL DELETE query specifying the Emp_ID (the primary key) of the row
to be deleted.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e71401 "><div class="para"><pre>&lt;cfelseif Form.employee_grid.rowstatus.action[counter] is "U"&gt; 
    &lt;cfquery name="UpdateExistingEmployee" 
        datasource="cfdocexamples"&gt; 
        UPDATE Employee 
        SET  
            LastName=&lt;cfqueryparam  
            value="#Form.employee_grid.LastName[counter]#"  
            CFSQLType="CF_SQL_VARCHAR" &gt;, 
            Dept_ID=&lt;cfqueryparam  
            value="#Form.employee_grid.Dept_ID[counter]#"  
            CFSQLType="CF_SQL_INTEGER" &gt; 
        WHERE Emp_ID=&lt;cfqueryparam 
    value="#Form.employee_grid.original.Emp_ID[counter]#"  
        CFSQLType="CF_SQL_INTEGER"&gt; 
    &lt;/cfquery&gt;</pre>
</div>
</td>
<td valign="top" width="NaN%" headers="d17e71404 "><p>Otherwise, if the action is to update a
row, generates a SQL UPDATE query to update the LastName and Dept_ID
fields for the row specified by the Emp_ID primary table key. </p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e71401 "><div class="para"><pre>&lt;cfelseif Form.employee_grid.rowstatus.action[counter] is "I"&gt; 
    &lt;cfquery name="InsertNewEmployee" 
        datasource="cfdocexamples"&gt; 
        INSERT into Employee (LastName, Dept_ID) 
        VALUES (&lt;cfqueryparam  
            value="#Form.employee_grid.LastName[counter]#"  
            CFSQLType="CF_SQL_VARCHAR" &gt;, 
            &lt;cfqueryparam value="#Form.employee_grid.Dept_ID[counter]#"  
        CFSQLType="CF_SQL_INTEGER" &gt;) 
    &lt;/cfquery&gt;</pre>
</div>
</td>
<td valign="top" width="NaN%" headers="d17e71404 "><p>Otherwise, if the action is to insert a
row, generates a SQL INSERT query to insert the employee’s last
name and department ID from the grid row into the database. The
INSERT statement assumes that the DBMS automatically increments
the Emp_ID primary key. If you use the version of the cfdocexamples
database that is provided for UNIX installations, the record is
inserted without an Emp_ID number.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e71401 "><div class="para"><pre>&lt;/cfif&gt; 
    &lt;/cfloop&gt; 
&lt;/cfif&gt;</pre>
</div>
</td>
<td valign="top" width="NaN%" headers="d17e71404 "><p>Closes the <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7fe8.html" target="_self">cfif</a> tag used to select among deleting, updating,
and inserting.</p>
<p>Closes the loop used for each row to be changed.</p>
<p>Closes
the <samp class="codeph">cfif</samp> tag that surrounds all the active code.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div></div></div>


<!-- BEGIN USER PREFERENCES -->
          <div id="userprefs">
          </div>
<!-- END USER PREFERENCES -->

          <div id="related">
            
            
            <div class="separator"><a href="#top"><img src="images/BTT.jpg" /></a>&#160;</div>
          </div>
          <div id="footer">
<!-- BEGIN IONCOMMENTS -->
            <div id="ionComHere">
            </div>
<!-- END IONCOMMENTS -->


            <p id="creativecommons"><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text"><img id="creativecommons_img" src="images/CC.png" alt="This work is licensed under a Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License" /></a>&nbsp;Twitter™ and Facebook posts are not covered under the terms of Creative Commons.</p>
          </div>
</td>
<td width="10px"></td>
<td id="inner_rightcolumn">

</td></tr></table>
      </div>
<!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc3ff6d0ea77859461172e0811cbec22c24-7ab7.html" title="Building slider bar controls"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc3ff6d0ea77859461172e0811cbec22c24-7add.html" title="Embedding Java applets"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Developing&#160;ColdFusion 9 Applications</b></a> / <a href="WSc3ff6d0ea77859461172e0811cdd70508c-8000.html"><b>Requesting and Presenting Information</b></a> 
      / <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7e7d.html"><b>Building Dynamic Forms with cfform Tags</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
<!-- END CONTENT WRAPPER -->

</td>
<td id="col3">
    <div>
        <img src="images/adobe-lq.png" />
    </div>
</td>
</tr>
</table>
    </div>
<!-- END PAGE CONTENT WRAPPER -->
<script type="text/javascript">
<!--[CDATA[
scrollToNameAnchor();
// ]]-->
</script> 
<!--
    Description:
    This file generates the link to product support in the top right corner
-->

<style>
#menutop{
    position:absolute;
    top:4px;
    right:24px;
    width:auto;    
    font-size:11px;
    color:#fff;
    text-align:right;
}
#menutop a{
    color:#fff;
}
#menutop a:hover{
        text-decoration:underline;
}
</style>  
  
  
  
  
<div id="productmenu">
<!--googleoff: index-->
  <div id="menutop">


<script language=javascript type='text/javascript'>
    // darken menu text for products with light backgrounds
    var path = document.location.href.toLowerCase();
    if (path.indexOf("/acrobat/")           	> 0 ||
        path.indexOf("/acrobat.com/")       	> 0 ||
        path.indexOf("/acrobatConnectPro/") 	> 0 ||
        path.indexOf("/connect/")           	> 0 ||
        path.indexOf("/livecycledataserviceses/") > 0 ||
        path.indexOf("/muse/")         	> 0 ||
	path.indexOf("/presenter/")         	> 0 ||
        path.indexOf("/scene7/")            	> 0 ||
        path.indexOf("/flashmediaserver/")  	> 0 ||
        path.indexOf("/wave/")              	> 0 )
    {
        document.write('<style>#menutop a{color:#505050}</style>');
    }
    if (typeof('terms_AHV_PRODUCT_SUPPORT') != "undefined" && ! use_robohelp_behavior ){      
        if (path.indexOf("/muse/") > -1 ){
            var supportlink = '<a href="http://muse.adobe.com/support.html">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }else{
            var supportlink = '<a href="http://adobe.com/support">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }
        document.write( supportlink );
     }

</script> 

  </div>
<!--googleon: index-->
</div>



<style>
#online-privacy-policy{ 
    margin:10px 40px; 
    font-size:11px;
}
</style>

<p id="online-privacy-policy">
<script language="javascript">
var pageLoc = "en_US";
var metaElements = document.all ?
document.all.tags('meta') :
document.getElementsByTagName ?
document.getElementsByTagName ('meta') : new Array();
for (var m = 0; m < metaElements.length; m++) {
	if (metaElements[m].name == "lang") {
		pageLoc = metaElements[m].content;
		break;
	}
}
var ptn = /(..)-(..)/;
if (ptn.test(pageLoc)) {
	var languageCode = pageLoc.replace(ptn, "$1");
	var countryCode = pageLoc.replace(ptn, "$2");
	pageLoc = languageCode + "_" + countryCode.toUpperCase();
}

var policyLoc = "en_US";
var policyText = "Online Privacy Policy";
var policyPath = "";
var policyArray=[
"da_DK", "Online fortrolighedserklæring",
"de_DE", "Online-Datenschutzrichtlinie",
"es_ES", "Política de confidencialidad en línea",
"fi_FI", "Yksityisyyttä koskeva Online-toimintaohjelma",
"fr_FR", "Confidentialité et sécurité",
"it_IT", "Informativa sulla privacy online",
"ja_JP", "プライバシーポリシー",
"ko_KR", "Adobe 온라인 개인정보 보호정책",
"pt_BR", "Política de Confidencialidade On-line", 
"zh_CN", "在线隐私政策",
"zh_TW", "線上隱私政策"
];
var legalLoc = "en_US";
var legalText = "Legal Notices";
var legalPath = legalLoc;
var legalArray=[
"ar_AE", "إشعارات قانونية",
"bg_BG", "Юридически бележки",
"cs_CZ", "Právní upozornění",
"da_DK", "Juridiske meddelelser",
"de_DE", "Rechtliche Hinweise",
"el_GR", "Σημειώσεις νομικού περιεχομένου",
"es_ES", "Avisos legales",
"et_EE", "Juriidilised teated",
"fi_FI", "Lakisääteiset ilmoitukset",
"fr_FR", "Mentions légales",
"he_IL", "הצהרות משפטיות",
"hr_HR", "Pravne napomene",
"hu_HU", "Jogi közlemények",
"it_IT", "Informazioni legali",
"ja_JP", "法律上の注意",
"ko_KR", "법적 고지 사항",
"lt_LT", "Teisinės pastabos",
"lv_LV", "Juridisks paziņojums",
"nb_NO", "Juridiske merknader",
"nl_NL", "Juridische kennisgevingen",
"pl_PL", "Informacje prawne",
"pt_BR", "Aspectos jurídicos",
"ro_RO", "Prevederi legale",
"ru_RU", "Юридическая информация",
"sk_SK", "Právne upozornenie",
"sl_SI", "Pravni pouk",
"sv_SE", "Upphovsrätt",
"tr_TR", "Yasal uyarılar",
"uk_UA", "Юридична інформація",
"zh_CN", "法律声明",
"zh_TW", "法律注意事項"
];

ruPolicy = "http://www.adobe.com/ru/misc/privacy.html";
trPolicy = "http://www.adobe.com/tr/misc/privacy.html";

// Bug 2846992: LOC: RUS, TUR: The link to "Online Privacy Policy" should include language, currently it is not appearing.
if (pageLoc == "ru_RU") {
	policyPath = "ru";
}
else if (pageLoc == "tr_TR") {
	policyPath = "tr";
}
for (var i = 0; i < policyArray.length; i+=2) {
	if (pageLoc == policyArray[i]) {
		policyLoc = pageLoc;
		policyText = policyArray[i+1];
		var ptn = /(..)_(..)/;
		if (ptn.test(policyLoc)) {
			var countryCode = policyLoc.replace(ptn, "$2");
			policyPath = countryCode.toLowerCase();
		}
		break;
	}
}

for (var i = 0; i < legalArray.length; i+=2) {
	if (pageLoc == legalArray[i]) {
		legalLoc = pageLoc;
		legalText = legalArray[i+1];
		legalPath = legalLoc;
		break;
	}
}
if(agt.indexOf("community help client") > -1 ){
	document.write('<a href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
}else{
	//Open the privacy policy in a new window
	document.write('<a target="_blank" href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a target="_blank" href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
} 
</script>
</p>



<!-- localfooter.ssi -->

<script type="text/javascript">
    var debug = (top.location.href.indexOf("debug=true") > -1);
</script>

<script language="javascript">
document.write('<scr'+'ipt ' +
               'src="/en_US/ssi/_pod.js" ' +
               'language="javascript" ' +
               'charset="UTF-8"> ' +
               '</scr'+'ipt>');
</script>


<script type="text/javascript">
//
//  Ethnio survey code
//
/*          DocumentID      EthnioID */
/*          -------------   -------- */
var ethnio=["/en_US/flash/cs/using/WSb03e830bd6f770ee6664507612436d7dede-8000.html", "87462",
            "/en_US/creativesuite/cs/using/WSe851854fd1e0856a-4b08a77612477f69f15-8000.html",  "10441",
            "/en_US/dreamweaver/cs/using/WSEE4C0148-A6F4-4bf5-9DEF-CE06AB026214a.html",  "57412"
 
    ];
                        
    for ( var i = 0; i < ethnio.length ; i = i+2 ){
        if ( document.location.href.indexOf( ethnio[i] ) > -1 ){ 
            var headID = document.getElementsByTagName("head")[0];         
            var ethnioScript = document.createElement('script');
            ethnioScript.type = 'text/javascript';
            ethnioScript.src = 'http://ethn.io/remotes/' + ethnio[i+1];        
            if ( debug ){
                alert ("Using Ethnio script: " + ethnioScript.src );
            }else{
                headID.appendChild(ethnioScript);
            }
        }
    }
</script>



<div style="display: none;">
<!-- SiteCatalyst -->
<script language="JavaScript" type="text/javascript"><!--
var s_code=' ';
var s_docHost = window.location.hostname.toLowerCase();
var s_docURL = window.location.pathname.toLowerCase();
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
if (s_docHost.indexOf(".corp.adobe") != -1 || s_docHost.indexOf("stage.") != -1 || s_docHost.indexOf(".dev.adobe") != -1 || s_docHost.indexOf("staging.") != -1) scJsHost="";
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/omniture_s_code.js' type='text/javascript'%3E%3C/script%3E"));
//--></script>
<script type="text/javascript"><!--
var s_accountName;
s_server="www.adobe.com static content pages";
if (!window.s_account) s_accountName="mxmacromedia";
else s_accountName=window.s_account;

if (window.s_docURL.indexOf("/designcenter/") != -1)
  s_channel="Adobe Design Center";	
else if ((window.s_docHost.indexOf("labs.adobe") != -1) ||
(window.s_docHost.indexOf("labs-staging.") != -1))
  s_channel="Labs";
else if (window.s_docHost.indexOf("help.adobe.com") != -1) {
  s_channel="Support Help.adobe.com";
  if (window.s_docURL.indexOf("/en_us/") == -1) {
    s_docURLArray=s_docURL.split('/');
    s_pageName="http://help.adobe.com/"+s_docURLArray[1]+"/"+ s_docURLArray[2]+"/"+s_docURLArray[3];
    s_prop23="http://help.adobe.com"+window.location.pathname;
  }
}
else if (window.s_docHost.indexOf("kb2.adobe.com") != -1) {
  s_channel="Support Knowledgebase";
  s_prop23="http://kb2.adobe.com"+s_docURL+":";
  if (typeof(omtrProductList) != 'undefined' && omtrProductList.length > 0)
 {
    s_prop23=s_prop23+omtrProductList;
  }
}
else if (window.s_docHost.indexOf("resellers.adobe.com") != -1) {
		var s_pageName=document.getElementsByTagName("title")[0].text;
}

if (!window.scMMInclude) {
	var s_wd=window,s_tm=new Date;
	if(s_code!=' '){
		s_code=s_dc(s_accountName);
		if(s_code)document.write(s_code)
	} 
} else {
	s_wds(s_accountName);s_ca(s_accountName); 
}	

function sendAnalyticsEvent(str){var ns=s_accountName;if(str!=null)ns+=","+str;void(s_gs(ns));}
function sendLinkEvent(accnt,lnkname,type){
accnt=s_accountName;s_linkType=type;s_lnk=true;s_linkName=lnkname;void(s_gs(accnt));}
//--></script>
<noscript><img src="http://stats.adobe.com/b/ss/mxmacromedia/1/H.15-XELvs/0?pageName=http%3A//www.adobe.com%3A%20noscript&ch=http%3A//www.adobe.com%3A%20noscript&g=http%3A//www.adobe.com" height="1" width="1" border="0" alt="" /></noscript>
<!-- End SiteCatalyst -->
</div>

<script language="JavaScript" type="text/javascript">//<![CDATA[
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/atm/s_code_www.js' type='text/javascript'%3E%3C/script%3E"));
//]]></script>
<script type="text/javascript">//<![CDATA[
if(s_adobe){	
	s_adobe.server="www.adobe.com Static Content pages";
	/* Set pageName */
	s_adobe.s_URL="adobe.com"+((location.pathname.charAt(0)=='/')?location.pathname:'/'+location.pathname);
	if (s_adobe.s_URL.substring(s_adobe.s_URL.lastIndexOf('/')+1)=="") s_adobe.s_URL=s_adobe.s_URL+"index.html";
	s_adobe.s_URLSplit=s_adobe.s_URL.split("/");
	s_adobe.pageName=s_adobe.s_URLSplit.join(":");

	/* Set prop4 to language-locale */
	var s_meta=document.getElementsByTagName('meta'); 
      for (i=0; i<s_meta.length; i++) { 
        if (s_meta[i].getAttribute("http-equiv") == "Content-Language") { 
          s_adobe.prop4=s_meta[i].getAttribute("content"); 
	    s_adobe.prop4=s_adobe.prop4.replace(/\s+/g,'');
        } 
      } 
	s_adobe.t()
}
//]]></script>








  </body>
</html>