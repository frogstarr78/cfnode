<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="lang" content="en-us" />
    <meta name="area" content="livedocs" />
    <title>Adobe&#160;ColdFusion&#160;9 * Using .NET classes</title>
    <link rel="shortcut icon" href="images/ColdFusionLinkIndicator.png" />
    <meta name="book" content="Developing&#160;ColdFusion 9 Applications" />
    <meta name="product" content="ColdFusion" />
    <meta name="keywords" content="" /><!--<PageMap><DataObject type="document"><Attribute name="product" value="ColdFusion"></Attribute><Attribute name="book" value="Developing&#160;ColdFusion 9 Applications"></Attribute><Attribute name="keywords" value=""></Attribute></DataObject></PageMap>-->
    
    <script type="text/javascript" language="Javascript" charset="UTF-8"><!--[CDATA[
        var currentTreeNode = "WSc3ff6d0ea77859461172e0811cbec22c24-789e.html";
    document.cookie = "topicId=" + "WSc3ff6d0ea77859461172e0811cbec22c24-789e.html";
// ]]--></script>
<script src="terms.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="help.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script>  <script src="utilities.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="event.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="treeview.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="toc.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script> <script src="swfobject.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>  <script src="booklist.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>
<script type="text/javascript">
<!--[CDATA[
var topictype = "topic";
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
  var linkId = document.createElement("link");
  linkId.href = "content-ie6.css";
  linkId.rel = "stylesheet";
  linkId.type = "text/css";
  headId.appendChild(linkId);
}
function initRoboHelpDOM() {
  if (use_chm_behavior) {
    hideElement("search");
  }
  if (use_robohelp_behavior) {
    hideElement("search");
    hideElement("productmenu");
    //hideElement("notyourversion");
  }
  if(!use_chc_behavior) {
    //document.getElementById("notyourversion").style.display = "inline";;
  }
}
var dirname = location.pathname.match( /.*\// );    
function setSearchUserPref(){
  if ( document.cookie.indexOf( "ah_searchpref" ) > -1 ) {
    if ( document.cookie.indexOf( dirname ) > 0 ) {
      document.search.gsa.checked = true ;
    }else{
      document.search.gsa.checked = false ;            
    }
  }
}
YAHOO.util.Event.onDOMReady(initRoboHelpDOM);
YAHOO.util.Event.onDOMReady(setSearchUserPref);
// ]]-->
</script>

<!-- ********************************** -->
<!-- START: ForeSee survey code in: /ssi/globalheader.ssi -->

<script type="text/javascript">
<!-- 
// Enable the survey for only English, German and Japanese
var agt=navigator.userAgent.toLowerCase();
if ( agt.indexOf("community help client") == -1 ){
    if ( document.location.href.indexOf("/en_US/") != -1 ){
        showSurvey();
//    }else if (document.location.href.indexOf("/de_DE/") != -1){
//         var locale="de";
//         showSurvey();
    }else if (document.location.href.indexOf("/ja_JP/") != -1 ){
         var locale="ja";
         showSurvey();
    }	
}

function showSurvey(){
	document.write('<script type="text/javascript" src="/js/foresee/foresee-trigger.js"><\/scr'+'ipt>');
}

// -->
</script>

<!-- END: ForeSee survey code -->
<!-- ******************************** -->




    <link rel="stylesheet" type="text/css" href="tree.css" />
    <link rel="stylesheet" type="text/css" href="content.css" />
    <link rel="stylesheet" type="text/css" href="localeSpecific.css" />
  </head>
  <body id="content_body" onload="window.focus();">
    <a name="top" shape="rect"><!--LeaveCommentHere--></a>
    
    <div id="mnemonic">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon" class="ColdFusion"><div class="banner"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html">Adobe&#160;ColdFusion&#160;9</a><span id="notyourversion">|&#160;
                    <a rel="nofollow" href="http://www.adobe.com/support/documentation/en/coldfusion/">Not your version?</a></span></div></div><!--googleon: index-->
    </div>
    
    <div id="searchbar">
<table id="searchbartable">
<tr>
<td colspan="2">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon"><div id="pdf"><img src="images/PDF.gif" width="16" height="16" /><a title="View Help PDF" href="coldfusion_9_dev.pdf">View Help PDF ( 23MB)</a></div></div><!--googleon: index-->
</td>
</tr>
</table>
    </div>

<!-- BEGIN SEARCH CONTENT -->
<form id="search" name="search" action="search.html" target="_self">
<script type="text/javascript">
<!--[CDATA[
if ( !use_chc_behavior ){
    if (typeof(terms_AHV_SEARCH_CONSTRAINT) != "undefined" && 
        terms_AHV_SEARCH_CONSTRAINT.length > 0 && 
        document.location.href.indexOf(".adobe.com") > 0){
        if ( typeof(terms_SEARCH_THIS_HELP_ONLY) != "undefined" && terms_SEARCH_THIS_HELP_ONLY == "ON" ) {
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                checked="checked" \
                value="1" ><\/input>'); 
                
        // Leave the "Search this help system only" checkbox unckecked
        }else{    
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                value="1" ><\/input>'); 
        }
        document.write('<span class="gsalabel">' + terms_AHV_SEARCH_CONSTRAINT + '<\/span><\/div>'); 
    }
    document.write('<input class="searchinput" \
        name="q" \
        id="q" \
        type="text" \
        maxlength="256" \
        value="' + terms_AHV_SEARCH_BUTTON + '" \
        onclick="clearSearch()"><\/input><input \
        type="button" \
        name="searchbutton" \
        class="searchbutton" \
        onclick="submit()"><\/input>'); 
} 
 
/* 
 * Start Functions 
 */
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}

// set search preferences
function setAHSearchPref(){
    if (document.search.gsa.checked == 1){
        setAHSearchCookie( dirname );
    }else{
        setAHSearchCookie( "community" );
    }
}

// Set search preferences cookie
function setAHSearchCookie( p ){
    // set cookie ah_searchpref with a value of the document path
    var expire=new Date();
    expire.setDate(expire.getDate()+365); // Cookie expires after 1 year (365 days) 
    document.cookie="ah_searchpref=" +p+ "; expires=" +expire.toGMTString()+ ";";
}

// ]]-->
</script> 
 </form>
<!-- END SEARCH CONTENT -->    



<!-- BEGIN PAGE CONTENT WRAPPER -->
    <div id="page_content_wrapper">
<!-- BEGIN PAGE WRAPPER -->
<table id="page_content_table">
<tr>

<td id="col2">
<!-- BEGIN CONTENT WRAPPER -->
<!-- BEGIN BREADCRUMBS -->

      
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc3ff6d0ea77859461172e0811cbec13e1a-7ffd.html" title="Accessing .NET assemblies"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc3ff6d0ea77859461172e0811cbec13e1a-7fd4.html" title=".NET Interoperability Limitations"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Developing&#160;ColdFusion 9 Applications</b></a> / <a href="WSc3ff6d0ea77859461172e0811cdd7c7008-8000.html"><b>Using Web Elements and External Objects</b></a> 
      / <a href="WSc3ff6d0ea77859461172e0811cbec22c24-715e.html"><b>Using Microsoft .NET Assemblies</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
      <div id="content_wrapper">
<!-- BEGIN PAGE TITLE -->
        <h1>Using .NET classes</h1>
<!-- END PAGE TITLE -->
<!-- BEGIN IONCOMMENTCOUNT -->
        <div id="ionCount">
        </div>
<!-- END IONCOMMENTCOUNT -->
<table id="inner_content_table" width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td>
          <div style="border-top:#ccc solid 1px;"><p> </p>
          </div>
<p id="chcPromo" style="display:none;">
<a id="chcLink" href="http://www.adobe.com/support/chc/">
<img id="chcImage" src="http://www.adobe.com/support/chc/GetMoreHelpFeatures.png"/>
</a>
</p>
<script type="text/javascript" language="javascript" charset="utf-8">
<!--
var cfgArray = [];
//cfgArray["Acrobat_10.0_Professional.helpcfg"] = "acrobatpro";
//cfgArray["Acrobat_10.0_Standard.helpcfg"] = "acrobatstd";
cfgArray["Lightroom_3.0.helpcfg"] = "lightroom";
cfgArray["PhotoshopElements_8.0_Win.helpcfg"] = "photoshopelements";
cfgArray["PhotoshopElements_8.0_Mac.helpcfg"] = "photoshopelementsmac";
cfgArray["PremiereElements_8.0_Win.helpcfg"] = "premiereelements";

//cfgArray["AfterEffects_10.0.helpcfg"] = "aftereffects";
//cfgArray["AIR.helpcfg"] = "air";
//cfgArray["ColdFusionBuilder.helpcfg"] = "coldfusion";
//cfgArray["Contribute_6.0.helpcfg"] = "contribute";
//cfgArray["DeviceCentral_3.0.helpcfg"] = "devicecentral";
//cfgArray["Dreamweaver_11.0.helpcfg"] = "dreamweaver";
//cfgArray["EncoreDVD_5.0.helpcfg"] = "encore";
//cfgArray["ExtensionManager_3.0.helpcfg"] = "extension";
//cfgArray["Fireworks_11.0.helpcfg"] = "fireworks";
//cfgArray["Flash_11.0.helpcfg"] = "flash";
//cfgArray["Flex_4.0.helpcfg"] = "flashbuilder";
//cfgArray["FlashCatalyst_1.0.helpcfg"] = "flashcatalyst";
//cfgArray["Illustrator_15.0.helpcfg"] = "illustrator";
//cfgArray["InCopy_7.0.helpcfg"] = "incopy";
//cfgArray["InDesign_7.0.helpcfg"] = "indesign";
//cfgArray["OnLocation_5.0.helpcfg"] = "onlocation";
//cfgArray["Photoshop_12.0.helpcfg"] = "photoshop";
//cfgArray["PremierePro_5.0.helpcfg"] = "premierepro";

function getLangName() {
    var lang = "en-us";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if (ptn.test(lang)) {
        var languageCode = lang.replace(ptn, "$1");
        var countryCode = lang.replace(ptn, "$2");
        lang = languageCode + "_" + countryCode.toUpperCase();
    }
    return lang;
}

function getCountryName() {
    var lang = "";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if ((ptn.test(lang)) && (lang != "en-us")) {
        var countryCode = lang.replace(ptn, "$2");
        return "/" + countryCode;
    }
    return "";
}

if ( (typeof(terms_HELPCFG) != 'undefined')  && (terms_HELPCFG.indexOf(".helpcfg") != -1) ) {
    var stage   = (document.location.href.indexOf(".stage.") != -1) ? 'stage.' : '';
    var baseUrl = 'http://www.' + stage + 'adobe.com';
    var refpage = document.location.href.replace(/#.*$/, '');
	
	if ((!use_robohelp_behavior) && (terms_HELPCFG.length > 0) && (typeof(cfgArray[terms_HELPCFG]) != 'undefined') && (cfgArray[terms_HELPCFG].length > 0)) {
		if (document.getElementById) { // DOM3 = IE5, NS6
			var newHref = baseUrl + getCountryName() + "/support/chc/" + "?helpcfg=http://help." + stage + "adobe.com/HelpCfg/" + getLangName() + "/" + terms_HELPCFG + "&url=" + refpage + "&product=" + cfgArray[terms_HELPCFG];
			var newSrc = baseUrl + getCountryName() + "/support/chc/GetMoreHelpFeatures.png";
			document.getElementById("chcPromo").style.display = "block";
			document.getElementById("chcLink").href = newHref;
			document.getElementById("chcImage").src = newSrc;
		}
	}
}

//-->
</script>



          <div id="minitoc"><div class="t"><div class="b"><div><ul id="minitoc-links"><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec13e1a-7fec"><span class="topictitle1">Instantiating objects and calling class constructors</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec13e1a-7ff0"><span class="topictitle1">Calling methods</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec13e1a-7fef"><span class="topictitle1">Getting and setting fields</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec22c24-789b"><span class="topictitle1">Converting between .NET and ColdFusion data types</span>
</a></p><ul><li><p><a href="#WSf01dbd23413dda0e34d85971200ff1e6f4-7ff9"><span class="topictitle2">Data type conversion rules and techniques</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e34d85971200ff1e6f4-7ff8"><span class="topictitle2">Using decimal numbers</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e34d85971200ff1e6f4-7ff7"><span class="topictitle2">Ensuring decimal and date/time conversions</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e34d85971200ff1e6f4-7ff6"><span class="topictitle2">Converting data to System.Object type</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e34d85971200ff1e6f4-7ff5"><span class="topictitle2">Handling ambiguous type conversions</span>
</a></p></li></ul></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec22c24-69b1"><span class="topictitle1">Working with complex .NET data types</span>
</a></p><ul><li><p><a href="#WSf01dbd23413dda0e34d85971200ff1e6f4-7ff4"><span class="topictitle2">Using Hashtable data in ColdFusion</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e34d85971200ff1e6f4-7ff3"><span class="topictitle2">Using .Net ArrayList in ColdFusion</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e34d85971200ff1e6f4-7ff2"><span class="topictitle2">Using ADO.Net DataTable in ColdFusion</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e34d85971200ff1e6f4-7ff1"><span class="topictitle2">Using ColdFusion complex types in .NET input parameters</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e34d85971200ff1e6f4-7ff0"><span class="topictitle2">Disabling automatic conversion of complex .NET data</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e34d85971200ff1e6f4-7fef"><span class="topictitle2">Manually converting complex .NET objects</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e34d85971200ff1e6f4-7fee"><span class="topictitle2">Using .NET objects</span>
</a></p></li></ul></li></ul></div></div></div></div><div><p>You use .NET assembly classes the same way
you use Java and other objects that you create using the <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f6e.html" target="_self">cfobject</a> tag or <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7ec2.html" target="_self">CreateObject</a> function. In the simplest
case, your application code only has to use the following format
to include a local .NET class method:</p>
<pre>&lt;cfobject type = ".NET" name = "mathInstance" class = "mathClass" 
        assembly = "C:/Net/Assemblies/math.dll"&gt; 
&lt;cfset myVar = mathInstance.multiply(1,2)&gt;</pre>
<p>Using CFScript and the <samp class="codeph">CreateObject</samp> function,
you can do the following:</p>
<pre>&lt;cfscript&gt; 
    mathInstance = CreateObject(".NET", "mathClass",  
        "C:/Net/Assemblies/math.dll"); 
    myVar = mathInstance.multiply(1,2); 
&lt;/cfscript&gt;</pre>
<div class="note"><span class="notetitle">Note:  </span>You cannot load two DLLs with same fully qualified
name. ColdFusion always uses the first DLL that it accesses until
the server is restarted. For example, if page1.cfm uses c:\dev\a.dll
and page2.cfm uses c:\dev2\a.dll, and both DLLs have the same fully
qualified name, the first DLL file to be loaded remains loaded,
and both CFML pages use it.</div>
<p>When you create objects and access class methods and fields,
and convert data types between ColdFusion and .NET, be aware of
the following considerations and limitations:</p>
<ul><li><p>Data type conversion considerations described in <a href="WSc3ff6d0ea77859461172e0811cbec22c24-789b.html">Converting between .NET and ColdFusion data types</a></p>
</li>
<li><p>Limitations described in the “Limitations” section of <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-789c.html" target="_self">cfobject: .NET object</a> in the <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">CFML Reference</i>.</p>
</li>
</ul>
</div>
<div id="WSc3ff6d0ea77859461172e0811cbec13e1a-7fec" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec13e1a-7fec"><!-- --></a><h2 class="topictitle2">Instantiating objects and calling class constructors</h2><div><p>When
you use the <samp class="codeph">cfobject</samp> tag to create a .NET object,
ColdFusion does not create an instance of the object. ColdFusion
creates the object instance in either of the following cases:</p>
<ul><li><p>If the class has a default constructor, ColdFusion automatically
calls the constructor when you first invoke a non-static method
of the object.</p>
</li>
<li><p>If the class does not have a default constructor, or if the
class has multiple constructors and you do not want to use the default,
call the special <samp class="codeph">init</samp> method of the ColdFusion
object. The <samp class="codeph">cfobject</samp> tag automatically
creates <samp class="codeph">init</samp> methods for all class constructors.
Using the <samp class="codeph">init</samp> method causes ColdFusion to call
the class constructor with the corresponding number and types of
parameters. For example, the following tags cause ColdFusion to
call the MyClass constructor that takes two integer parameters:</p>
<pre>&lt;cfobject type=".NET" name="myObj" class="com.myCo.MyClass" 
        assembly="c:\assemblies\myLib.dll"&gt; 
&lt;cfset myObj.init(10, 5)&gt;</pre>
</li>
</ul>
<div class="note"><span class="notetitle">Note:  </span>ColdFusion does not create instances of objects
if you use only their static methods.</div>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec13e1a-7ff0" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec13e1a-7ff0"><!-- --></a><h2 class="topictitle2">Calling methods</h2><div><p>You call .NET methods in the same way that you use any
other ColdFusion object methods. For example, if the MyClass class
has a <samp class="codeph">getName</samp> method that takes a numeric ID and
returns a name, you would call the method as follows:</p>
<pre>&lt;cfset theID="2343"&gt; 
&lt;cfset userName=mObj.getName(theID)&gt;</pre>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec13e1a-7fef" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec13e1a-7fef"><!-- --></a><h2 class="topictitle2">Getting and setting fields</h2><div><p>You can access and change public fields of any .NET class
by calling the following methods:</p>
<pre>Get_fieldName() 
Set_fieldName(value)</pre>
<p>For example, if the .NET class has a public field named <samp class="codeph">accountID</samp>,
you can access and change its value by using the <samp class="codeph">Get_accountID()</samp> and <samp class="codeph">Set_accountID()</samp> methods,
as follows:</p>
<pre>&lt;cfobject type=".NET" class="com.myCo.MyClass" 
        assembly="c:\assemblies\myLib.dll" name="myObj"&gt; 
&lt;cfset theAccount=myObj.Get_accountID()&gt; 
&lt;cfset myObj.Set_accountID(theAccount + 1)&gt;</pre>
<p>You can access, but not modify final fields, so you can only
call <samp class="codeph">Get_</samp><i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">fieldName</i><samp class="codeph">()</samp> for
these fields. </p>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec22c24-789b" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec22c24-789b"><!-- --></a><h2 class="topictitle2">Converting between .NET and ColdFusion data types</h2><div><p>Accessing .NET classes requires a Java proxy on the ColdFusion
system and .NET code on the target system, so data must be converted
among ColdFusion, Java, and .NET (to be exact, Microsoft Intermediate
Language, or MSIL) data types. ColdFusion converts data types automatically.
Usually, you do not have to take any special steps to ensure correct
conversion. Some conversion limitations exist, and in some cases
you must explicitly specify a data type when you call a method in
a .NET proxy object. </p>
<p>The following
paragraphs describe data conversion issues and how to handle them.
For a detailed specification of how ColdFusion converts among ColdFusion data,
Java data types, and .NET data types, see <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-789c.html" target="_self">cfobject: .NET object</a> in the <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">CFML Reference</i>.</p>
</div><div id="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff9" class="nochunk"><a name="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff9"><!-- --></a><h3 class="topictitle3">Data type conversion rules and techniques</h3><div><p>ColdFusion
converts data automatically among ColdFusion, Java, and CLR data types.
The following table indicates how ColdFusion converts among .NET Common
Language Runtime (CLR) primitive and standard data types, the Java data
types used in the proxies to represent CLR data types, and ColdFusion
data types in your CFML application. </p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e105995"><p>.NET type </p>
</th>
<th valign="top" width="NaN%" id="d17e105998"><p>Java type </p>
</th>
<th valign="top" width="NaN%" id="d17e106001"><p>ColdFusion type</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e105995 "><p>sbyte </p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>byte </p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Integer</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>byte </p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>short </p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Integer</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>short </p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>short </p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Integer</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>ushort </p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>int </p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Integer</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>int </p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>int </p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Integer</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>uint </p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>long </p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Number</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>char </p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>char </p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Integer or string</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>long </p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>long </p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Number</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>ulong </p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>float </p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Number</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>float </p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>float </p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Number</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>double </p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>double </p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Number</p>
<p>The returned number retains
greater precision than is normally displayed in ColdFusion. Use
the <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7fd9.html" target="_self">PrecisionEvaluate</a> function
to access and display the full precision of a returned double value.
You can also pass a value with full double precision to a .NET method.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>bool </p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>boolean </p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Boolean</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>enum</p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>&#160;</p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Not converted, but enumerator elements can
be accessed directly by using the format Enumerator_variable.enumerator,
as in MyColor.Red</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>array</p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>array</p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Array</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>string </p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>String </p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>String</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>System.Collections.ArrayList</p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>java.util.ArrayList</p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Array</p>
<p><strong>Note: </strong>ColdFusion converts
from .NET type to ColdFusion type only, it does not convert ColdFusion
Arrays to .NET ArrayLists.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>System.Collections.Hashtable</p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>java.util.Hashtable</p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Structure</p>
<p><strong>Note: </strong>ColdFusion
converts from .NET type to ColdFusion type only, it does not convert ColdFusion
Structures to .NET Hashtables</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>System.Data.DataTable</p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>&#160;</p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Query</p>
<p><strong>Note: </strong>ColdFusion converts
from .NET type to ColdFusion type only, it does not convert ColdFusion
Queries to .NET DataTables</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>System.DateTime</p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>java.util.Date</p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>Date/time</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>decimal</p>
<p>System.Decimal </p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>java.math.BigDecimal</p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>String representation of the decimal number.</p>
<p>For
details on using decimal numbers, see <a href="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff8.html">Using decimal numbers</a>.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e105995 "><p>System.Object</p>
</td>
<td valign="top" width="NaN%" headers="d17e105998 "><p>&#160;</p>
</td>
<td valign="top" width="NaN%" headers="d17e106001 "><p>If a .NET argument is of type System.Object,
ColdFusion Strings are converted directly. Other types require using
the <samp class="codeph">JavaCast</samp> function.</p>
<p>ColdFusion cannot
convert System.object instances returned by .NET methods to ColdFusion
types, but you can access them using the Object methods.</p>
<p>For
detailed information, see <a href="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff6.html">Converting data to System.Object type</a>.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div></div><div id="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff8" class="nochunk"><a name="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff8"><!-- --></a><h3 class="topictitle3">Using decimal numbers</h3><div><p>Use the <samp class="codeph">JavaCast</samp> function to convert ColdFusion
data into BigDecimal format before you pass the value to a .NET
function, as in the following example:</p>
<pre>&lt;cfset netObj.netFunc(javacast("bigdecimal","439732984732048"))&gt;</pre>
<p>ColdFusion automatically converts returned decimal and System.Decimal
values to ColdFusion string representations.</p>
</div></div><div id="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff7" class="nochunk"><a name="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff7"><!-- --></a><h3 class="topictitle3">Ensuring decimal and date/time conversions</h3><div><p>ColdFusion converts .NET decimal or System.Decimal types
only if the proxy for System.Decimal is a value type proxy. Similarly,
it converts .NET System.DateTime values to ColdFusion Date-time
values only if the proxy for System.DateTime is a value type proxy.
The ColdFusion server always uses value proxies when it generates
these proxies. If you use the JNBProxyGUI.exe tool to generate the proxy,
however, make sure to generate the proxy for System.Decimal as value type.</p>
</div></div><div id="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff6" class="nochunk"><a name="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff6"><!-- --></a><h3 class="topictitle3">Converting data to System.Object type</h3><div><p>When a .NET method specifies <samp class="codeph">System.Object</samp> (as
opposed to a specific Object subclass, such as <samp class="codeph">System.Boolean</samp>)
as the argument type, and you want to pass primitive values as arguments
to that method, use the <samp class="codeph">javacast</samp> function to identify
the data conversion. Once ColdFusion knows the data type, it automatically
converts to the appropriate .NET type. Here is the table that describes
the conversion rule from ColdFusion type to .NET type.</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><tbody><tr><td valign="top" width="NaN%"><p>.NET Type</p>
</td>
<td valign="top" width="NaN%"><p>Type used in javacast</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>bool / System.Boolean</p>
</td>
<td valign="top" width="NaN%"><p>boolean</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>bool[] / System.Boolean[]</p>
</td>
<td valign="top" width="NaN%"><p>boolean[]</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>char / System.Char</p>
</td>
<td valign="top" width="NaN%"><p>char</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>char[] / System.Char[]</p>
</td>
<td valign="top" width="NaN%"><p>char[]</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>double / System.Double</p>
</td>
<td valign="top" width="NaN%"><p>double</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>double[] / System.Double[]</p>
</td>
<td valign="top" width="NaN%"><p>double[]</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>float / System.Single</p>
</td>
<td valign="top" width="NaN%"><p>float</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>float[] / System.Single[]</p>
</td>
<td valign="top" width="NaN%"><p>float[]</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>int / System.Int32</p>
</td>
<td valign="top" width="NaN%"><p>int</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>int[] / System.Int32[]</p>
</td>
<td valign="top" width="NaN%"><p>int[]</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>long / System.Int64</p>
</td>
<td valign="top" width="NaN%"><p>long</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>long[] / System.Int64[]</p>
</td>
<td valign="top" width="NaN%"><p>long[]</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>sbyte / System.Sbyte</p>
</td>
<td valign="top" width="NaN%"><p>byte </p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>sbyte []/ System.Sbyte[]</p>
</td>
<td valign="top" width="NaN%"><p>byte []</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>short / System.Int16</p>
</td>
<td valign="top" width="NaN%"><p>short</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>short[] / System.Int16[]</p>
</td>
<td valign="top" width="NaN%"><p>short[]</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>System.Decimal</p>
</td>
<td valign="top" width="NaN%"><p>bigdecimal</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>System.String</p>
</td>
<td valign="top" width="NaN%"><p>String</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="note"><span class="notetitle">Note:  </span>You do not have to use a <samp class="codeph">JavaCast</samp> function
to convert ColdFusion string variables. They are automatically converted
to .NET System.String.</div>
<p>Create special objects for .NET primitive unsigned data types,
such as byte (unsigned byte), ushort (unsigned short), uint (unsigned
int) and ulong (unsigned long), for which no corresponding java
types exist. The following table lists the .NET primitive types
and the corresponding class you must use.</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><tbody><tr><td valign="top" width="NaN%"><p>.NET type</p>
</td>
<td valign="top" width="NaN%"><p>Class used in cfobject/createObject</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>byte / System.Byte</p>
</td>
<td valign="top" width="NaN%"><p>System.BoxedByte</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>ushort / System.UInt16</p>
</td>
<td valign="top" width="NaN%"><p>System.BoxedUShort</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>uint / System.UInt32</p>
</td>
<td valign="top" width="NaN%"><p>System.BoxedUInt</p>
</td>
</tr>
<tr><td valign="top" width="NaN%"><p>ulong / System.UInt64</p>
</td>
<td valign="top" width="NaN%"><p>System.BoxedULong</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>Use the <samp class="codeph">createObject</samp> function or <samp class="codeph">cfobject</samp> tag
to create these special objects, in the same manner as you create
other .NET classes, before you use them in your assignment statement.
For example, the following line creates a ushort representation
of the value 100:</p>
<pre>&lt;cfset boxedUShort = createObject(".NET". "System.BoxedUShort").init(100)&gt;</pre>
<p>The following example creates a System.Hashtable object and populates
it with examples of all types of primitives.</p>
<pre>&lt;!--- create a .NET Hashtable ---&gt; 
&lt;cfset table = createObject(".NET", "System.Collections.Hashtable")&gt; 
 
&lt;!--- call HashTable.add(Object, Object) method for all primitives ---&gt; 
&lt;cfset table.add("shortVar", javacast("short", 10))&gt; 
&lt;cfset table.add("sbyteVar", javacast("byte", 20))&gt; 
&lt;cfset table.add("intVar", javacast("int", 123))&gt; 
&lt;cfset table.add("longVar", javacast("long", 1234))&gt; 
&lt;cfset table.add("floatVar", javacast("float", 123.4))&gt; 
&lt;cfset table.add("doubleVar", javacast("double", 123.4))&gt; 
&lt;cfset table.add("charVar", javacast("char", 'c'))&gt; 
&lt;cfset table.add("booleanVar", javacast("boolean", "yes"))&gt; 
&lt;cfset table.add("StringVar", "Hello World")&gt; 
&lt;cfset table.add("decimalVar", javacast("bigdecimal", 123234234.505))&gt; 
 
&lt;!--- call HashTable.add(Object, Object) for unsigned primitive types. ---&gt; 
&lt;cfset boxedByte = createObject(".NET", "System.BoxedByte").init(10)&gt; 
&lt;cfset table.add("byteVar", boxedByte)&gt; 
 
&lt;cfset boxedUShort = createObject(".NET", "System.BoxedUShort").init(100)&gt; 
&lt;cfset table.add("ushortVar", boxedUShort)&gt; 
 
&lt;cfset boxedUInt = createObject(".NET", "System.BoxedUInt").init(123)&gt; 
&lt;cfset table.add("uintVar", boxedUInt)&gt; 
 
&lt;cfset boxedULong = createObject(".NET", "System.BoxedULong").init(123123)&gt; 
&lt;cfset table.add("ulongVar", boxedULong)&gt; 
 
&lt;cfdump var="#DotNetToCFType(table)#"&gt;</pre>
<p>Any other .NET objects can be passed as it is.</p>
</div></div><div id="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff5" class="nochunk"><a name="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff5"><!-- --></a><h3 class="topictitle3">Handling ambiguous type conversions</h3><div><p>ColdFusion cannot determine the correct data type conversion
if a method has multiple signatures with the same number of parameters
that differ only in the parameter data types. In this case, use
the <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7fbe.html" target="_self">JavaCast</a> method to convert the ColdFusion
data to the Java type that corresponds to the .NET type. </p>
<p>For example, if a .NET class has methods myFunc(ulong) and myFunc(int),
use the <samp class="codeph">JavaCast</samp> method to convert your ColdFusion
variable to the Java float or int data type, as the following line
shows:</p>
<pre>myFunc(JavaCast(int, MyVar));</pre>
<p>Similarly, if a .NET class has methods myFunc(int) and myFunc(String),
use the <samp class="codeph">JavaCast</samp> method to convert your ColdFusion
variable to the Java int or String data type, as shown in the following
line:</p>
<pre>myFunc(JavaCast(String, "123");</pre>
<p>In some cases, the <samp class="codeph">JavaCast</samp> function cannot
eliminate ambiguity because a single Java type corresponds to multiple
.NET types. In these cases, ColdFusion creates a proxy with only
one method, which uses the .NET data type that corresponds directly
to a Java type.</p>
<p>For example, if the .NET class has methods myFunc(ulong) and
myFunc(float), the generated proxy has only one method. This method
calls myFunc(float), because the Java float type used to handle
ColdFusion floating-point numbers corresponds directly to the .NET
float type. In this case, you can never call the .NET myFunc(ulong)
method.</p>
</div></div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec22c24-69b1" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec22c24-69b1"><!-- --></a><h2 class="topictitle2">Working with complex .NET data types</h2><div><p>When you use complex .NET data such as Hashtable, ArrayList
and DataTable, ColdFusion normally automatically converts the data
to the corresponding ColdFusion data type: structure, array, and
query, respectively. When you work with this data you take specific
actions to enable the proper access and conversion of the data,
as follows:</p>
<ul><li><p>Use associative array notation to properly access .NET
Hashtable data from ColdFusion</p>
</li>
<li><p>You cannot use ColdFusion variables directly in parameters
that take Hashtable, ArrayList, or DataTable input.</p>
</li>
<li><p>You can disable automatic conversion of complex .NET data
to ColdFusion types.</p>
</li>
<li><p>You
can manually convert complex .NET data to ColdFusion types.</p>
</li>
</ul>
</div><div id="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff4" class="nochunk"><a name="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff4"><!-- --></a><h3 class="topictitle3">Using Hashtable data in ColdFusion</h3><div><p>.NET Hashtables are case sensitive, but most methods of
ColdFusion structure access are not case sensitive. Only associative
array notation of the form <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">structName</i><samp class="codeph">["</samp><i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">keyName</i><samp class="codeph">"]</samp> is
case sensitive. When .NET Hashtables are converted to CF structure,
the entire data set is converted, even if the element keys differ only
in case. Therefore, to get the values of the keys that differ only
in case, use associative array notation.</p>
<p>The following example shows this issue. It creates a Hashtable
object with three entries whose key values vary only in case. In
the example, output using dot-delimited structure notation always
returns the same value, corresponding to the all-uppercase key,
but associative array notation returns the correct result. </p>
<pre>&lt;!--- Create a Hashtable and convert it to a ColdFusion structure. ---&gt; 
&lt;cfset table = createObject(".NET", "System.Collections.Hashtable")&gt; 
&lt;cfset table.add("Key", "Value1")&gt; 
&lt;cfset table.add("KEY", "Value2")&gt; 
&lt;cfset table.add("key", "Value3")&gt; 
&lt;cfset cftable = DotNetToCFType(table)&gt; 
 
&lt;cfdump var="#cftable#"&gt; 
 
&lt;h3&gt;Using dot notation&lt;/h3&gt; 
Key : &lt;cfoutput&gt;#cftable.Key#&lt;/cfoutput&gt;&lt;br&gt; 
KEY : &lt;cfoutput&gt;#cftable.KEY#&lt;/cfoutput&gt;&lt;br&gt; 
key : &lt;cfoutput&gt;#cftable.key#&lt;/cfoutput&gt;&lt;br&gt; 
&lt;p&gt; 
 
&lt;h3&gt;Using associative array notation&lt;/h3&gt; 
Key : &lt;cfoutput&gt;#cftable["Key"]#&lt;/cfoutput&gt;&lt;br&gt; 
KEY : &lt;cfoutput&gt;#cftable["KEY"]#&lt;/cfoutput&gt;&lt;br&gt; 
key : &lt;cfoutput&gt;#cftable["key"]#&lt;/cfoutput&gt;&lt;br&gt;</pre>
</div></div><div id="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff3" class="nochunk"><a name="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff3"><!-- --></a><h3 class="topictitle3">Using .Net ArrayList in ColdFusion</h3><div><p>ColdFusion converts System.Collections.ArrayList objects
to ColdFusion arrays, and you can perform all standard ColdFusion
array operations on them. The following example shows this usage:</p>
<p>.Net Code:</p>
<pre>public ArrayList getList(){ 
    ArrayList myAL = new ArrayList(); 
    myAL.Add("Hello"); 
    myAL.Add(1); 
    myAL.add(true); 
    Return AL; 
}</pre>
<p>ColdFusion Code:</p>
<pre>&lt;cfset cflist = netObject.getList()&gt; 
&lt;cfloop array="#cflist#" index="item"&gt; 
    &lt;cfoutput&gt;#item#&lt;/cfoutput&gt;&lt;br&gt; 
&lt;/cfloop&gt; 
     
&lt;cfif cflist[3]&gt; 
        &lt;cfoutput&gt;Third element in the list is true&lt;/cfoutput&gt; 
&lt;/cfif&gt;</pre>
</div></div><div id="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff2" class="nochunk"><a name="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff2"><!-- --></a><h3 class="topictitle3">Using ADO.Net DataTable in ColdFusion</h3><div><p>ColdFusion converts System.Data.DataTable objects to ColdFusion
query objects, and you can perform all standard ColdFusion query
operations on them. The following example shows this usage:</p>
<p>.Net code:</p>
<pre>public DataTable datasetMethod() 
{ 
    //conn string 
    string connectionString = "..."; 
     
    //connection 
    using (SqlConnection connection = new SqlConnection(connectionString)) 
    { 
        SqlCommand cmd = new SqlCommand(@"SELECT * FROM [tblEmployees]", connection); 
        connection.Open(); 
        SqlDataReader reader = cmd.ExecuteReader(); 
        DataTable dt = new DataTable(); 
        dt.Load(reader); 
        return dt; 
} 
}</pre>
<p>ColdFusion code:</p>
<pre>&lt;cfset query1 = netObject.datasetMethod()&gt; 
&lt;cfoutput query="query1"&gt; 
    Query1.CurrentRow = #query1.CurrentRow#&lt;br&gt; 
&lt;/cfoutput&gt;</pre>
</div></div><div id="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff1" class="nochunk"><a name="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff1"><!-- --></a><h3 class="topictitle3">Using ColdFusion complex types in .NET input parameters</h3><div><p>When a .NET method returns an ArrayList, Hashtable, or
DataTable, ColdFusion automatically converts it to a ColdFusion
array, structure, or query, respectively. However ColdFusion does
not automatically convert from ColdFusion data types to these .NET
types. (ColdFusion does automatically convert ColdFusion arrays
to .Net array types.) Therefore, you cannot use ColdFusion variables
directly as input parameters to .NET object instance methods that
require .NET System.Collection.ArrayList, System.Collection.Hashtable,
or System.Data.DataTable types. Instead create instances of these
.NET types and populate them with the required data before you pass
them to the .NET method. For an example of creating and populating
a System.Collection.Hashtable object, see the example at the end
of the “Converting data to System.Object type” section.</p>
</div></div><div id="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff0" class="nochunk"><a name="WSf01dbd23413dda0e34d85971200ff1e6f4-7ff0"><!-- --></a><h3 class="topictitle3">Disabling automatic conversion of complex .NET data</h3><div><p>You can disable automatic conversion of .NET <samp class="codeph">System.Collections.Hashtable</samp>, <samp class="codeph">System.Collections.ArrayList</samp> or
S<samp class="codeph">ystem.Data.DataTable</samp> objects to the corresponding
ColdFusion structure, array, or query objects. You could want to
disable the conversion under the following circumstances:</p>
<ul><li><p>If a collection or DataTable returned by a .NET method
is large and you only want a small subset of the data. If auto conversion
is enabled, ColdFusion creates a data structure with all the object’s
fields. Creating the structure could take significant time and resources,
because ColdFusion must invoke .NET methods internally to get each
of the fields. You can disable the automatic conversion and retrieve
the fields or data from .NET objects like any other objects.</p>
</li>
<li><p>If you invoke a .NET method that returns a complex variable,
and then pass the variable to another .NET method as argument. If
automatic conversion is enabled, you cannot pass the Hashtable object
from the first method directly to the second method.</p>
</li>
</ul>
<p>To disable automatic conversion, set the JVM coldfusion.dotnet.disableautoconversion
system property to true. For example, in a ColdFusion stand-alone
server, or if you use JRun as your J2EE server, include the following
setting in the JVM.config file:</p>
<pre>-Dcoldfusion.dotnet.disableautoconversion=true</pre>
</div></div><div id="WSf01dbd23413dda0e34d85971200ff1e6f4-7fef" class="nochunk"><a name="WSf01dbd23413dda0e34d85971200ff1e6f4-7fef"><!-- --></a><h3 class="topictitle3">Manually converting complex .NET objects</h3><div><p>Use the <samp class="codeph">DotNetToCFType</samp> function to convert
a <samp class="codeph">System.Collections.Hashtable</samp>, <samp class="codeph">System.Collections.ArrayList</samp> or
S<samp class="codeph">ystem.Data.DataTable</samp> object to a ColdFusion structure,
array, or query respectively when either of the following circumstances
are true:</p>
<ul><li><p>You have set the coldfusion.dotnet.disableautoconversion
system property to true.</p>
</li>
<li><p>Automatic conversion is enabled, you created the complex
.NET object by using the <samp class="codeph">createObject</samp> function
or <samp class="codeph">cfobject</samp> tag, and you want to convert this object
into the corresponding ColdFusion representation.</p>
</li>
</ul>
<p>For an example of using the function, see <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7890.html" target="_self">DotNetToCFType</a> in the <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">CFML Reference</i>.</p>
</div></div><div id="WSf01dbd23413dda0e34d85971200ff1e6f4-7fee" class="nochunk"><a name="WSf01dbd23413dda0e34d85971200ff1e6f4-7fee"><!-- --></a><h3 class="topictitle3">Using .NET objects</h3><div><p>.NET fields and return values with class types are available
in ColdFusion as .NET objects. You can use the object’s methods
to access object data and make it available to ColdFusion using
supported data types.</p>
<p>The following example gets information about a system’s drives.
It calls the System.IO.DriveInfo.GetDrives() method to get an array
of System.IO.DriveInfo objects, one per drive. It then calls the
object methods to get specific information about the drives, and
displays the information. The example uses a <samp class="codeph">cfdump</samp> tag to
simplify the code.</p>
<div class="note"><span class="notetitle">Note:  </span>The System.IO.DriveInfo is not included in the
.NET 1.x framework. It is included in .NET 2.0 and later frameworks.
For information on determining the .NET framework, see <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7898.html">Determining and changing the .NET version</a>.</div>
<pre>&lt;!--- Create a query for the drive information results. ---&gt;  
&lt;cfset result=QueryNew("name,type,isready,format,label,totalsize,freespace" 
                    ,"varchar,varchar,bit,varchar,varchar,double,double")&gt; 
<strong>&lt;!--- Create a .NET System.IO.DriveInfo object. ---&gt;</strong> 
<strong>&lt;cfobject type=".NET" name="sidiClass" class="System.IO.DriveInfo"&gt;</strong> 
<strong>&lt;!--- Get the drives. ---&gt;</strong> 
<strong>&lt;cfset drives=sidiClass.GetDrives()&gt;</strong> 
&lt;!--- Loop through drives. ---&gt; 
&lt;cfloop from="1" to="#ArrayLen(drives)#" index="i"&gt; 
    &lt;!--- Add a row to the query.---&gt; 
    &lt;cfset QueryAddRow(result)&gt; 
    &lt;!--- Get the drive name, type, and ready flag. ---&gt; 
    &lt;cfset QuerySetCell(result, "name", drives[i].Get_Name())&gt; 
    &lt;cfset QuerySetCell(result, "type", 
                drives[i].Get_DriveType().ToString())&gt; 
    &lt;cfset QuerySetCell(result, "isready", drives[i].Get_IsReady())&gt; 
    &lt;!--- Get extra details ONLY if the drive is ready. ---&gt; 
    &lt;cfif drives[i].Get_IsReady()&gt; 
        &lt;cfset QuerySetCell(result, "format", drives[i].Get_DriveFormat())&gt; 
        &lt;cfset QuerySetCell(result, "label", drives[i].Get_VolumeLabel())&gt; 
        &lt;cfset QuerySetCell(result, "totalsize", drives[i].Get_TotalSize())&gt; 
        &lt;cfset QuerySetCell(result, "freespace", 
                    drives[i].Get_AvailableFreeSpace())&gt; 
    &lt;/cfif&gt; 
&lt;/cfloop&gt; 
&lt;cfdump var="#result#"&gt;</pre>
</div></div></div>


<!-- BEGIN USER PREFERENCES -->
          <div id="userprefs">
          </div>
<!-- END USER PREFERENCES -->

          <div id="related">
            
            
            <div class="separator"><a href="#top"><img src="images/BTT.jpg" /></a>&#160;</div>
          </div>
          <div id="footer">
<!-- BEGIN IONCOMMENTS -->
            <div id="ionComHere">
            </div>
<!-- END IONCOMMENTS -->


            <p id="creativecommons"><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text"><img id="creativecommons_img" src="images/CC.png" alt="This work is licensed under a Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License" /></a>&nbsp;Twitter™ and Facebook posts are not covered under the terms of Creative Commons.</p>
          </div>
</td>
<td width="10px"></td>
<td id="inner_rightcolumn">

</td></tr></table>
      </div>
<!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc3ff6d0ea77859461172e0811cbec13e1a-7ffd.html" title="Accessing .NET assemblies"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc3ff6d0ea77859461172e0811cbec13e1a-7fd4.html" title=".NET Interoperability Limitations"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Developing&#160;ColdFusion 9 Applications</b></a> / <a href="WSc3ff6d0ea77859461172e0811cdd7c7008-8000.html"><b>Using Web Elements and External Objects</b></a> 
      / <a href="WSc3ff6d0ea77859461172e0811cbec22c24-715e.html"><b>Using Microsoft .NET Assemblies</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
<!-- END CONTENT WRAPPER -->

</td>
<td id="col3">
    <div>
        <img src="images/adobe-lq.png" />
    </div>
</td>
</tr>
</table>
    </div>
<!-- END PAGE CONTENT WRAPPER -->
<script type="text/javascript">
<!--[CDATA[
scrollToNameAnchor();
// ]]-->
</script> 
<!--
    Description:
    This file generates the link to product support in the top right corner
-->

<style>
#menutop{
    position:absolute;
    top:4px;
    right:24px;
    width:auto;    
    font-size:11px;
    color:#fff;
    text-align:right;
}
#menutop a{
    color:#fff;
}
#menutop a:hover{
        text-decoration:underline;
}
</style>  
  
  
  
  
<div id="productmenu">
<!--googleoff: index-->
  <div id="menutop">


<script language=javascript type='text/javascript'>
    // darken menu text for products with light backgrounds
    var path = document.location.href.toLowerCase();
    if (path.indexOf("/acrobat/")           	> 0 ||
        path.indexOf("/acrobat.com/")       	> 0 ||
        path.indexOf("/acrobatConnectPro/") 	> 0 ||
        path.indexOf("/connect/")           	> 0 ||
        path.indexOf("/livecycledataserviceses/") > 0 ||
        path.indexOf("/muse/")         	> 0 ||
	path.indexOf("/presenter/")         	> 0 ||
        path.indexOf("/scene7/")            	> 0 ||
        path.indexOf("/flashmediaserver/")  	> 0 ||
        path.indexOf("/wave/")              	> 0 )
    {
        document.write('<style>#menutop a{color:#505050}</style>');
    }
    if (typeof('terms_AHV_PRODUCT_SUPPORT') != "undefined" && ! use_robohelp_behavior ){      
        if (path.indexOf("/muse/") > -1 ){
            var supportlink = '<a href="http://muse.adobe.com/support.html">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }else{
            var supportlink = '<a href="http://adobe.com/support">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }
        document.write( supportlink );
     }

</script> 

  </div>
<!--googleon: index-->
</div>



<style>
#online-privacy-policy{ 
    margin:10px 40px; 
    font-size:11px;
}
</style>

<p id="online-privacy-policy">
<script language="javascript">
var pageLoc = "en_US";
var metaElements = document.all ?
document.all.tags('meta') :
document.getElementsByTagName ?
document.getElementsByTagName ('meta') : new Array();
for (var m = 0; m < metaElements.length; m++) {
	if (metaElements[m].name == "lang") {
		pageLoc = metaElements[m].content;
		break;
	}
}
var ptn = /(..)-(..)/;
if (ptn.test(pageLoc)) {
	var languageCode = pageLoc.replace(ptn, "$1");
	var countryCode = pageLoc.replace(ptn, "$2");
	pageLoc = languageCode + "_" + countryCode.toUpperCase();
}

var policyLoc = "en_US";
var policyText = "Online Privacy Policy";
var policyPath = "";
var policyArray=[
"da_DK", "Online fortrolighedserklæring",
"de_DE", "Online-Datenschutzrichtlinie",
"es_ES", "Política de confidencialidad en línea",
"fi_FI", "Yksityisyyttä koskeva Online-toimintaohjelma",
"fr_FR", "Confidentialité et sécurité",
"it_IT", "Informativa sulla privacy online",
"ja_JP", "プライバシーポリシー",
"ko_KR", "Adobe 온라인 개인정보 보호정책",
"pt_BR", "Política de Confidencialidade On-line", 
"zh_CN", "在线隐私政策",
"zh_TW", "線上隱私政策"
];
var legalLoc = "en_US";
var legalText = "Legal Notices";
var legalPath = legalLoc;
var legalArray=[
"ar_AE", "إشعارات قانونية",
"bg_BG", "Юридически бележки",
"cs_CZ", "Právní upozornění",
"da_DK", "Juridiske meddelelser",
"de_DE", "Rechtliche Hinweise",
"el_GR", "Σημειώσεις νομικού περιεχομένου",
"es_ES", "Avisos legales",
"et_EE", "Juriidilised teated",
"fi_FI", "Lakisääteiset ilmoitukset",
"fr_FR", "Mentions légales",
"he_IL", "הצהרות משפטיות",
"hr_HR", "Pravne napomene",
"hu_HU", "Jogi közlemények",
"it_IT", "Informazioni legali",
"ja_JP", "法律上の注意",
"ko_KR", "법적 고지 사항",
"lt_LT", "Teisinės pastabos",
"lv_LV", "Juridisks paziņojums",
"nb_NO", "Juridiske merknader",
"nl_NL", "Juridische kennisgevingen",
"pl_PL", "Informacje prawne",
"pt_BR", "Aspectos jurídicos",
"ro_RO", "Prevederi legale",
"ru_RU", "Юридическая информация",
"sk_SK", "Právne upozornenie",
"sl_SI", "Pravni pouk",
"sv_SE", "Upphovsrätt",
"tr_TR", "Yasal uyarılar",
"uk_UA", "Юридична інформація",
"zh_CN", "法律声明",
"zh_TW", "法律注意事項"
];

ruPolicy = "http://www.adobe.com/ru/misc/privacy.html";
trPolicy = "http://www.adobe.com/tr/misc/privacy.html";

// Bug 2846992: LOC: RUS, TUR: The link to "Online Privacy Policy" should include language, currently it is not appearing.
if (pageLoc == "ru_RU") {
	policyPath = "ru";
}
else if (pageLoc == "tr_TR") {
	policyPath = "tr";
}
for (var i = 0; i < policyArray.length; i+=2) {
	if (pageLoc == policyArray[i]) {
		policyLoc = pageLoc;
		policyText = policyArray[i+1];
		var ptn = /(..)_(..)/;
		if (ptn.test(policyLoc)) {
			var countryCode = policyLoc.replace(ptn, "$2");
			policyPath = countryCode.toLowerCase();
		}
		break;
	}
}

for (var i = 0; i < legalArray.length; i+=2) {
	if (pageLoc == legalArray[i]) {
		legalLoc = pageLoc;
		legalText = legalArray[i+1];
		legalPath = legalLoc;
		break;
	}
}
if(agt.indexOf("community help client") > -1 ){
	document.write('<a href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
}else{
	//Open the privacy policy in a new window
	document.write('<a target="_blank" href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a target="_blank" href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
} 
</script>
</p>



<!-- localfooter.ssi -->

<script type="text/javascript">
    var debug = (top.location.href.indexOf("debug=true") > -1);
</script>

<script language="javascript">
document.write('<scr'+'ipt ' +
               'src="/en_US/ssi/_pod.js" ' +
               'language="javascript" ' +
               'charset="UTF-8"> ' +
               '</scr'+'ipt>');
</script>


<script type="text/javascript">
//
//  Ethnio survey code
//
/*          DocumentID      EthnioID */
/*          -------------   -------- */
var ethnio=["/en_US/flash/cs/using/WSb03e830bd6f770ee6664507612436d7dede-8000.html", "87462",
            "/en_US/creativesuite/cs/using/WSe851854fd1e0856a-4b08a77612477f69f15-8000.html",  "10441",
            "/en_US/dreamweaver/cs/using/WSEE4C0148-A6F4-4bf5-9DEF-CE06AB026214a.html",  "57412"
 
    ];
                        
    for ( var i = 0; i < ethnio.length ; i = i+2 ){
        if ( document.location.href.indexOf( ethnio[i] ) > -1 ){ 
            var headID = document.getElementsByTagName("head")[0];         
            var ethnioScript = document.createElement('script');
            ethnioScript.type = 'text/javascript';
            ethnioScript.src = 'http://ethn.io/remotes/' + ethnio[i+1];        
            if ( debug ){
                alert ("Using Ethnio script: " + ethnioScript.src );
            }else{
                headID.appendChild(ethnioScript);
            }
        }
    }
</script>



<div style="display: none;">
<!-- SiteCatalyst -->
<script language="JavaScript" type="text/javascript"><!--
var s_code=' ';
var s_docHost = window.location.hostname.toLowerCase();
var s_docURL = window.location.pathname.toLowerCase();
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
if (s_docHost.indexOf(".corp.adobe") != -1 || s_docHost.indexOf("stage.") != -1 || s_docHost.indexOf(".dev.adobe") != -1 || s_docHost.indexOf("staging.") != -1) scJsHost="";
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/omniture_s_code.js' type='text/javascript'%3E%3C/script%3E"));
//--></script>
<script type="text/javascript"><!--
var s_accountName;
s_server="www.adobe.com static content pages";
if (!window.s_account) s_accountName="mxmacromedia";
else s_accountName=window.s_account;

if (window.s_docURL.indexOf("/designcenter/") != -1)
  s_channel="Adobe Design Center";	
else if ((window.s_docHost.indexOf("labs.adobe") != -1) ||
(window.s_docHost.indexOf("labs-staging.") != -1))
  s_channel="Labs";
else if (window.s_docHost.indexOf("help.adobe.com") != -1) {
  s_channel="Support Help.adobe.com";
  if (window.s_docURL.indexOf("/en_us/") == -1) {
    s_docURLArray=s_docURL.split('/');
    s_pageName="http://help.adobe.com/"+s_docURLArray[1]+"/"+ s_docURLArray[2]+"/"+s_docURLArray[3];
    s_prop23="http://help.adobe.com"+window.location.pathname;
  }
}
else if (window.s_docHost.indexOf("kb2.adobe.com") != -1) {
  s_channel="Support Knowledgebase";
  s_prop23="http://kb2.adobe.com"+s_docURL+":";
  if (typeof(omtrProductList) != 'undefined' && omtrProductList.length > 0)
 {
    s_prop23=s_prop23+omtrProductList;
  }
}
else if (window.s_docHost.indexOf("resellers.adobe.com") != -1) {
		var s_pageName=document.getElementsByTagName("title")[0].text;
}

if (!window.scMMInclude) {
	var s_wd=window,s_tm=new Date;
	if(s_code!=' '){
		s_code=s_dc(s_accountName);
		if(s_code)document.write(s_code)
	} 
} else {
	s_wds(s_accountName);s_ca(s_accountName); 
}	

function sendAnalyticsEvent(str){var ns=s_accountName;if(str!=null)ns+=","+str;void(s_gs(ns));}
function sendLinkEvent(accnt,lnkname,type){
accnt=s_accountName;s_linkType=type;s_lnk=true;s_linkName=lnkname;void(s_gs(accnt));}
//--></script>
<noscript><img src="http://stats.adobe.com/b/ss/mxmacromedia/1/H.15-XELvs/0?pageName=http%3A//www.adobe.com%3A%20noscript&ch=http%3A//www.adobe.com%3A%20noscript&g=http%3A//www.adobe.com" height="1" width="1" border="0" alt="" /></noscript>
<!-- End SiteCatalyst -->
</div>

<script language="JavaScript" type="text/javascript">//<![CDATA[
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/atm/s_code_www.js' type='text/javascript'%3E%3C/script%3E"));
//]]></script>
<script type="text/javascript">//<![CDATA[
if(s_adobe){	
	s_adobe.server="www.adobe.com Static Content pages";
	/* Set pageName */
	s_adobe.s_URL="adobe.com"+((location.pathname.charAt(0)=='/')?location.pathname:'/'+location.pathname);
	if (s_adobe.s_URL.substring(s_adobe.s_URL.lastIndexOf('/')+1)=="") s_adobe.s_URL=s_adobe.s_URL+"index.html";
	s_adobe.s_URLSplit=s_adobe.s_URL.split("/");
	s_adobe.pageName=s_adobe.s_URLSplit.join(":");

	/* Set prop4 to language-locale */
	var s_meta=document.getElementsByTagName('meta'); 
      for (i=0; i<s_meta.length; i++) { 
        if (s_meta[i].getAttribute("http-equiv") == "Content-Language") { 
          s_adobe.prop4=s_meta[i].getAttribute("content"); 
	    s_adobe.prop4=s_adobe.prop4.replace(/\s+/g,'');
        } 
      } 
	s_adobe.t()
}
//]]></script>








  </body>
</html>