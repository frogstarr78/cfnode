<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="lang" content="en-us" />
    <meta name="area" content="livedocs" />
    <title>Adobe&#160;ColdFusion&#160;9 * Creating a search tool for ColdFusion applications</title>
    <link rel="shortcut icon" href="images/ColdFusionLinkIndicator.png" />
    <meta name="book" content="Developing&#160;ColdFusion 9 Applications" />
    <meta name="product" content="ColdFusion" />
    <meta name="keywords" content="" /><!--<PageMap><DataObject type="document"><Attribute name="product" value="ColdFusion"></Attribute><Attribute name="book" value="Developing&#160;ColdFusion 9 Applications"></Attribute><Attribute name="keywords" value=""></Attribute></DataObject></PageMap>-->
    
    <script type="text/javascript" language="Javascript" charset="UTF-8"><!--[CDATA[
        var currentTreeNode = "WSc3ff6d0ea77859461172e0811cbec0ef2f-7ffd.html";
    document.cookie = "topicId=" + "WSc3ff6d0ea77859461172e0811cbec0ef2f-7ffd.html";
// ]]--></script>
<script src="terms.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="help.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script>  <script src="utilities.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="event.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="treeview.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="toc.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script> <script src="swfobject.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>  <script src="booklist.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>
<script type="text/javascript">
<!--[CDATA[
var topictype = "topic";
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
  var linkId = document.createElement("link");
  linkId.href = "content-ie6.css";
  linkId.rel = "stylesheet";
  linkId.type = "text/css";
  headId.appendChild(linkId);
}
function initRoboHelpDOM() {
  if (use_chm_behavior) {
    hideElement("search");
  }
  if (use_robohelp_behavior) {
    hideElement("search");
    hideElement("productmenu");
    //hideElement("notyourversion");
  }
  if(!use_chc_behavior) {
    //document.getElementById("notyourversion").style.display = "inline";;
  }
}
var dirname = location.pathname.match( /.*\// );    
function setSearchUserPref(){
  if ( document.cookie.indexOf( "ah_searchpref" ) > -1 ) {
    if ( document.cookie.indexOf( dirname ) > 0 ) {
      document.search.gsa.checked = true ;
    }else{
      document.search.gsa.checked = false ;            
    }
  }
}
YAHOO.util.Event.onDOMReady(initRoboHelpDOM);
YAHOO.util.Event.onDOMReady(setSearchUserPref);
// ]]-->
</script>

<!-- ********************************** -->
<!-- START: ForeSee survey code in: /ssi/globalheader.ssi -->

<script type="text/javascript">
<!-- 
// Enable the survey for only English, German and Japanese
var agt=navigator.userAgent.toLowerCase();
if ( agt.indexOf("community help client") == -1 ){
    if ( document.location.href.indexOf("/en_US/") != -1 ){
        showSurvey();
//    }else if (document.location.href.indexOf("/de_DE/") != -1){
//         var locale="de";
//         showSurvey();
    }else if (document.location.href.indexOf("/ja_JP/") != -1 ){
         var locale="ja";
         showSurvey();
    }	
}

function showSurvey(){
	document.write('<script type="text/javascript" src="/js/foresee/foresee-trigger.js"><\/scr'+'ipt>');
}

// -->
</script>

<!-- END: ForeSee survey code -->
<!-- ******************************** -->




    <link rel="stylesheet" type="text/css" href="tree.css" />
    <link rel="stylesheet" type="text/css" href="content.css" />
    <link rel="stylesheet" type="text/css" href="localeSpecific.css" />
  </head>
  <body id="content_body" onload="window.focus();">
    <a name="top" shape="rect"><!--LeaveCommentHere--></a>
    
    <div id="mnemonic">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon" class="ColdFusion"><div class="banner"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html">Adobe&#160;ColdFusion&#160;9</a><span id="notyourversion">|&#160;
                    <a rel="nofollow" href="http://www.adobe.com/support/documentation/en/coldfusion/">Not your version?</a></span></div></div><!--googleon: index-->
    </div>
    
    <div id="searchbar">
<table id="searchbartable">
<tr>
<td colspan="2">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon"><div id="pdf"><img src="images/PDF.gif" width="16" height="16" /><a title="View Help PDF" href="coldfusion_9_dev.pdf">View Help PDF ( 23MB)</a></div></div><!--googleon: index-->
</td>
</tr>
</table>
    </div>

<!-- BEGIN SEARCH CONTENT -->
<form id="search" name="search" action="search.html" target="_self">
<script type="text/javascript">
<!--[CDATA[
if ( !use_chc_behavior ){
    if (typeof(terms_AHV_SEARCH_CONSTRAINT) != "undefined" && 
        terms_AHV_SEARCH_CONSTRAINT.length > 0 && 
        document.location.href.indexOf(".adobe.com") > 0){
        if ( typeof(terms_SEARCH_THIS_HELP_ONLY) != "undefined" && terms_SEARCH_THIS_HELP_ONLY == "ON" ) {
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                checked="checked" \
                value="1" ><\/input>'); 
                
        // Leave the "Search this help system only" checkbox unckecked
        }else{    
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                value="1" ><\/input>'); 
        }
        document.write('<span class="gsalabel">' + terms_AHV_SEARCH_CONSTRAINT + '<\/span><\/div>'); 
    }
    document.write('<input class="searchinput" \
        name="q" \
        id="q" \
        type="text" \
        maxlength="256" \
        value="' + terms_AHV_SEARCH_BUTTON + '" \
        onclick="clearSearch()"><\/input><input \
        type="button" \
        name="searchbutton" \
        class="searchbutton" \
        onclick="submit()"><\/input>'); 
} 
 
/* 
 * Start Functions 
 */
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}

// set search preferences
function setAHSearchPref(){
    if (document.search.gsa.checked == 1){
        setAHSearchCookie( dirname );
    }else{
        setAHSearchCookie( "community" );
    }
}

// Set search preferences cookie
function setAHSearchCookie( p ){
    // set cookie ah_searchpref with a value of the document path
    var expire=new Date();
    expire.setDate(expire.getDate()+365); // Cookie expires after 1 year (365 days) 
    document.cookie="ah_searchpref=" +p+ "; expires=" +expire.toGMTString()+ ";";
}

// ]]-->
</script> 
 </form>
<!-- END SEARCH CONTENT -->    



<!-- BEGIN PAGE CONTENT WRAPPER -->
    <div id="page_content_wrapper">
<!-- BEGIN PAGE WRAPPER -->
<table id="page_content_table">
<tr>

<td id="col2">
<!-- BEGIN CONTENT WRAPPER -->
<!-- BEGIN BREADCRUMBS -->

      
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc3ff6d0ea77859461172e0811cbec22c24-7b4c.html" title="Specifying a language"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc3ff6d0ea77859461172e0811cbec0ef2f-7ff1.html" title="Creating a search page"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Developing&#160;ColdFusion 9 Applications</b></a> / <a href="WS8f0cc78011fffa7168855f811cdb0b0cce-8000.html"><b>Accessing and Using Data</b></a> 
      / <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7b7e.html"><b>Building a Search Interface</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
      <div id="content_wrapper">
<!-- BEGIN PAGE TITLE -->
        <h1>Creating a search tool for ColdFusion applications</h1>
<!-- END PAGE TITLE -->
<!-- BEGIN IONCOMMENTCOUNT -->
        <div id="ionCount">
        </div>
<!-- END IONCOMMENTCOUNT -->
<table id="inner_content_table" width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td>
          <div style="border-top:#ccc solid 1px;"><p> </p>
          </div>
<p id="chcPromo" style="display:none;">
<a id="chcLink" href="http://www.adobe.com/support/chc/">
<img id="chcImage" src="http://www.adobe.com/support/chc/GetMoreHelpFeatures.png"/>
</a>
</p>
<script type="text/javascript" language="javascript" charset="utf-8">
<!--
var cfgArray = [];
//cfgArray["Acrobat_10.0_Professional.helpcfg"] = "acrobatpro";
//cfgArray["Acrobat_10.0_Standard.helpcfg"] = "acrobatstd";
cfgArray["Lightroom_3.0.helpcfg"] = "lightroom";
cfgArray["PhotoshopElements_8.0_Win.helpcfg"] = "photoshopelements";
cfgArray["PhotoshopElements_8.0_Mac.helpcfg"] = "photoshopelementsmac";
cfgArray["PremiereElements_8.0_Win.helpcfg"] = "premiereelements";

//cfgArray["AfterEffects_10.0.helpcfg"] = "aftereffects";
//cfgArray["AIR.helpcfg"] = "air";
//cfgArray["ColdFusionBuilder.helpcfg"] = "coldfusion";
//cfgArray["Contribute_6.0.helpcfg"] = "contribute";
//cfgArray["DeviceCentral_3.0.helpcfg"] = "devicecentral";
//cfgArray["Dreamweaver_11.0.helpcfg"] = "dreamweaver";
//cfgArray["EncoreDVD_5.0.helpcfg"] = "encore";
//cfgArray["ExtensionManager_3.0.helpcfg"] = "extension";
//cfgArray["Fireworks_11.0.helpcfg"] = "fireworks";
//cfgArray["Flash_11.0.helpcfg"] = "flash";
//cfgArray["Flex_4.0.helpcfg"] = "flashbuilder";
//cfgArray["FlashCatalyst_1.0.helpcfg"] = "flashcatalyst";
//cfgArray["Illustrator_15.0.helpcfg"] = "illustrator";
//cfgArray["InCopy_7.0.helpcfg"] = "incopy";
//cfgArray["InDesign_7.0.helpcfg"] = "indesign";
//cfgArray["OnLocation_5.0.helpcfg"] = "onlocation";
//cfgArray["Photoshop_12.0.helpcfg"] = "photoshop";
//cfgArray["PremierePro_5.0.helpcfg"] = "premierepro";

function getLangName() {
    var lang = "en-us";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if (ptn.test(lang)) {
        var languageCode = lang.replace(ptn, "$1");
        var countryCode = lang.replace(ptn, "$2");
        lang = languageCode + "_" + countryCode.toUpperCase();
    }
    return lang;
}

function getCountryName() {
    var lang = "";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if ((ptn.test(lang)) && (lang != "en-us")) {
        var countryCode = lang.replace(ptn, "$2");
        return "/" + countryCode;
    }
    return "";
}

if ( (typeof(terms_HELPCFG) != 'undefined')  && (terms_HELPCFG.indexOf(".helpcfg") != -1) ) {
    var stage   = (document.location.href.indexOf(".stage.") != -1) ? 'stage.' : '';
    var baseUrl = 'http://www.' + stage + 'adobe.com';
    var refpage = document.location.href.replace(/#.*$/, '');
	
	if ((!use_robohelp_behavior) && (terms_HELPCFG.length > 0) && (typeof(cfgArray[terms_HELPCFG]) != 'undefined') && (cfgArray[terms_HELPCFG].length > 0)) {
		if (document.getElementById) { // DOM3 = IE5, NS6
			var newHref = baseUrl + getCountryName() + "/support/chc/" + "?helpcfg=http://help." + stage + "adobe.com/HelpCfg/" + getLangName() + "/" + terms_HELPCFG + "&url=" + refpage + "&product=" + cfgArray[terms_HELPCFG];
			var newSrc = baseUrl + getCountryName() + "/support/chc/GetMoreHelpFeatures.png";
			document.getElementById("chcPromo").style.display = "block";
			document.getElementById("chcLink").href = newHref;
			document.getElementById("chcImage").src = newSrc;
		}
	}
}

//-->
</script>



          <div id="minitoc"><div class="t"><div class="b"><div><ul id="minitoc-links"><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec22c24-7b50"><span class="topictitle1">Creating a collection with the ColdFusion Administrator</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0ef2f-7ff9"><span class="topictitle1">About indexing a collection</span>
</a></p><ul><li><p><a href="#WSC52262D3-3649-4fae-B379-C37F9EE4489C"><span class="topictitle2">Updating an index</span>
</a></p></li></ul></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0ef2f-7ffb"><span class="topictitle1">Creating a ColdFusion search tool programmatically</span>
</a></p><ul><li><p><a href="#WS4BA63DC4-2723-4415-994E-C512B6B99EF8"><span class="topictitle2">Creating a collection with the cfcollection tag</span>
</a></p></li><li><p><a href="#WS0B61CD96-D88F-49bf-9923-88D83EBB3058"><span class="topictitle2">Create a simple collection form page</span>
</a></p></li><li><p><a href="#WSC5BDB011-06C5-4ba2-B2A6-A85F39C971D9"><span class="topictitle2">Create a collection action page</span>
</a></p></li><li><p><a href="#WS58344CFF-6ED2-4499-837D-49DEB45C4A5B"><span class="topictitle2">Indexing a collection by using the cfindex tag</span>
</a></p></li><li><p><a href="#WSC63F196C-34CA-4612-B52C-3BB6077DCAAA"><span class="topictitle2">Select which collection to index</span>
</a></p></li><li><p><a href="#WSCF91201C-1A30-47cd-BD3F-D434DE509A8C"><span class="topictitle2">Use cfindex to index a collection</span>
</a></p></li><li><p><a href="#WS7591EC0E-E3F9-4fda-902B-F4A402FEDB1A"><span class="topictitle2">Indexing a collection with the ColdFusion Administrator</span>
</a></p></li></ul></li></ul></div></div></div></div><div><p>The
three main tasks in creating a search tool for your ColdFusion application
are:</p>
<ol><li><p>Create a collection.</p>
</li>
<li><p>Index the collection.</p>
</li>
<li><p>Design a search interface.</p>
</li>
</ol>
<p>You can perform each task programmatically—that is, by writing
CFML code. Alternatively, you can use the ColdFusion Administrator
to create and index a collection.</p>
</div>
<div id="WSc3ff6d0ea77859461172e0811cbec22c24-7b50" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec22c24-7b50"><!-- --></a><h2 class="topictitle2">Creating a collection with the ColdFusion Administrator</h2><div><p>Use the following
procedure to quickly create a collection with the ColdFusion Administrator:</p>
<ol><li><p>In the ColdFusion Administrator, select Data &amp; Services
&gt; Verity Collections.</p>
</li>
<li><p>Enter a name for the collection; for example, DemoDocs.</p>
</li>
<li><p>Enter a path for the directory location of the new collection,
for example, C:\CFusion\verity\collections\. </p>
<p>By default in
the server configuration, ColdFusion stores collections in <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">cf_root</i>\verity\collections\
in Windows and in <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">cf_root</i>/verity/collections on UNIX. In
the multiserver configuration, the default location for collections
is <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">cf_webapp_root</i>/verity/collections. In the J2EE configuration,
the default location for collections is <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">verity_root</i>/verity/collections,
where <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">verity_root</i> is the directory in which you installed
Verity.</p>
<div class="note"><span class="notetitle">Note:  </span>This is the location for the collection,
not for the files that you search.</div>
</li>
<li><p>(Optional) Select a language other than English for the collection
from the Language drop-down list.</p>
<p>For more information on
selecting a language, see <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7b4c.html">Specifying a language</a>.</p>
</li>
<li><p>(Optional) Select Enable Category Support to create a Verity
Parametric collection.</p>
<p>For more information on using categories,
see <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7b29.html">Narrowing searches by using categories</a>.</p>
</li>
<li><p>Click Create Collection.</p>
<p>The name and full path of
the new collection appears in the list of Verity Collections.</p>
</li>
</ol>
<p>You have successfully created an empty collection. A collection
becomes populated with data when you index it. </p>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0ef2f-7ff9" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0ef2f-7ff9"><!-- --></a><h2 class="topictitle2">About indexing a collection</h2><div><p>In
order for information to be searched, it must be indexed. Indexing
extracts both meaning and structure from unstructured information
by indexing each document that you specify into a separate Verity
collection that contains a complete list of all the words used in
a given document along with metadata about that document. Indexed
collections include information such as word proximity, metadata
about physical file system addresses, and URLs of documents.</p>
<p>When you index databases and other recordsets that you generated
using a query, Verity creates a collection that normalizes both
the structured and unstructured data. Search requests then check
these collections rather than scanning the actual documents and
database fields. This provides a faster search of information, regardless
of the file type and whether the source is structured or unstructured.</p>
<p>Just as with creating a collection, you can index a collection
programmatically or by using the ColdFusion Administrator. Use the
following guidelines to determine which method to use:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e48342"><p>Use the Administrator</p>
</th>
<th valign="top" width="NaN%" id="d17e48345"><p>Use the cfindex tag </p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e48342 "><p>To index document files</p>
</td>
<td valign="top" width="NaN%" headers="d17e48345 "><p>To index ColdFusion query results</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e48342 "><p>When the collection does not require frequent
updates</p>
</td>
<td valign="top" width="NaN%" headers="d17e48345 "><p>When the collection requires frequent updates</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e48342 "><p>To create the collection without writing
any CFML code</p>
</td>
<td valign="top" width="NaN%" headers="d17e48345 "><p>To dynamically update a collection from
a ColdFusion application page</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e48342 "><p>To create a collection once</p>
</td>
<td valign="top" width="NaN%" headers="d17e48345 "><p>When the collection requires updating by
others</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>You can use <samp class="codeph">cfcollection</samp><samp class="codeph">action="optimize"</samp> if
you notice that searches on a collection take longer than they did
previously.</p>
</div><div id="WSC52262D3-3649-4fae-B379-C37F9EE4489C" class="nochunk"><a name="WSC52262D3-3649-4fae-B379-C37F9EE4489C"><!-- --></a><h3 class="topictitle3">Updating an index</h3><div><p>Documents
are modified frequently in many user environments. After you index your
documents, any changes that you make are not reflected in subsequent Verity
searches until you reindex the collection. Depending on your environment,
you can create a scheduled task to automatically keep your indexes current.
For more information on scheduled tasks, see <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">Configuring and Administering ColdFusion</i>.</p>
</div></div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0ef2f-7ffb" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0ef2f-7ffb"><!-- --></a><h2 class="topictitle2">Creating a ColdFusion search tool programmatically</h2><div><p>You can create a Verity search tool for your ColdFusion
application in CFML. Although writing CFML code can take more development
time than using these tools, in some situations, writing code is
the preferred development method.</p>
</div><div id="WS4BA63DC4-2723-4415-994E-C512B6B99EF8" class="nochunk"><a name="WS4BA63DC4-2723-4415-994E-C512B6B99EF8"><!-- --></a><h3 class="topictitle3">Creating a collection with the cfcollection tag</h3><div><p>The
following are cases in which you might prefer using the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d03.html" target="_self">cfcollection</a></samp> tag rather than
the ColdFusion Administrator to create a collection:</p>
<ul><li><p>You want your ColdFusion application to be able to create,
delete, and maintain a collection.</p>
</li>
<li><p>You do not want to expose the ColdFusion Administrator to
users.</p>
</li>
<li><p>You want to create indexes on servers that you cannot access
directly; for example, if you use a hosting company.</p>
</li>
</ul>
<p>When using the <samp class="codeph">cfcollection</samp> tag, you can specify
the same attributes as in the ColdFusion Administrator:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e48436"><p>Attribute</p>
</th>
<th valign="top" width="NaN%" id="d17e48439"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e48436 "><p><samp class="codeph">action </samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e48439 "><p>(Optional) The action to perform on the
collection (create, delete, or optimize). The default value for
the <samp class="codeph">action</samp> attribute is <samp class="codeph">list</samp>.
For more information, see <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d03.html" target="_self">cfcollection</a></samp> in <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">CFML Reference</i>.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e48436 "><p><samp class="codeph">collection </samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e48439 "><p>The name of the new collection, or the name
of a collection upon which you perform an action.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e48436 "><p><samp class="codeph">path </samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e48439 "><p>The location for the Verity collection.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e48436 "><p><samp class="codeph">language </samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e48439 "><p>The language.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e48436 "><p><samp class="codeph">categories </samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e48439 "><p>(Optional) Specifies that <samp class="codeph">cfcollection</samp> create
a Verity Parametric Index (PI) for this collection. By default,
the categories attribute is set to <samp class="codeph">False</samp>. To create
a collection that uses categories, specify <samp class="codeph">Yes</samp>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>You can create a collection by directly assigning a value to
the <samp class="codeph">collection</samp> attribute of the <samp class="codeph">cfcollection</samp> tag,
as shown in the following code:</p>
<pre>&lt;cfcollection action = "create" 
    collection = "a_new_collection" 
    path = "c:\CFusion\verity\collections\"&gt;</pre>
<p>If you want your users to be able to dynamically supply the name
and location for a new collection, use the following procedures
to create form and action pages.</p>
</div></div><div id="WS0B61CD96-D88F-49bf-9923-88D83EBB3058" class="nochunk"><a name="WS0B61CD96-D88F-49bf-9923-88D83EBB3058"><!-- --></a><h3 class="topictitle3">Create a simple collection form page</h3><div><ol><li><p>Create a ColdFusion page with the following content:</p>
<pre>&lt;html&gt; 
&lt;head&gt; 
    &lt;title&gt;Collection Creation Input Form&lt;/title&gt; 
&lt;/head&gt; 
 
&lt;body&gt; 
&lt;h2&gt;Specify a collection&lt;/h2&gt; 
&lt;form action="collection_create_action.cfm" method="POST"&gt; 
     
    &lt;p&gt;Collection name:  
    &lt;input type="text" name="CollectionName" size="25"&gt;&lt;/p&gt; 
     
    &lt;p&gt;What do you want to do with the collection?&lt;/p&gt; 
    &lt;input type="radio"  
        name="CollectionAction"  
        value="Create" checked&gt;Create&lt;br&gt; 
    &lt;input type="radio"  
        name="CollectionAction"  
        value="Optimize"&gt;Optimize&lt;br&gt; 
    &lt;input type="submit"  
        name="submit"  
        value="Submit"&gt;  
&lt;/form&gt; 
 
&lt;/body&gt; 
&lt;/html&gt;</pre>
</li>
<li><p>Save the file as collection_create_form.cfm in the myapps
directory under the web root directory.</p>
</li>
</ol>
<div class="note"><span class="notetitle">Note:  </span>The form does not work until you write an action
page for it, which is the next procedure.</div>
</div></div><div id="WSC5BDB011-06C5-4ba2-B2A6-A85F39C971D9" class="nochunk"><a name="WSC5BDB011-06C5-4ba2-B2A6-A85F39C971D9"><!-- --></a><h3 class="topictitle3">Create a collection action page</h3><div><ol><li><p>Create a ColdFusion page with the following content:</p>
<pre>&lt;html&gt; 
&lt;head&gt; 
    &lt;title&gt;cfcollection&lt;/title&gt; 
&lt;/head&gt; 
 
&lt;body&gt; 
&lt;h2&gt;Collection creation&lt;/h2&gt; 
 
&lt;cfoutput&gt; 
 
    &lt;cfswitch expression=#Form.collectionaction#&gt; 
        &lt;cfcase value="Create"&gt; 
            &lt;cfcollection action="Create" 
            collection="#Form.CollectionName#" 
            path="c:\CFusion\verity\collections\"&gt; 
            &lt;p&gt;The collection #Form.CollectionName# is created.&lt;/p&gt; 
        &lt;/cfcase&gt; 
 
        &lt;cfcase value="Optimize"&gt; 
            &lt;cfcollection action="Optimize" 
            collection="#Form.CollectionName#"&gt; 
            &lt;p&gt;The collection #Form.CollectionName# is optimized.&lt;/p&gt; 
        &lt;/cfcase&gt; 
 
        &lt;cfcase value="Delete"&gt; 
            &lt;cfcollection action="Delete" 
            collection="#Form.CollectionName#"&gt; 
            &lt;p&gt;The collection is deleted.&lt;/p&gt; 
        &lt;/cfcase&gt; 
    &lt;/cfswitch&gt; 
&lt;/cfoutput&gt; 
&lt;/body&gt; 
&lt;/html&gt;</pre>
</li>
<li><p>Save the file as collection_create_action.cfm in the myapps
directory under the web root directory.</p>
</li>
<li><p>In the web browser, enter the following URL to display the
form page:</p>
<p><strong>http://hostname:portnumber/myapps/collection_create_form.cfm</strong></p>
</li>
<li><p>Enter a collection name; for example, CodeColl.</p>
</li>
<li><p>Verify that Create is selected and submit the form.</p>
</li>
<li><p>(Optional) In the ColdFusion Administrator, reload the ColdFusion
Collections page.</p>
</li>
</ol>
<p>The name and full path of the new collection appear in the list
of Verity Collections.</p>
<p>You successfully created a collection, named CodeColl, that currently
has no data.</p>
</div></div><div id="WS58344CFF-6ED2-4499-837D-49DEB45C4A5B" class="nochunk"><a name="WS58344CFF-6ED2-4499-837D-49DEB45C4A5B"><!-- --></a><h3 class="topictitle3">Indexing a collection by using the cfindex tag</h3><div><p>You can index a collection in CFML by using the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d04.html" target="_self">cfindex</a></samp> tag, which eliminates the
need to use the ColdFusion Administrator. The <samp class="codeph">cfindex</samp> tag
populates the collection with metadata that is then used to retrieve
search results. You can use the <samp class="codeph">cfindex</samp> tag to
index either physical files (documents stored within your website’s
root folder), or the results of a database query. </p>
<div class="note"><span class="notetitle">Note:  </span>Before indexing a collection, create a Verity
collection by using the ColdFusion Administrator, or the <samp class="codeph">cfcollection</samp> tag.
For more information, see <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7b50.html">Creating a collection with the ColdFusion Administrator</a>, or <a href="WS4BA63DC4-2723-4415-994E-C512B6B99EF8.html">Creating a collection with the cfcollection tag</a>.</div>
<p>When using the <samp class="codeph">cfindex</samp> tag, the following attributes
correspond to the values that you would enter by using the ColdFusion
Administrator to index a collection:</p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e48608"><p>Attribute</p>
</th>
<th valign="top" width="NaN%" id="d17e48611"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e48608 "><p><samp class="codeph">collection</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e48611 "><p>The name of the collection.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e48608 "><p><samp class="codeph">action</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e48611 "><p>Specifies what the <samp class="codeph">cfindex</samp> tag
should do to the collection. The default <samp class="codeph">action</samp> is
to update the collection, which generates a new index. Other <samp class="codeph">actions</samp> are
to delete, purge, or refresh the collection.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e48608 "><p><samp class="codeph">type</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e48611 "><p>Specifies the type of files or other data
to which the <samp class="codeph">cfindex</samp> tag applies the specified
action. The value you assign to the <samp class="codeph">type</samp> attribute
determines the value to use with the <samp class="codeph">key</samp> attribute
(see the following list). When you enter a value for the <samp class="codeph">type</samp> attribute, <samp class="codeph">cfindex</samp> expects
a corresponding value in the <samp class="codeph">key</samp> attribute. For
example, if you specify <samp class="codeph">type=file</samp>, <samp class="codeph">cfindex</samp> expects
a directory path and filename for the <samp class="codeph">key</samp> attribute. </p>
<p>The <samp class="codeph">type</samp> attribute
has the following possible values:</p>
<div class="para"><ul><li><p><samp class="codeph">file</samp>:
Specifies a directory path and filename for the file that you are
indexing.</p>
</li>
<li><p><samp class="codeph">path</samp>: Specifies a directory path that contains
the files that you are indexing.</p>
</li>
<li><p><samp class="codeph">custom</samp>: Specifies custom data, such as a
recordset returned from a query.</p>
</li>
</ul>
</div>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e48608 "><p><samp class="codeph">extensions</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e48611 "><p>(Optional) The delimited list of file extensions
that ColdFusion uses to index files if <samp class="codeph">type="path"</samp><samp class="codeph">.</samp></p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e48608 "><p><samp class="codeph">key</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e48611 "><p>The value that you specify for the <samp class="codeph">key</samp> attribute
depends on the value set for the <samp class="codeph">type</samp> attribute: </p>
<div class="para"><ul><li><p>If <samp class="codeph">type="file"</samp>, the <samp class="codeph">key</samp> is
the directory path and filename for the file you are indexing<samp class="codeph">.</samp></p>
</li>
<li><p>If <samp class="codeph">type="path"</samp>, the <samp class="codeph">key</samp> is
the directory path that contains the files you are indexing<samp class="codeph">.</samp></p>
</li>
<li><p>If <samp class="codeph">type="custom"</samp>, the <samp class="codeph">key</samp> is
a unique identifier specifying the location of the documents you
are indexing; for example, the URL of a specific web page or website
whose contents you want to index<samp class="codeph">.</samp> If you are indexing data
returned by a query (from a database for example), the <samp class="codeph">key</samp> is
the name of the recordset column that contains the primary key. </p>
</li>
</ul>
</div>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e48608 "><p><samp class="codeph">URLpath</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e48611 "><p>(Optional) The URL path for files if <samp class="codeph">type="file"</samp> and <samp class="codeph">type="path"</samp>.
When the collection is searched with the <a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d02.html" target="_self">cfsearch</a> tag, ColdFusion works as
follows:</p>
<div class="para"><ul><li><p><samp class="codeph">type="file"</samp>: The <samp class="codeph">URLpath</samp> attribute
contains the URL to the file.</p>
</li>
<li><p><samp class="codeph">type="path"</samp>: The path name is automatically
prefixed to filenames and returned as the <samp class="codeph">URLpath</samp> attribute.</p>
</li>
</ul>
</div>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e48608 "><p><samp class="codeph">recurse</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e48611 "><p>(Optional) <samp class="codeph">Yes</samp> or <samp class="codeph">No</samp>.
If <samp class="codeph">type = "path"</samp> , <samp class="codeph">Yes</samp> specifies
that directories below the path specified in the key attribute are
included in the indexing operation. </p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e48608 "><p><samp class="codeph">language</samp></p>
</td>
<td valign="top" width="NaN%" headers="d17e48611 "><p>(Optional) The language of the collection.
The default language is English Basic.</p>
<p>To learn more about
support for languages, see <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7b4c.html">Specifying a language</a>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>You can use form and action pages like the following examples
to select and index a collection.</p>
</div></div><div id="WSC63F196C-34CA-4612-B52C-3BB6077DCAAA" class="nochunk"><a name="WSC63F196C-34CA-4612-B52C-3BB6077DCAAA"><!-- --></a><h3 class="topictitle3">Select which collection to index</h3><div><ol><li><p>Create
a ColdFusion page with the following content:</p>
<pre>&lt;html&gt; 
&lt;head&gt; 
    &lt;title&gt;Select the Collection to Index&lt;/title&gt; 
&lt;/head&gt; 
&lt;body&gt; 
 
&lt;h2&gt;Specify the index you want to build&lt;/h2&gt; 
 
&lt;form method="Post" action="collection_index_action.cfm"&gt; 
    &lt;p&gt;Enter the collection you want to index: 
    &lt;input type="text" name="IndexColl" size="25" maxLength="35"&gt;&lt;/p&gt; 
    &lt;p&gt;Enter the location of the files in the collection: 
    &lt;input type="text" name="IndexDir" size="50" maxLength="100"&gt;&lt;/p&gt; 
    &lt;p&gt;Enter a Return URL to prepend to all indexed files: 
    &lt;input type="text" name="urlPrefix" size="80" maxLength="100"&gt;&lt;/p&gt; 
 
    &lt;input type="submit" name="submit" value="Index"&gt;  
 
&lt;/form&gt; 
 
&lt;/body&gt; 
&lt;/html&gt;</pre>
</li>
<li><p>Save the file as collection_index_form.cfm in the myapps
directory under the <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">web_root</i>.</p>
</li>
</ol>
<div class="note"><span class="notetitle">Note:  </span>The form does not work until you write an action
page for it, which you do when you index a collection.</div>
</div></div><div id="WSCF91201C-1A30-47cd-BD3F-D434DE509A8C" class="nochunk"><a name="WSCF91201C-1A30-47cd-BD3F-D434DE509A8C"><!-- --></a><h3 class="topictitle3">Use cfindex to index a collection</h3><div><ol><li><p>Create a ColdFusion page with the following content:</p>
<pre>&lt;html&gt; 
&lt;head&gt; 
&lt;title&gt;Creating Index&lt;/title&gt; 
&lt;/head&gt; 
&lt;body&gt; 
&lt;h2&gt;Indexing Complete&lt;/h2&gt; 
 
&lt;cfindex collection="#Form.IndexColl#" 
    action="refresh" 
    extensions=".htm, .html, .xls, .txt, .mif, .doc" 
    key="#Form.IndexDir#" 
    type="path" 
    urlpath="#Form.urlPrefix#" 
    recurse="Yes" 
    language="English"&gt; 
 
&lt;cfoutput&gt; 
    The collection #Form.IndexColl# has been indexed. 
&lt;/cfoutput&gt; 
&lt;/body&gt; 
&lt;/html&gt;</pre>
</li>
<li><p>Save the file as collection_index_action.cfm.</p>
</li>
<li><p>In the web browser, enter the following URL to display the
form page:</p>
<p><strong>http://</strong><i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">hostname:portnumber</i><strong>/myapps/collection_index_form.cfm</strong></p>
</li>
<li><p>Enter a collection name; for example, CodeColl.</p>
</li>
<li><p>Enter a file location; for example, C:\ColdFusion9\wwwroot\vw_files.</p>
</li>
<li><p>Enter a URL prefix; for example, http://localhost:8500/vw_files
(assuming that you are using the built-in web server).</p>
</li>
<li><p>Click Index.</p>
<p>A confirmation message appears on successful
completion.</p>
</li>
</ol>
<div class="note"><span class="notetitle">Note:  </span>For information about using the <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7d04.html" target="_self">cfindex</a></samp> tag with a database
to index a collection, see <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7b35.html">Working with data returned from a query</a>.</div>
</div></div><div id="WS7591EC0E-E3F9-4fda-902B-F4A402FEDB1A" class="nochunk"><a name="WS7591EC0E-E3F9-4fda-902B-F4A402FEDB1A"><!-- --></a><h3 class="topictitle3">Indexing a collection with the ColdFusion Administrator</h3><div><p>As
an alternative to programmatically indexing a collection, use the
following procedure to index a collection with the ColdFusion Administrator. </p>
<ol><li><p>In the list of Verity Collections, select a collection
name; for example, CodeColl.</p>
</li>
<li><p>Click Index to open the index page.</p>
</li>
<li><p>For File Extensions, enter the types of files to index. Use
a comma to separate multiple file types; for example, .htm, .html,
.xls, .txt, .mif, .doc.</p>
</li>
<li><p>Enter (or Browse to) the directory path that contains the
files to be indexed; for example, C:\Inetpub\wwwroot\vw_files.</p>
</li>
<li><p>(Optional) To extend the indexing operation to all directories
below the selected path, select the Recursively index subdirectories
check box.</p>
</li>
<li><p>(Optional) Enter a Return URL to prepend to all indexed files. </p>
<p>This
step lets you create a link to any of the files in the index; for
example, http://127.0.0.1/vw_files/.</p>
</li>
<li><p>(Optional) Select a language other than English.</p>
<p>For
more information, see <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7b4c.html">Specifying a language</a>.</p>
</li>
<li><p>Click Submit Changes. </p>
<p>On completion, the ColdFusion
Collections page appears.</p>
</li>
</ol>
<div class="note"><span class="notetitle">Note:  </span>The time required to generate the index depends
on the number and size of the selected files in the path.</div>
<p>This interface lets you easily build a very specific index based
on the filename extension and path information you enter. In most
cases, you do not need to change your server file structures to
accommodate the generation of indexes.</p>
</div></div></div>


<!-- BEGIN USER PREFERENCES -->
          <div id="userprefs">
          </div>
<!-- END USER PREFERENCES -->

          <div id="related">
            
            
            <div class="separator"><a href="#top"><img src="images/BTT.jpg" /></a>&#160;</div>
          </div>
          <div id="footer">
<!-- BEGIN IONCOMMENTS -->
            <div id="ionComHere">
            </div>
<!-- END IONCOMMENTS -->


            <p id="creativecommons"><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text"><img id="creativecommons_img" src="images/CC.png" alt="This work is licensed under a Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License" /></a>&nbsp;Twitter™ and Facebook posts are not covered under the terms of Creative Commons.</p>
          </div>
</td>
<td width="10px"></td>
<td id="inner_rightcolumn">

</td></tr></table>
      </div>
<!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc3ff6d0ea77859461172e0811cbec22c24-7b4c.html" title="Specifying a language"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc3ff6d0ea77859461172e0811cbec0ef2f-7ff1.html" title="Creating a search page"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Developing&#160;ColdFusion 9 Applications</b></a> / <a href="WS8f0cc78011fffa7168855f811cdb0b0cce-8000.html"><b>Accessing and Using Data</b></a> 
      / <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7b7e.html"><b>Building a Search Interface</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
<!-- END CONTENT WRAPPER -->

</td>
<td id="col3">
    <div>
        <img src="images/adobe-lq.png" />
    </div>
</td>
</tr>
</table>
    </div>
<!-- END PAGE CONTENT WRAPPER -->
<script type="text/javascript">
<!--[CDATA[
scrollToNameAnchor();
// ]]-->
</script> 
<!--
    Description:
    This file generates the link to product support in the top right corner
-->

<style>
#menutop{
    position:absolute;
    top:4px;
    right:24px;
    width:auto;    
    font-size:11px;
    color:#fff;
    text-align:right;
}
#menutop a{
    color:#fff;
}
#menutop a:hover{
        text-decoration:underline;
}
</style>  
  
  
  
  
<div id="productmenu">
<!--googleoff: index-->
  <div id="menutop">


<script language=javascript type='text/javascript'>
    // darken menu text for products with light backgrounds
    var path = document.location.href.toLowerCase();
    if (path.indexOf("/acrobat/")           	> 0 ||
        path.indexOf("/acrobat.com/")       	> 0 ||
        path.indexOf("/acrobatConnectPro/") 	> 0 ||
        path.indexOf("/connect/")           	> 0 ||
        path.indexOf("/livecycledataserviceses/") > 0 ||
        path.indexOf("/muse/")         	> 0 ||
	path.indexOf("/presenter/")         	> 0 ||
        path.indexOf("/scene7/")            	> 0 ||
        path.indexOf("/flashmediaserver/")  	> 0 ||
        path.indexOf("/wave/")              	> 0 )
    {
        document.write('<style>#menutop a{color:#505050}</style>');
    }
    if (typeof('terms_AHV_PRODUCT_SUPPORT') != "undefined" && ! use_robohelp_behavior ){      
        if (path.indexOf("/muse/") > -1 ){
            var supportlink = '<a href="http://muse.adobe.com/support.html">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }else{
            var supportlink = '<a href="http://adobe.com/support">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }
        document.write( supportlink );
     }

</script> 

  </div>
<!--googleon: index-->
</div>



<style>
#online-privacy-policy{ 
    margin:10px 40px; 
    font-size:11px;
}
</style>

<p id="online-privacy-policy">
<script language="javascript">
var pageLoc = "en_US";
var metaElements = document.all ?
document.all.tags('meta') :
document.getElementsByTagName ?
document.getElementsByTagName ('meta') : new Array();
for (var m = 0; m < metaElements.length; m++) {
	if (metaElements[m].name == "lang") {
		pageLoc = metaElements[m].content;
		break;
	}
}
var ptn = /(..)-(..)/;
if (ptn.test(pageLoc)) {
	var languageCode = pageLoc.replace(ptn, "$1");
	var countryCode = pageLoc.replace(ptn, "$2");
	pageLoc = languageCode + "_" + countryCode.toUpperCase();
}

var policyLoc = "en_US";
var policyText = "Online Privacy Policy";
var policyPath = "";
var policyArray=[
"da_DK", "Online fortrolighedserklæring",
"de_DE", "Online-Datenschutzrichtlinie",
"es_ES", "Política de confidencialidad en línea",
"fi_FI", "Yksityisyyttä koskeva Online-toimintaohjelma",
"fr_FR", "Confidentialité et sécurité",
"it_IT", "Informativa sulla privacy online",
"ja_JP", "プライバシーポリシー",
"ko_KR", "Adobe 온라인 개인정보 보호정책",
"pt_BR", "Política de Confidencialidade On-line", 
"zh_CN", "在线隐私政策",
"zh_TW", "線上隱私政策"
];
var legalLoc = "en_US";
var legalText = "Legal Notices";
var legalPath = legalLoc;
var legalArray=[
"ar_AE", "إشعارات قانونية",
"bg_BG", "Юридически бележки",
"cs_CZ", "Právní upozornění",
"da_DK", "Juridiske meddelelser",
"de_DE", "Rechtliche Hinweise",
"el_GR", "Σημειώσεις νομικού περιεχομένου",
"es_ES", "Avisos legales",
"et_EE", "Juriidilised teated",
"fi_FI", "Lakisääteiset ilmoitukset",
"fr_FR", "Mentions légales",
"he_IL", "הצהרות משפטיות",
"hr_HR", "Pravne napomene",
"hu_HU", "Jogi közlemények",
"it_IT", "Informazioni legali",
"ja_JP", "法律上の注意",
"ko_KR", "법적 고지 사항",
"lt_LT", "Teisinės pastabos",
"lv_LV", "Juridisks paziņojums",
"nb_NO", "Juridiske merknader",
"nl_NL", "Juridische kennisgevingen",
"pl_PL", "Informacje prawne",
"pt_BR", "Aspectos jurídicos",
"ro_RO", "Prevederi legale",
"ru_RU", "Юридическая информация",
"sk_SK", "Právne upozornenie",
"sl_SI", "Pravni pouk",
"sv_SE", "Upphovsrätt",
"tr_TR", "Yasal uyarılar",
"uk_UA", "Юридична інформація",
"zh_CN", "法律声明",
"zh_TW", "法律注意事項"
];

ruPolicy = "http://www.adobe.com/ru/misc/privacy.html";
trPolicy = "http://www.adobe.com/tr/misc/privacy.html";

// Bug 2846992: LOC: RUS, TUR: The link to "Online Privacy Policy" should include language, currently it is not appearing.
if (pageLoc == "ru_RU") {
	policyPath = "ru";
}
else if (pageLoc == "tr_TR") {
	policyPath = "tr";
}
for (var i = 0; i < policyArray.length; i+=2) {
	if (pageLoc == policyArray[i]) {
		policyLoc = pageLoc;
		policyText = policyArray[i+1];
		var ptn = /(..)_(..)/;
		if (ptn.test(policyLoc)) {
			var countryCode = policyLoc.replace(ptn, "$2");
			policyPath = countryCode.toLowerCase();
		}
		break;
	}
}

for (var i = 0; i < legalArray.length; i+=2) {
	if (pageLoc == legalArray[i]) {
		legalLoc = pageLoc;
		legalText = legalArray[i+1];
		legalPath = legalLoc;
		break;
	}
}
if(agt.indexOf("community help client") > -1 ){
	document.write('<a href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
}else{
	//Open the privacy policy in a new window
	document.write('<a target="_blank" href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a target="_blank" href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
} 
</script>
</p>



<!-- localfooter.ssi -->

<script type="text/javascript">
    var debug = (top.location.href.indexOf("debug=true") > -1);
</script>

<script language="javascript">
document.write('<scr'+'ipt ' +
               'src="/en_US/ssi/_pod.js" ' +
               'language="javascript" ' +
               'charset="UTF-8"> ' +
               '</scr'+'ipt>');
</script>


<script type="text/javascript">
//
//  Ethnio survey code
//
/*          DocumentID      EthnioID */
/*          -------------   -------- */
var ethnio=["/en_US/flash/cs/using/WSb03e830bd6f770ee6664507612436d7dede-8000.html", "87462",
            "/en_US/creativesuite/cs/using/WSe851854fd1e0856a-4b08a77612477f69f15-8000.html",  "10441",
            "/en_US/dreamweaver/cs/using/WSEE4C0148-A6F4-4bf5-9DEF-CE06AB026214a.html",  "57412"
 
    ];
                        
    for ( var i = 0; i < ethnio.length ; i = i+2 ){
        if ( document.location.href.indexOf( ethnio[i] ) > -1 ){ 
            var headID = document.getElementsByTagName("head")[0];         
            var ethnioScript = document.createElement('script');
            ethnioScript.type = 'text/javascript';
            ethnioScript.src = 'http://ethn.io/remotes/' + ethnio[i+1];        
            if ( debug ){
                alert ("Using Ethnio script: " + ethnioScript.src );
            }else{
                headID.appendChild(ethnioScript);
            }
        }
    }
</script>



<div style="display: none;">
<!-- SiteCatalyst -->
<script language="JavaScript" type="text/javascript"><!--
var s_code=' ';
var s_docHost = window.location.hostname.toLowerCase();
var s_docURL = window.location.pathname.toLowerCase();
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
if (s_docHost.indexOf(".corp.adobe") != -1 || s_docHost.indexOf("stage.") != -1 || s_docHost.indexOf(".dev.adobe") != -1 || s_docHost.indexOf("staging.") != -1) scJsHost="";
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/omniture_s_code.js' type='text/javascript'%3E%3C/script%3E"));
//--></script>
<script type="text/javascript"><!--
var s_accountName;
s_server="www.adobe.com static content pages";
if (!window.s_account) s_accountName="mxmacromedia";
else s_accountName=window.s_account;

if (window.s_docURL.indexOf("/designcenter/") != -1)
  s_channel="Adobe Design Center";	
else if ((window.s_docHost.indexOf("labs.adobe") != -1) ||
(window.s_docHost.indexOf("labs-staging.") != -1))
  s_channel="Labs";
else if (window.s_docHost.indexOf("help.adobe.com") != -1) {
  s_channel="Support Help.adobe.com";
  if (window.s_docURL.indexOf("/en_us/") == -1) {
    s_docURLArray=s_docURL.split('/');
    s_pageName="http://help.adobe.com/"+s_docURLArray[1]+"/"+ s_docURLArray[2]+"/"+s_docURLArray[3];
    s_prop23="http://help.adobe.com"+window.location.pathname;
  }
}
else if (window.s_docHost.indexOf("kb2.adobe.com") != -1) {
  s_channel="Support Knowledgebase";
  s_prop23="http://kb2.adobe.com"+s_docURL+":";
  if (typeof(omtrProductList) != 'undefined' && omtrProductList.length > 0)
 {
    s_prop23=s_prop23+omtrProductList;
  }
}
else if (window.s_docHost.indexOf("resellers.adobe.com") != -1) {
		var s_pageName=document.getElementsByTagName("title")[0].text;
}

if (!window.scMMInclude) {
	var s_wd=window,s_tm=new Date;
	if(s_code!=' '){
		s_code=s_dc(s_accountName);
		if(s_code)document.write(s_code)
	} 
} else {
	s_wds(s_accountName);s_ca(s_accountName); 
}	

function sendAnalyticsEvent(str){var ns=s_accountName;if(str!=null)ns+=","+str;void(s_gs(ns));}
function sendLinkEvent(accnt,lnkname,type){
accnt=s_accountName;s_linkType=type;s_lnk=true;s_linkName=lnkname;void(s_gs(accnt));}
//--></script>
<noscript><img src="http://stats.adobe.com/b/ss/mxmacromedia/1/H.15-XELvs/0?pageName=http%3A//www.adobe.com%3A%20noscript&ch=http%3A//www.adobe.com%3A%20noscript&g=http%3A//www.adobe.com" height="1" width="1" border="0" alt="" /></noscript>
<!-- End SiteCatalyst -->
</div>

<script language="JavaScript" type="text/javascript">//<![CDATA[
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/atm/s_code_www.js' type='text/javascript'%3E%3C/script%3E"));
//]]></script>
<script type="text/javascript">//<![CDATA[
if(s_adobe){	
	s_adobe.server="www.adobe.com Static Content pages";
	/* Set pageName */
	s_adobe.s_URL="adobe.com"+((location.pathname.charAt(0)=='/')?location.pathname:'/'+location.pathname);
	if (s_adobe.s_URL.substring(s_adobe.s_URL.lastIndexOf('/')+1)=="") s_adobe.s_URL=s_adobe.s_URL+"index.html";
	s_adobe.s_URLSplit=s_adobe.s_URL.split("/");
	s_adobe.pageName=s_adobe.s_URLSplit.join(":");

	/* Set prop4 to language-locale */
	var s_meta=document.getElementsByTagName('meta'); 
      for (i=0; i<s_meta.length; i++) { 
        if (s_meta[i].getAttribute("http-equiv") == "Content-Language") { 
          s_adobe.prop4=s_meta[i].getAttribute("content"); 
	    s_adobe.prop4=s_adobe.prop4.replace(/\s+/g,'');
        } 
      } 
	s_adobe.t()
}
//]]></script>








  </body>
</html>