<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="lang" content="en-us" />
    <meta name="area" content="livedocs" />
    <title>Adobe&#160;ColdFusion&#160;9 * Using thread data</title>
    <link rel="shortcut icon" href="images/ColdFusionLinkIndicator.png" />
    <meta name="book" content="Developing&#160;ColdFusion 9 Applications" />
    <meta name="product" content="ColdFusion" />
    <meta name="keywords" content="" /><!--<PageMap><DataObject type="document"><Attribute name="product" value="ColdFusion"></Attribute><Attribute name="book" value="Developing&#160;ColdFusion 9 Applications"></Attribute><Attribute name="keywords" value=""></Attribute></DataObject></PageMap>-->
    
    <script type="text/javascript" language="Javascript" charset="UTF-8"><!--[CDATA[
        var currentTreeNode = "WSc3ff6d0ea77859461172e0811cbec0c09d-7fee.html";
    document.cookie = "topicId=" + "WSc3ff6d0ea77859461172e0811cbec0c09d-7fee.html";
// ]]--></script>
<script src="terms.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="help.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script>  <script src="utilities.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="event.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="treeview.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="toc.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script> <script src="swfobject.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>  <script src="booklist.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>
<script type="text/javascript">
<!--[CDATA[
var topictype = "topic";
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
  var linkId = document.createElement("link");
  linkId.href = "content-ie6.css";
  linkId.rel = "stylesheet";
  linkId.type = "text/css";
  headId.appendChild(linkId);
}
function initRoboHelpDOM() {
  if (use_chm_behavior) {
    hideElement("search");
  }
  if (use_robohelp_behavior) {
    hideElement("search");
    hideElement("productmenu");
    //hideElement("notyourversion");
  }
  if(!use_chc_behavior) {
    //document.getElementById("notyourversion").style.display = "inline";;
  }
}
var dirname = location.pathname.match( /.*\// );    
function setSearchUserPref(){
  if ( document.cookie.indexOf( "ah_searchpref" ) > -1 ) {
    if ( document.cookie.indexOf( dirname ) > 0 ) {
      document.search.gsa.checked = true ;
    }else{
      document.search.gsa.checked = false ;            
    }
  }
}
YAHOO.util.Event.onDOMReady(initRoboHelpDOM);
YAHOO.util.Event.onDOMReady(setSearchUserPref);
// ]]-->
</script>

<!-- ********************************** -->
<!-- START: ForeSee survey code in: /ssi/globalheader.ssi -->

<script type="text/javascript">
<!-- 
// Enable the survey for only English, German and Japanese
var agt=navigator.userAgent.toLowerCase();
if ( agt.indexOf("community help client") == -1 ){
    if ( document.location.href.indexOf("/en_US/") != -1 ){
        showSurvey();
//    }else if (document.location.href.indexOf("/de_DE/") != -1){
//         var locale="de";
//         showSurvey();
    }else if (document.location.href.indexOf("/ja_JP/") != -1 ){
         var locale="ja";
         showSurvey();
    }	
}

function showSurvey(){
	document.write('<script type="text/javascript" src="/js/foresee/foresee-trigger.js"><\/scr'+'ipt>');
}

// -->
</script>

<!-- END: ForeSee survey code -->
<!-- ******************************** -->




    <link rel="stylesheet" type="text/css" href="tree.css" />
    <link rel="stylesheet" type="text/css" href="content.css" />
    <link rel="stylesheet" type="text/css" href="localeSpecific.css" />
  </head>
  <body id="content_body" onload="window.focus();">
    <a name="top" shape="rect"><!--LeaveCommentHere--></a>
    
    <div id="mnemonic">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon" class="ColdFusion"><div class="banner"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html">Adobe&#160;ColdFusion&#160;9</a><span id="notyourversion">|&#160;
                    <a rel="nofollow" href="http://www.adobe.com/support/documentation/en/coldfusion/">Not your version?</a></span></div></div><!--googleon: index-->
    </div>
    
    <div id="searchbar">
<table id="searchbartable">
<tr>
<td colspan="2">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon"><div id="pdf"><img src="images/PDF.gif" width="16" height="16" /><a title="View Help PDF" href="coldfusion_9_dev.pdf">View Help PDF ( 23MB)</a></div></div><!--googleon: index-->
</td>
</tr>
</table>
    </div>

<!-- BEGIN SEARCH CONTENT -->
<form id="search" name="search" action="search.html" target="_self">
<script type="text/javascript">
<!--[CDATA[
if ( !use_chc_behavior ){
    if (typeof(terms_AHV_SEARCH_CONSTRAINT) != "undefined" && 
        terms_AHV_SEARCH_CONSTRAINT.length > 0 && 
        document.location.href.indexOf(".adobe.com") > 0){
        if ( typeof(terms_SEARCH_THIS_HELP_ONLY) != "undefined" && terms_SEARCH_THIS_HELP_ONLY == "ON" ) {
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                checked="checked" \
                value="1" ><\/input>'); 
                
        // Leave the "Search this help system only" checkbox unckecked
        }else{    
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                value="1" ><\/input>'); 
        }
        document.write('<span class="gsalabel">' + terms_AHV_SEARCH_CONSTRAINT + '<\/span><\/div>'); 
    }
    document.write('<input class="searchinput" \
        name="q" \
        id="q" \
        type="text" \
        maxlength="256" \
        value="' + terms_AHV_SEARCH_BUTTON + '" \
        onclick="clearSearch()"><\/input><input \
        type="button" \
        name="searchbutton" \
        class="searchbutton" \
        onclick="submit()"><\/input>'); 
} 
 
/* 
 * Start Functions 
 */
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}

// set search preferences
function setAHSearchPref(){
    if (document.search.gsa.checked == 1){
        setAHSearchCookie( dirname );
    }else{
        setAHSearchCookie( "community" );
    }
}

// Set search preferences cookie
function setAHSearchCookie( p ){
    // set cookie ah_searchpref with a value of the document path
    var expire=new Date();
    expire.setDate(expire.getDate()+365); // Cookie expires after 1 year (365 days) 
    document.cookie="ah_searchpref=" +p+ "; expires=" +expire.toGMTString()+ ";";
}

// ]]-->
</script> 
 </form>
<!-- END SEARCH CONTENT -->    



<!-- BEGIN PAGE CONTENT WRAPPER -->
    <div id="page_content_wrapper">
<!-- BEGIN PAGE WRAPPER -->
<table id="page_content_table">
<tr>

<td id="col2">
<!-- BEGIN CONTENT WRAPPER -->
<!-- BEGIN BREADCRUMBS -->

      
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc3ff6d0ea77859461172e0811cbec0c09d-7fff.html" title="Creating and managing ColdFusion threads"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc3ff6d0ea77859461172e0811cbec0c09d-7feb.html" title="Working with threads"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Developing&#160;ColdFusion 9 Applications</b></a> / <a href="WS8f0cc78011fffa71-ea0996f11cdae56045-8000.html"><b>Developing CFML Applications</b></a> 
      / <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7f6a.html"><b>Using ColdFusion Threads</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
      <div id="content_wrapper">
<!-- BEGIN PAGE TITLE -->
        <h1>Using thread data</h1>
<!-- END PAGE TITLE -->
<!-- BEGIN IONCOMMENTCOUNT -->
        <div id="ionCount">
        </div>
<!-- END IONCOMMENTCOUNT -->
<table id="inner_content_table" width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td>
          <div style="border-top:#ccc solid 1px;"><p> </p>
          </div>
<p id="chcPromo" style="display:none;">
<a id="chcLink" href="http://www.adobe.com/support/chc/">
<img id="chcImage" src="http://www.adobe.com/support/chc/GetMoreHelpFeatures.png"/>
</a>
</p>
<script type="text/javascript" language="javascript" charset="utf-8">
<!--
var cfgArray = [];
//cfgArray["Acrobat_10.0_Professional.helpcfg"] = "acrobatpro";
//cfgArray["Acrobat_10.0_Standard.helpcfg"] = "acrobatstd";
cfgArray["Lightroom_3.0.helpcfg"] = "lightroom";
cfgArray["PhotoshopElements_8.0_Win.helpcfg"] = "photoshopelements";
cfgArray["PhotoshopElements_8.0_Mac.helpcfg"] = "photoshopelementsmac";
cfgArray["PremiereElements_8.0_Win.helpcfg"] = "premiereelements";

//cfgArray["AfterEffects_10.0.helpcfg"] = "aftereffects";
//cfgArray["AIR.helpcfg"] = "air";
//cfgArray["ColdFusionBuilder.helpcfg"] = "coldfusion";
//cfgArray["Contribute_6.0.helpcfg"] = "contribute";
//cfgArray["DeviceCentral_3.0.helpcfg"] = "devicecentral";
//cfgArray["Dreamweaver_11.0.helpcfg"] = "dreamweaver";
//cfgArray["EncoreDVD_5.0.helpcfg"] = "encore";
//cfgArray["ExtensionManager_3.0.helpcfg"] = "extension";
//cfgArray["Fireworks_11.0.helpcfg"] = "fireworks";
//cfgArray["Flash_11.0.helpcfg"] = "flash";
//cfgArray["Flex_4.0.helpcfg"] = "flashbuilder";
//cfgArray["FlashCatalyst_1.0.helpcfg"] = "flashcatalyst";
//cfgArray["Illustrator_15.0.helpcfg"] = "illustrator";
//cfgArray["InCopy_7.0.helpcfg"] = "incopy";
//cfgArray["InDesign_7.0.helpcfg"] = "indesign";
//cfgArray["OnLocation_5.0.helpcfg"] = "onlocation";
//cfgArray["Photoshop_12.0.helpcfg"] = "photoshop";
//cfgArray["PremierePro_5.0.helpcfg"] = "premierepro";

function getLangName() {
    var lang = "en-us";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if (ptn.test(lang)) {
        var languageCode = lang.replace(ptn, "$1");
        var countryCode = lang.replace(ptn, "$2");
        lang = languageCode + "_" + countryCode.toUpperCase();
    }
    return lang;
}

function getCountryName() {
    var lang = "";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if ((ptn.test(lang)) && (lang != "en-us")) {
        var countryCode = lang.replace(ptn, "$2");
        return "/" + countryCode;
    }
    return "";
}

if ( (typeof(terms_HELPCFG) != 'undefined')  && (terms_HELPCFG.indexOf(".helpcfg") != -1) ) {
    var stage   = (document.location.href.indexOf(".stage.") != -1) ? 'stage.' : '';
    var baseUrl = 'http://www.' + stage + 'adobe.com';
    var refpage = document.location.href.replace(/#.*$/, '');
	
	if ((!use_robohelp_behavior) && (terms_HELPCFG.length > 0) && (typeof(cfgArray[terms_HELPCFG]) != 'undefined') && (cfgArray[terms_HELPCFG].length > 0)) {
		if (document.getElementById) { // DOM3 = IE5, NS6
			var newHref = baseUrl + getCountryName() + "/support/chc/" + "?helpcfg=http://help." + stage + "adobe.com/HelpCfg/" + getLangName() + "/" + terms_HELPCFG + "&url=" + refpage + "&product=" + cfgArray[terms_HELPCFG];
			var newSrc = baseUrl + getCountryName() + "/support/chc/GetMoreHelpFeatures.png";
			document.getElementById("chcPromo").style.display = "block";
			document.getElementById("chcLink").href = newHref;
			document.getElementById("chcImage").src = newSrc;
		}
	}
}

//-->
</script>



          <div id="minitoc"><div class="t"><div class="b"><div><ul id="minitoc-links"><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0c09d-7ffe"><span class="topictitle1">Thread scopes</span>
</a></p><ul><li><p><a href="#WS2188B2D6-18F7-4433-89D5-A540BA5202B8"><span class="topictitle2">The thread-local scope</span>
</a></p></li><li><p><a href="#WS5B80208E-9E81-43c9-AFF0-5DF90D7BCA41"><span class="topictitle2">The Thread scope</span>
</a></p></li><li><p><a href="#WS9A712391-CBEF-44a9-AFD2-5937F0C613D1"><span class="topictitle2">The Attributes scope and thread attributes</span>
</a></p></li><li><p><a href="#WS723127D3-40A1-4220-94AB-200C8A6AB0BA"><span class="topictitle2">Using other scopes</span>
</a></p></li><li><p><a href="#WS5B90222F-066D-4bf3-938B-176D4BF09938"><span class="topictitle2">Scope precedence</span>
</a></p></li></ul></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec22c24-7cc7"><span class="topictitle1">Locking thread data and resource access</span>
</a></p></li><li><p><a href="#WSc3ff6d0ea77859461172e0811cbec0c09d-7ff4"><span class="topictitle1">Metadata variables</span>
</a></p></li></ul></div></div></div></div><div><p>Because multiple threads can process simultaneously within
a single request, applications must ensure that data from one thread
does not improperly affect data in another thread. ColdFusion provides
several scopes that you can use to manage thread data, and a request-level
lock mechanism that you use to prevent problems caused by threads
that access page-level data. ColdFusion also provides metadata variables
that contain any thread-specific output and information about the
thread, such as its status and processing time. </p>
</div>
<div id="WSc3ff6d0ea77859461172e0811cbec0c09d-7ffe" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0c09d-7ffe"><!-- --></a><h2 class="topictitle2">Thread scopes</h2><div><p>Each thread
has three special scopes: </p>
<ul><li><p>The thread-local scope</p>
</li>
<li><p>The Thread scope</p>
</li>
<li><p>The Attributes scope</p>
</li>
</ul>
</div><div id="WS2188B2D6-18F7-4433-89D5-A540BA5202B8" class="nochunk"><a name="WS2188B2D6-18F7-4433-89D5-A540BA5202B8"><!-- --></a><h3 class="topictitle3">The thread-local scope</h3><div><p>The thread-local scope is an implicit scope that contains
variables that are available only to the thread, and exist only
for the life of the thread. Any variable that you define inside
the <samp class="codeph">cfthread</samp> tag body without specifying a scope
name prefix is in the thread local scope and cannot be accessed
or modified by other threads.</p>
<p>To create a thread-local variable, assign the variable in the <samp class="codeph">cfthread</samp> tag
body without specifying a scope prefix, as in the following lines: </p>
<pre>&lt;cfset var index=1&gt; 
&lt;cfset index=1&gt;</pre>
<p>These two lines are equivalent, with one exception: If you use
the <samp class="codeph">var</samp> keyword, the assignment code <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">must</i> immediately
follow the <samp class="codeph">cfthread</samp> tag, before any other CFML
tags.</p>
</div></div><div id="WS5B80208E-9E81-43c9-AFF0-5DF90D7BCA41" class="nochunk"><a name="WS5B80208E-9E81-43c9-AFF0-5DF90D7BCA41"><!-- --></a><h3 class="topictitle3">The Thread scope</h3><div><p>The Thread scope contains thread-specific variables and
metadata about the thread. Only the owning thread can write data
to this scope, but the page thread and all other threads in a request
can read the variable values in this scope. Thread scope data remains
available until the page and all threads that started from the page
finish, even if the page finishes before the threads complete processing.</p>
<p>To create a Thread scope variable, in the <samp class="codeph">cfthread</samp> tag
body, use the keyword <samp class="codeph">Thread</samp> or the name of the
thread (for example, <samp class="codeph">myThread</samp>) as a prefix. the following
examples of creating a Thread scope variable are equivalent:</p>
<pre>&lt;cfset Thread.myValue = 27&gt; 
&lt;cfset myThread.myValue = 27&gt;</pre>
<p>To access a thread’s Thread scope variables outside the thread,
prefix the variable with the thread’s name, as in the following
example:</p>
<pre>&lt;cfset nextValue=myThread.myValue + 1&gt;</pre>
<p>Thread scope variables are only available to the page that created
the thread or to other threads created by that page. No other page
can access the data. If one page must access another page’s Thread
scope data, you must place the data in a database or file and access
it from there. </p>
<p>The Thread scope of each thread is a subscope of a special scope,
cfthread, that lasts as long as the request, or until the last thread
that it starts completes, whichever is longer. Thus, if you have
two threads, myThread1 and myThread2, you can access their Thread
scopes as cfthread.myThread1 and cfthread.myThread2 until all threads
and the request complete. In most cases, there is no need to use
the <samp class="codeph">cfthread</samp> scope directly. However, you can use
the cfthread scope name in either of the following situations:</p>
<ol><li><p>If you generate the thread name dynamically, you can
avoid using the <samp class="codeph">Evaluate</samp> function by using the <samp class="codeph">cfthread</samp> scope
with associative array notation, as the following code snippet shows:</p>
<pre>&lt;cfset threadname="thread_#N#"&gt; 
... 
&lt;!--- The following two lines are equivalent ---&gt; 
&lt;cfset threadscopeForNthThread = cfthread[threadname] &gt; 
&lt;cfset threadscopeForNthThread = Evaluate(threadname) &gt;</pre>
</li>
<li><p>If you have a thread with the same name as a Variables scope
variable, you can access that thread’s Thread scope only by prefacing
the Thread name with <samp class="codeph">cfthread</samp>. Otherwise, you access
the Variables scope variable, or get an error.</p>
</li>
</ol>
</div></div><div id="WS9A712391-CBEF-44a9-AFD2-5937F0C613D1" class="nochunk"><a name="WS9A712391-CBEF-44a9-AFD2-5937F0C613D1"><!-- --></a><h3 class="topictitle3">The Attributes scope and thread attributes</h3><div><p>The Attributes scope contains attributes that are passed
to the thread, either individually or in the <samp class="codeph">attributeCollection</samp> attribute.
The Attributes scope is available only within the thread and only
for the life of the thread.</p>
<p>ColdFusion makes a complete (deep) copy of all the attribute
variables before passing them to the thread; therefore, the values
of the variables inside the thread are independent of the values
of any corresponding variables in other threads, including the page
thread. For example, if you pass a CFC instance as an attribute
to a thread, the thread gets a complete new copy of the CFC, including the
contents of its This scope at the time that you create the thread.
Any changes made to the original CFC outside the thread, for example,
by calling a CFC function, have no effect on the copy that is in
the thread. Similarly, any changes to the CFC instance in the thread
have no effect on the original CFC instance.</p>
<p>Copying the data ensures that the values passed to threads are
thread-safe, because the attribute values cannot be changed by any
other thread. If you do not want duplicate data, do not pass it
to the thread as an attribute or in the <samp class="codeph">attributeCollection</samp> attribute.
Instead, keep the data in a scope that the thread can access. An
example of an object that should not be passed to the thread as
an attribute is a singleton CFC that should never be duplicated.
The singleton CFC must be kept in some shared scope and accessed
by threads. For more information, see the <a href="WS723127D3-40A1-4220-94AB-200C8A6AB0BA.html">Using other scopes</a>.</p>
<p>Because ColdFusion copies all attributes by value, you can have
multiple threads, for example, threads created dynamically in a
loop, that use the same attribute names, but where each thread gets
a different value, as shown in the following code excerpt, which
creates separate threads to copy each of several files in a directory:</p>
<pre>&lt;cfloop query="dir"&gt; 
    &lt;cfset threadname = "thread_" &amp; #i#&gt; 
    &lt;cfset i=i+1&gt; 
    &lt;cfthread name="#threadname#" filename="#dir.name#"&gt; 
        &lt;cffile action="COPY" source="#src#\#filename#" 
            destination="#dest#\#filename#\"&gt; 
    &lt;/cfthread&gt; 
&lt;/cfloop&gt;</pre>
</div></div><div id="WS723127D3-40A1-4220-94AB-200C8A6AB0BA" class="nochunk"><a name="WS723127D3-40A1-4220-94AB-200C8A6AB0BA"><!-- --></a><h3 class="topictitle3">Using other scopes</h3><div><p>Threads have access to all the ColdFusion scopes. All the
threads run by a page share the same Variables and This scope. All
the threads run in a request share the same Form, URL, Request,
CGI, Cookie, Session, Application, Server and Client scopes. Be
careful to lock access to these scopes if more than one thread could try
to modify the data in the scopes; otherwise you can get deadlocks
between threads. For more information, see <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7cc7.html">Locking thread data and resource access</a>.</p>
<p>Although a thread can access all the scopes, it might not be
able to write to scopes like Session, Cookie, or Request after the
request page processing completes.</p>
</div></div><div id="WS5B90222F-066D-4bf3-938B-176D4BF09938" class="nochunk"><a name="WS5B90222F-066D-4bf3-938B-176D4BF09938"><!-- --></a><h3 class="topictitle3">Scope precedence</h3><div><p>If you
do not specify a scope prefix on a variable inside a <samp class="codeph">cfthread</samp> tag
body, ColdFusion checks scopes in the following order to find the
variable:</p>
<ol><li><p>Function-local, in function definitions in the thread
only</p>
</li>
<li><p>Thread-local</p>
</li>
<li><p>Attributes</p>
</li>
<li><p>Variables</p>
</li>
<li><p>Thread/cfthread</p>
</li>
</ol>
<p>Other scopes are checked in the standard scope checking order.</p>
</div></div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec22c24-7cc7" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec22c24-7cc7"><!-- --></a><h2 class="topictitle2">Locking thread data and resource access</h2><div><p>When an
application uses multiple threads, be careful to ensure that the
threads do not simultaneously attempt to use or modify shared resources
that are not themselves thread-safe, including the following items:</p>
<ul><li><p>If multiple threads modify a Variables or Request scope
variable, use a Request scope lock to control access to the code
that uses the variable to prevent deadlocks and race conditions.
Similarly, use a Request scope lock around code that accesses built-in
data structures or subscopes of the Variables scope, such as the
Forms variable, that you change in multiple threads.</p>
</li>
<li><p>Multiple threads should not try to access any other shared
resource simultaneously. For example, do not use the same FTP connection
from multiple threads. To prevent this behavior, place the code
that uses the resource in named <samp class="codeph">cflock</samp> tags. Use
the same <samp class="codeph">name</samp> attribute for all <samp class="codeph">cflock</samp> tags around
code that uses a specific resource.</p>
</li>
</ul>
<p>For more information on locking code, see <samp class="codeph"><a href="http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7f5d.html" target="_self">cflock</a></samp> and <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7cc4.html">Locking code with cflock</a>.</p>
</div></div>
<div id="WSc3ff6d0ea77859461172e0811cbec0c09d-7ff4" class="nochunk"><a name="WSc3ff6d0ea77859461172e0811cbec0c09d-7ff4"><!-- --></a><h2 class="topictitle2">Metadata variables</h2><div><p>The Thread scope contains the following variables that
provide information about the thread, called metadata. </p>

<div class="tablenoborder"><table border="1" cellpadding="4" cellspacing="0"><thead align="left"><tr><th valign="top" width="NaN%" id="d17e34115"><p>Variable</p>
</th>
<th valign="top" width="NaN%" id="d17e34118"><p>Description</p>
</th>
</tr>
</thead>
<tbody><tr><td valign="top" width="NaN%" headers="d17e34115 "><p>Elapsedtime</p>
</td>
<td valign="top" width="NaN%" headers="d17e34118 "><p>The amount of processor time that has been
spent handling the thread.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e34115 "><p>Error</p>
</td>
<td valign="top" width="NaN%" headers="d17e34118 "><p>A ColdFusion error structure that contains
the keys that you can access in a <samp class="codeph">cfcatch</samp> tag.
This variable has a value only if an unhandled error occurred during
thread processing. For information on handling thread errors, see <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7cc5.html">Handling ColdFusion thread errors</a>.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e34115 "><p>Name</p>
</td>
<td valign="top" width="NaN%" headers="d17e34118 "><p>The thread name.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e34115 "><p>Output </p>
</td>
<td valign="top" width="NaN%" headers="d17e34118 "><p>Output text that the thread generates. Threads
cannot display output directly. For more information see <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7cc2.html">Handling thread output</a>.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e34115 "><p>Priority</p>
</td>
<td valign="top" width="NaN%" headers="d17e34118 "><p>The thread processing priority, as specified
when you created the thread.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e34115 "><p>Starttime</p>
</td>
<td valign="top" width="NaN%" headers="d17e34118 "><p>The time at which the thread began processing.</p>
</td>
</tr>
<tr><td valign="top" width="NaN%" headers="d17e34115 "><p>Status</p>
</td>
<td valign="top" width="NaN%" headers="d17e34118 "><p>The current status of the thread. For information
on using the Status in an application, see <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7cc1.html">Using the thread status</a>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>As with other variables in the Thread scope, thread metadata
is available to all of a page’s threads by specifying the thread
name as a variable prefix. For example, the page thread can get
the current elapsed time of the myThread1 thread from the <samp class="codeph">myThread1.ElapsedTime</samp> variable.</p>
<p>The metadata is available from the time that you create the thread
until the time when the page and all threads started on the page
complete processing, even if the page finishes before the threads
finish. This way, you can get thread output, error information,
and processing information during and after the time when the thread
is processing.</p>
</div></div>


<!-- BEGIN USER PREFERENCES -->
          <div id="userprefs">
          </div>
<!-- END USER PREFERENCES -->

          <div id="related">
            
            
            <div class="separator"><a href="#top"><img src="images/BTT.jpg" /></a>&#160;</div>
          </div>
          <div id="footer">
<!-- BEGIN IONCOMMENTS -->
            <div id="ionComHere">
            </div>
<!-- END IONCOMMENTS -->


            <p id="creativecommons"><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text"><img id="creativecommons_img" src="images/CC.png" alt="This work is licensed under a Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License" /></a>&nbsp;Twitter™ and Facebook posts are not covered under the terms of Creative Commons.</p>
          </div>
</td>
<td width="10px"></td>
<td id="inner_rightcolumn">

</td></tr></table>
      </div>
<!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSc3ff6d0ea77859461172e0811cbec0c09d-7fff.html" title="Creating and managing ColdFusion threads"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WSc3ff6d0ea77859461172e0811cbec0c09d-7feb.html" title="Working with threads"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Developing&#160;ColdFusion 9 Applications</b></a> / <a href="WS8f0cc78011fffa71-ea0996f11cdae56045-8000.html"><b>Developing CFML Applications</b></a> 
      / <a href="WSc3ff6d0ea77859461172e0811cbec22c24-7f6a.html"><b>Using ColdFusion Threads</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
<!-- END CONTENT WRAPPER -->

</td>
<td id="col3">
    <div>
        <img src="images/adobe-lq.png" />
    </div>
</td>
</tr>
</table>
    </div>
<!-- END PAGE CONTENT WRAPPER -->
<script type="text/javascript">
<!--[CDATA[
scrollToNameAnchor();
// ]]-->
</script> 
<!--
    Description:
    This file generates the link to product support in the top right corner
-->

<style>
#menutop{
    position:absolute;
    top:4px;
    right:24px;
    width:auto;    
    font-size:11px;
    color:#fff;
    text-align:right;
}
#menutop a{
    color:#fff;
}
#menutop a:hover{
        text-decoration:underline;
}
</style>  
  
  
  
  
<div id="productmenu">
<!--googleoff: index-->
  <div id="menutop">


<script language=javascript type='text/javascript'>
    // darken menu text for products with light backgrounds
    var path = document.location.href.toLowerCase();
    if (path.indexOf("/acrobat/")           	> 0 ||
        path.indexOf("/acrobat.com/")       	> 0 ||
        path.indexOf("/acrobatConnectPro/") 	> 0 ||
        path.indexOf("/connect/")           	> 0 ||
        path.indexOf("/livecycledataserviceses/") > 0 ||
        path.indexOf("/muse/")         	> 0 ||
	path.indexOf("/presenter/")         	> 0 ||
        path.indexOf("/scene7/")            	> 0 ||
        path.indexOf("/flashmediaserver/")  	> 0 ||
        path.indexOf("/wave/")              	> 0 )
    {
        document.write('<style>#menutop a{color:#505050}</style>');
    }
    if (typeof('terms_AHV_PRODUCT_SUPPORT') != "undefined" && ! use_robohelp_behavior ){      
        if (path.indexOf("/muse/") > -1 ){
            var supportlink = '<a href="http://muse.adobe.com/support.html">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }else{
            var supportlink = '<a href="http://adobe.com/support">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }
        document.write( supportlink );
     }

</script> 

  </div>
<!--googleon: index-->
</div>



<style>
#online-privacy-policy{ 
    margin:10px 40px; 
    font-size:11px;
}
</style>

<p id="online-privacy-policy">
<script language="javascript">
var pageLoc = "en_US";
var metaElements = document.all ?
document.all.tags('meta') :
document.getElementsByTagName ?
document.getElementsByTagName ('meta') : new Array();
for (var m = 0; m < metaElements.length; m++) {
	if (metaElements[m].name == "lang") {
		pageLoc = metaElements[m].content;
		break;
	}
}
var ptn = /(..)-(..)/;
if (ptn.test(pageLoc)) {
	var languageCode = pageLoc.replace(ptn, "$1");
	var countryCode = pageLoc.replace(ptn, "$2");
	pageLoc = languageCode + "_" + countryCode.toUpperCase();
}

var policyLoc = "en_US";
var policyText = "Online Privacy Policy";
var policyPath = "";
var policyArray=[
"da_DK", "Online fortrolighedserklæring",
"de_DE", "Online-Datenschutzrichtlinie",
"es_ES", "Política de confidencialidad en línea",
"fi_FI", "Yksityisyyttä koskeva Online-toimintaohjelma",
"fr_FR", "Confidentialité et sécurité",
"it_IT", "Informativa sulla privacy online",
"ja_JP", "プライバシーポリシー",
"ko_KR", "Adobe 온라인 개인정보 보호정책",
"pt_BR", "Política de Confidencialidade On-line", 
"zh_CN", "在线隐私政策",
"zh_TW", "線上隱私政策"
];
var legalLoc = "en_US";
var legalText = "Legal Notices";
var legalPath = legalLoc;
var legalArray=[
"ar_AE", "إشعارات قانونية",
"bg_BG", "Юридически бележки",
"cs_CZ", "Právní upozornění",
"da_DK", "Juridiske meddelelser",
"de_DE", "Rechtliche Hinweise",
"el_GR", "Σημειώσεις νομικού περιεχομένου",
"es_ES", "Avisos legales",
"et_EE", "Juriidilised teated",
"fi_FI", "Lakisääteiset ilmoitukset",
"fr_FR", "Mentions légales",
"he_IL", "הצהרות משפטיות",
"hr_HR", "Pravne napomene",
"hu_HU", "Jogi közlemények",
"it_IT", "Informazioni legali",
"ja_JP", "法律上の注意",
"ko_KR", "법적 고지 사항",
"lt_LT", "Teisinės pastabos",
"lv_LV", "Juridisks paziņojums",
"nb_NO", "Juridiske merknader",
"nl_NL", "Juridische kennisgevingen",
"pl_PL", "Informacje prawne",
"pt_BR", "Aspectos jurídicos",
"ro_RO", "Prevederi legale",
"ru_RU", "Юридическая информация",
"sk_SK", "Právne upozornenie",
"sl_SI", "Pravni pouk",
"sv_SE", "Upphovsrätt",
"tr_TR", "Yasal uyarılar",
"uk_UA", "Юридична інформація",
"zh_CN", "法律声明",
"zh_TW", "法律注意事項"
];

ruPolicy = "http://www.adobe.com/ru/misc/privacy.html";
trPolicy = "http://www.adobe.com/tr/misc/privacy.html";

// Bug 2846992: LOC: RUS, TUR: The link to "Online Privacy Policy" should include language, currently it is not appearing.
if (pageLoc == "ru_RU") {
	policyPath = "ru";
}
else if (pageLoc == "tr_TR") {
	policyPath = "tr";
}
for (var i = 0; i < policyArray.length; i+=2) {
	if (pageLoc == policyArray[i]) {
		policyLoc = pageLoc;
		policyText = policyArray[i+1];
		var ptn = /(..)_(..)/;
		if (ptn.test(policyLoc)) {
			var countryCode = policyLoc.replace(ptn, "$2");
			policyPath = countryCode.toLowerCase();
		}
		break;
	}
}

for (var i = 0; i < legalArray.length; i+=2) {
	if (pageLoc == legalArray[i]) {
		legalLoc = pageLoc;
		legalText = legalArray[i+1];
		legalPath = legalLoc;
		break;
	}
}
if(agt.indexOf("community help client") > -1 ){
	document.write('<a href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
}else{
	//Open the privacy policy in a new window
	document.write('<a target="_blank" href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a target="_blank" href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
} 
</script>
</p>



<!-- localfooter.ssi -->

<script type="text/javascript">
    var debug = (top.location.href.indexOf("debug=true") > -1);
</script>

<script language="javascript">
document.write('<scr'+'ipt ' +
               'src="/en_US/ssi/_pod.js" ' +
               'language="javascript" ' +
               'charset="UTF-8"> ' +
               '</scr'+'ipt>');
</script>


<script type="text/javascript">
//
//  Ethnio survey code
//
/*          DocumentID      EthnioID */
/*          -------------   -------- */
var ethnio=["/en_US/flash/cs/using/WSb03e830bd6f770ee6664507612436d7dede-8000.html", "87462",
            "/en_US/creativesuite/cs/using/WSe851854fd1e0856a-4b08a77612477f69f15-8000.html",  "10441",
            "/en_US/dreamweaver/cs/using/WSEE4C0148-A6F4-4bf5-9DEF-CE06AB026214a.html",  "57412"
 
    ];
                        
    for ( var i = 0; i < ethnio.length ; i = i+2 ){
        if ( document.location.href.indexOf( ethnio[i] ) > -1 ){ 
            var headID = document.getElementsByTagName("head")[0];         
            var ethnioScript = document.createElement('script');
            ethnioScript.type = 'text/javascript';
            ethnioScript.src = 'http://ethn.io/remotes/' + ethnio[i+1];        
            if ( debug ){
                alert ("Using Ethnio script: " + ethnioScript.src );
            }else{
                headID.appendChild(ethnioScript);
            }
        }
    }
</script>



<div style="display: none;">
<!-- SiteCatalyst -->
<script language="JavaScript" type="text/javascript"><!--
var s_code=' ';
var s_docHost = window.location.hostname.toLowerCase();
var s_docURL = window.location.pathname.toLowerCase();
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
if (s_docHost.indexOf(".corp.adobe") != -1 || s_docHost.indexOf("stage.") != -1 || s_docHost.indexOf(".dev.adobe") != -1 || s_docHost.indexOf("staging.") != -1) scJsHost="";
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/omniture_s_code.js' type='text/javascript'%3E%3C/script%3E"));
//--></script>
<script type="text/javascript"><!--
var s_accountName;
s_server="www.adobe.com static content pages";
if (!window.s_account) s_accountName="mxmacromedia";
else s_accountName=window.s_account;

if (window.s_docURL.indexOf("/designcenter/") != -1)
  s_channel="Adobe Design Center";	
else if ((window.s_docHost.indexOf("labs.adobe") != -1) ||
(window.s_docHost.indexOf("labs-staging.") != -1))
  s_channel="Labs";
else if (window.s_docHost.indexOf("help.adobe.com") != -1) {
  s_channel="Support Help.adobe.com";
  if (window.s_docURL.indexOf("/en_us/") == -1) {
    s_docURLArray=s_docURL.split('/');
    s_pageName="http://help.adobe.com/"+s_docURLArray[1]+"/"+ s_docURLArray[2]+"/"+s_docURLArray[3];
    s_prop23="http://help.adobe.com"+window.location.pathname;
  }
}
else if (window.s_docHost.indexOf("kb2.adobe.com") != -1) {
  s_channel="Support Knowledgebase";
  s_prop23="http://kb2.adobe.com"+s_docURL+":";
  if (typeof(omtrProductList) != 'undefined' && omtrProductList.length > 0)
 {
    s_prop23=s_prop23+omtrProductList;
  }
}
else if (window.s_docHost.indexOf("resellers.adobe.com") != -1) {
		var s_pageName=document.getElementsByTagName("title")[0].text;
}

if (!window.scMMInclude) {
	var s_wd=window,s_tm=new Date;
	if(s_code!=' '){
		s_code=s_dc(s_accountName);
		if(s_code)document.write(s_code)
	} 
} else {
	s_wds(s_accountName);s_ca(s_accountName); 
}	

function sendAnalyticsEvent(str){var ns=s_accountName;if(str!=null)ns+=","+str;void(s_gs(ns));}
function sendLinkEvent(accnt,lnkname,type){
accnt=s_accountName;s_linkType=type;s_lnk=true;s_linkName=lnkname;void(s_gs(accnt));}
//--></script>
<noscript><img src="http://stats.adobe.com/b/ss/mxmacromedia/1/H.15-XELvs/0?pageName=http%3A//www.adobe.com%3A%20noscript&ch=http%3A//www.adobe.com%3A%20noscript&g=http%3A//www.adobe.com" height="1" width="1" border="0" alt="" /></noscript>
<!-- End SiteCatalyst -->
</div>

<script language="JavaScript" type="text/javascript">//<![CDATA[
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/atm/s_code_www.js' type='text/javascript'%3E%3C/script%3E"));
//]]></script>
<script type="text/javascript">//<![CDATA[
if(s_adobe){	
	s_adobe.server="www.adobe.com Static Content pages";
	/* Set pageName */
	s_adobe.s_URL="adobe.com"+((location.pathname.charAt(0)=='/')?location.pathname:'/'+location.pathname);
	if (s_adobe.s_URL.substring(s_adobe.s_URL.lastIndexOf('/')+1)=="") s_adobe.s_URL=s_adobe.s_URL+"index.html";
	s_adobe.s_URLSplit=s_adobe.s_URL.split("/");
	s_adobe.pageName=s_adobe.s_URLSplit.join(":");

	/* Set prop4 to language-locale */
	var s_meta=document.getElementsByTagName('meta'); 
      for (i=0; i<s_meta.length; i++) { 
        if (s_meta[i].getAttribute("http-equiv") == "Content-Language") { 
          s_adobe.prop4=s_meta[i].getAttribute("content"); 
	    s_adobe.prop4=s_adobe.prop4.replace(/\s+/g,'');
        } 
      } 
	s_adobe.t()
}
//]]></script>








  </body>
</html>