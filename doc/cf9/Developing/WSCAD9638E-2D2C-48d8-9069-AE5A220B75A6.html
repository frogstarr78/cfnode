<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0022)http://help.adobe.com/ -->
<html lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="lang" content="en-us" />
    <meta name="area" content="livedocs" />
    <title>Adobe&#160;ColdFusion&#160;9 * Caching</title>
    <link rel="shortcut icon" href="images/ColdFusionLinkIndicator.png" />
    <meta name="book" content="Developing&#160;ColdFusion 9 Applications" />
    <meta name="product" content="ColdFusion" />
    <meta name="keywords" content="" /><!--<PageMap><DataObject type="document"><Attribute name="product" value="ColdFusion"></Attribute><Attribute name="book" value="Developing&#160;ColdFusion 9 Applications"></Attribute><Attribute name="keywords" value=""></Attribute></DataObject></PageMap>-->
    
    <script type="text/javascript" language="Javascript" charset="UTF-8"><!--[CDATA[
        var currentTreeNode = "WSCAD9638E-2D2C-48d8-9069-AE5A220B75A6.html";
    document.cookie = "topicId=" + "WSCAD9638E-2D2C-48d8-9069-AE5A220B75A6.html";
// ]]--></script>
<script src="terms.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="help.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script>  <script src="utilities.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="event.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="treeview.js" type="text/javascript" language="Javascript" charset="UTF-8">...</script> <script src="toc.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script> <script src="swfobject.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>  <script src="booklist.js" language="Javascript" type="text/javascript" charset="UTF-8">..</script>
<script type="text/javascript">
<!--[CDATA[
var topictype = "topic";
var headId = document.getElementsByTagName("head")[0];         
if (use_ie_6_behavior) {
  var linkId = document.createElement("link");
  linkId.href = "content-ie6.css";
  linkId.rel = "stylesheet";
  linkId.type = "text/css";
  headId.appendChild(linkId);
}
function initRoboHelpDOM() {
  if (use_chm_behavior) {
    hideElement("search");
  }
  if (use_robohelp_behavior) {
    hideElement("search");
    hideElement("productmenu");
    //hideElement("notyourversion");
  }
  if(!use_chc_behavior) {
    //document.getElementById("notyourversion").style.display = "inline";;
  }
}
var dirname = location.pathname.match( /.*\// );    
function setSearchUserPref(){
  if ( document.cookie.indexOf( "ah_searchpref" ) > -1 ) {
    if ( document.cookie.indexOf( dirname ) > 0 ) {
      document.search.gsa.checked = true ;
    }else{
      document.search.gsa.checked = false ;            
    }
  }
}
YAHOO.util.Event.onDOMReady(initRoboHelpDOM);
YAHOO.util.Event.onDOMReady(setSearchUserPref);
// ]]-->
</script>

<!-- ********************************** -->
<!-- START: ForeSee survey code in: /ssi/globalheader.ssi -->

<script type="text/javascript">
<!-- 
// Enable the survey for only English, German and Japanese
var agt=navigator.userAgent.toLowerCase();
if ( agt.indexOf("community help client") == -1 ){
    if ( document.location.href.indexOf("/en_US/") != -1 ){
        showSurvey();
//    }else if (document.location.href.indexOf("/de_DE/") != -1){
//         var locale="de";
//         showSurvey();
    }else if (document.location.href.indexOf("/ja_JP/") != -1 ){
         var locale="ja";
         showSurvey();
    }	
}

function showSurvey(){
	document.write('<script type="text/javascript" src="/js/foresee/foresee-trigger.js"><\/scr'+'ipt>');
}

// -->
</script>

<!-- END: ForeSee survey code -->
<!-- ******************************** -->




    <link rel="stylesheet" type="text/css" href="tree.css" />
    <link rel="stylesheet" type="text/css" href="content.css" />
    <link rel="stylesheet" type="text/css" href="localeSpecific.css" />
  </head>
  <body id="content_body" onload="window.focus();">
    <a name="top" shape="rect"><!--LeaveCommentHere--></a>
    
    <div id="mnemonic">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon" class="ColdFusion"><div class="banner"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html">Adobe&#160;ColdFusion&#160;9</a><span id="notyourversion">|&#160;
                    <a rel="nofollow" href="http://www.adobe.com/support/documentation/en/coldfusion/">Not your version?</a></span></div></div><!--googleon: index-->
    </div>
    
    <div id="searchbar">
<table id="searchbartable">
<tr>
<td colspan="2">
      <!--googleoff: index--><div xmlns:adobe="http://www.adobe.com/saxon"><div id="pdf"><img src="images/PDF.gif" width="16" height="16" /><a title="View Help PDF" href="coldfusion_9_dev.pdf">View Help PDF ( 23MB)</a></div></div><!--googleon: index-->
</td>
</tr>
</table>
    </div>

<!-- BEGIN SEARCH CONTENT -->
<form id="search" name="search" action="search.html" target="_self">
<script type="text/javascript">
<!--[CDATA[
if ( !use_chc_behavior ){
    if (typeof(terms_AHV_SEARCH_CONSTRAINT) != "undefined" && 
        terms_AHV_SEARCH_CONSTRAINT.length > 0 && 
        document.location.href.indexOf(".adobe.com") > 0){
        if ( typeof(terms_SEARCH_THIS_HELP_ONLY) != "undefined" && terms_SEARCH_THIS_HELP_ONLY == "ON" ) {
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                checked="checked" \
                value="1" ><\/input>'); 
                
        // Leave the "Search this help system only" checkbox unckecked
        }else{    
            document.write('<div id="searchscope"> \
                <input onchange="setAHSearchPref();" \
                class="gsa" \
                name="gsa" \
                id="gsa" \
                type="checkbox" \
                value="1" ><\/input>'); 
        }
        document.write('<span class="gsalabel">' + terms_AHV_SEARCH_CONSTRAINT + '<\/span><\/div>'); 
    }
    document.write('<input class="searchinput" \
        name="q" \
        id="q" \
        type="text" \
        maxlength="256" \
        value="' + terms_AHV_SEARCH_BUTTON + '" \
        onclick="clearSearch()"><\/input><input \
        type="button" \
        name="searchbutton" \
        class="searchbutton" \
        onclick="submit()"><\/input>'); 
} 
 
/* 
 * Start Functions 
 */
function clearSearch(){
    if (document.search.q.value == terms_AHV_SEARCH_BUTTON){document.search.q.value = ""}; 
}

// set search preferences
function setAHSearchPref(){
    if (document.search.gsa.checked == 1){
        setAHSearchCookie( dirname );
    }else{
        setAHSearchCookie( "community" );
    }
}

// Set search preferences cookie
function setAHSearchCookie( p ){
    // set cookie ah_searchpref with a value of the document path
    var expire=new Date();
    expire.setDate(expire.getDate()+365); // Cookie expires after 1 year (365 days) 
    document.cookie="ah_searchpref=" +p+ "; expires=" +expire.toGMTString()+ ";";
}

// ]]-->
</script> 
 </form>
<!-- END SEARCH CONTENT -->    



<!-- BEGIN PAGE CONTENT WRAPPER -->
    <div id="page_content_wrapper">
<!-- BEGIN PAGE WRAPPER -->
<table id="page_content_table">
<tr>

<td id="col2">
<!-- BEGIN CONTENT WRAPPER -->
<!-- BEGIN BREADCRUMBS -->

      
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSE01EDE03-6E6B-4669-8C54-358460778450.html" title="Lazy Loading"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WS00180FBE-6DE0-43f0-84CB-DCE04A9FCCA4.html" title="ORM session management"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Developing&#160;ColdFusion 9 Applications</b></a> / <a href="WSD628ADC4-A5F7-4079-99E0-FD725BE9B4BD.html"><b>ColdFusion ORM</b></a> 
      / <a href="WSE08CDAD8-3A58-4b77-B035-EA88C963A8D5.html"><b>Performance optimization</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
      <div id="content_wrapper">
<!-- BEGIN PAGE TITLE -->
        <h1>Caching</h1>
<!-- END PAGE TITLE -->
<!-- BEGIN IONCOMMENTCOUNT -->
        <div id="ionCount">
        </div>
<!-- END IONCOMMENTCOUNT -->
<table id="inner_content_table" width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td>
          <div style="border-top:#ccc solid 1px;"><p> </p>
          </div>
<p id="chcPromo" style="display:none;">
<a id="chcLink" href="http://www.adobe.com/support/chc/">
<img id="chcImage" src="http://www.adobe.com/support/chc/GetMoreHelpFeatures.png"/>
</a>
</p>
<script type="text/javascript" language="javascript" charset="utf-8">
<!--
var cfgArray = [];
//cfgArray["Acrobat_10.0_Professional.helpcfg"] = "acrobatpro";
//cfgArray["Acrobat_10.0_Standard.helpcfg"] = "acrobatstd";
cfgArray["Lightroom_3.0.helpcfg"] = "lightroom";
cfgArray["PhotoshopElements_8.0_Win.helpcfg"] = "photoshopelements";
cfgArray["PhotoshopElements_8.0_Mac.helpcfg"] = "photoshopelementsmac";
cfgArray["PremiereElements_8.0_Win.helpcfg"] = "premiereelements";

//cfgArray["AfterEffects_10.0.helpcfg"] = "aftereffects";
//cfgArray["AIR.helpcfg"] = "air";
//cfgArray["ColdFusionBuilder.helpcfg"] = "coldfusion";
//cfgArray["Contribute_6.0.helpcfg"] = "contribute";
//cfgArray["DeviceCentral_3.0.helpcfg"] = "devicecentral";
//cfgArray["Dreamweaver_11.0.helpcfg"] = "dreamweaver";
//cfgArray["EncoreDVD_5.0.helpcfg"] = "encore";
//cfgArray["ExtensionManager_3.0.helpcfg"] = "extension";
//cfgArray["Fireworks_11.0.helpcfg"] = "fireworks";
//cfgArray["Flash_11.0.helpcfg"] = "flash";
//cfgArray["Flex_4.0.helpcfg"] = "flashbuilder";
//cfgArray["FlashCatalyst_1.0.helpcfg"] = "flashcatalyst";
//cfgArray["Illustrator_15.0.helpcfg"] = "illustrator";
//cfgArray["InCopy_7.0.helpcfg"] = "incopy";
//cfgArray["InDesign_7.0.helpcfg"] = "indesign";
//cfgArray["OnLocation_5.0.helpcfg"] = "onlocation";
//cfgArray["Photoshop_12.0.helpcfg"] = "photoshop";
//cfgArray["PremierePro_5.0.helpcfg"] = "premierepro";

function getLangName() {
    var lang = "en-us";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if (ptn.test(lang)) {
        var languageCode = lang.replace(ptn, "$1");
        var countryCode = lang.replace(ptn, "$2");
        lang = languageCode + "_" + countryCode.toUpperCase();
    }
    return lang;
}

function getCountryName() {
    var lang = "";
    var metaElements = document.all ?
            document.all.tags('meta') :
            document.getElementsByTagName ?
            document.getElementsByTagName ('meta') : new Array();
    for (var m = 0; m < metaElements.length; m++) {
        if (metaElements[m].name == "lang") {
            lang = metaElements[m].content;
            break;
        }
    }
    var ptn = /(..)-(..)/;
    if ((ptn.test(lang)) && (lang != "en-us")) {
        var countryCode = lang.replace(ptn, "$2");
        return "/" + countryCode;
    }
    return "";
}

if ( (typeof(terms_HELPCFG) != 'undefined')  && (terms_HELPCFG.indexOf(".helpcfg") != -1) ) {
    var stage   = (document.location.href.indexOf(".stage.") != -1) ? 'stage.' : '';
    var baseUrl = 'http://www.' + stage + 'adobe.com';
    var refpage = document.location.href.replace(/#.*$/, '');
	
	if ((!use_robohelp_behavior) && (terms_HELPCFG.length > 0) && (typeof(cfgArray[terms_HELPCFG]) != 'undefined') && (cfgArray[terms_HELPCFG].length > 0)) {
		if (document.getElementById) { // DOM3 = IE5, NS6
			var newHref = baseUrl + getCountryName() + "/support/chc/" + "?helpcfg=http://help." + stage + "adobe.com/HelpCfg/" + getLangName() + "/" + terms_HELPCFG + "&url=" + refpage + "&product=" + cfgArray[terms_HELPCFG];
			var newSrc = baseUrl + getCountryName() + "/support/chc/GetMoreHelpFeatures.png";
			document.getElementById("chcPromo").style.display = "block";
			document.getElementById("chcLink").href = newHref;
			document.getElementById("chcImage").src = newSrc;
		}
	}
}

//-->
</script>



          <div id="minitoc"><div class="t"><div class="b"><div><ul id="minitoc-links"><li><p><a href="#WSf01dbd23413dda0e54af3c7912012f78097-7ff1"><span class="topictitle1">Session level cache</span>
</a></p></li><li><p><a href="#WSf01dbd23413dda0e54af3c7912012f78097-7ff0"><span class="topictitle1">Secondary level cache</span>
</a></p></li><li><p><a href="#WS4C3B91C4-E209-4449-B1EE-E44F4F5D3D14"><span class="topictitle1">Use secondary cache</span>
</a></p><ul><li><p><a href="#WS95AA449D-EEDB-405c-88B7-926A79960631"><span class="topictitle2">Cache data of a persistent object</span>
</a></p></li><li><p><a href="#WS3FEEED6E-B678-4820-8B57-BAEA674E678C"><span class="topictitle2">Cache the association data of a persistent object</span>
</a></p></li><li><p><a href="#WS8328AD30-E061-4f53-ABB2-886B421F096C"><span class="topictitle2">Cache query data</span>
</a></p></li><li><p><a href="#WSF35B5699-F6E4-4089-87FD-B91DBECDFA41"><span class="topictitle2">Secondary cache example using EHCache</span>
</a></p></li><li><p><a href="#WS2992AAB2-50FC-4ead-9D73-169B3C1529EE"><span class="topictitle2">Evict content from secondary cache</span>
</a></p></li></ul></li><li><p><a href="#WSd160b5fdf5100e8ff9be58612a1d7d628d-8000"><span class="topictitle1">Support for user-defined caches in ColdFusion 9.0.1</span>
</a></p></li></ul></div></div></div></div><div><p>Caching is extensively used for optimizing database applications
and effectively reducing traffic between the database and the application. </p>
<p>ColdFusion ORM supports two levels of caching:</p>
<ul><li><p>Session level </p>
</li>
<li><p>Secondary level</p>
</li>
</ul>
</div>
<div id="WSf01dbd23413dda0e54af3c7912012f78097-7ff1" class="nochunk"><a name="WSf01dbd23413dda0e54af3c7912012f78097-7ff1"><!-- --></a><h2 class="topictitle2">Session level cache</h2><div><p>Objects that are loaded from the database are always cached
in the ORM Session as long as the session is open. When <samp class="codeph">EntityLoad</samp> is
called to retrieve an object in a session for the first time, ORM
fetches the data from the database and constructs the object. In
any subsequent call to load the same object in the same session,
ORM fetches the object from the session cache. To forcefully retrieve
the object from the database, <samp class="codeph">EntityReload</samp> should
be called on the object. </p>
<p>For more details on ORM Sessions and its lifecycle, see <a href="WS00180FBE-6DE0-43f0-84CB-DCE04A9FCCA4.html">ORM session management</a> and <a href="WSB51B3786-8E55-4a72-ABDB-5707B9A853D9.html">Architecture</a>.</p>
</div></div>
<div id="WSf01dbd23413dda0e54af3c7912012f78097-7ff0" class="nochunk"><a name="WSf01dbd23413dda0e54af3c7912012f78097-7ff0"><!-- --></a><h2 class="topictitle2">Secondary level cache</h2><div><p>ColdFusion provides the ability to store the data that
is retrieved from the database in secondary cache. The contents
in secondary cache live longer than the life-time of a session.
It can also be the life-time of the process or in-definite (disk-caching),
depending on the ability of the secondary cache provider. The cache
can also be used in a distributed environment depending on the ability
of the secondary cache provider.</p>
<p>An important difference between session level cache and secondary
level cache is that the session level caches the whole object but
the secondary level caches only the data.</p>
<p>Secondary level cache can be leveraged by using an external cache
provider with ColdFusion ORM. EHCache, JBossCache, OSCache, SwarmCache,
and Tangosol Coherence Cache are some popular secondary cache providers,
which can be plugged into Hibernate. </p>
<p>ColdFusion uses EHCache as the default secondary cache provider.
EHCache is a distributed caching solution that supports memory and
disk-based caching. EHCache can be configured using a configuration
file. Different cache regions can be defined in the configuration
file. Each cache region has its own configuration that specifies
details including the number of elements it can store, eviction
policy, time to live (ttl), and idle time. </p>
<p>ehcache.xml is available in the following location: <i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">CF_root</i>\lib\.
For details of the properties in the ehcache.xml, refer to the documentation
available at the following URL:</p>
<p><a href="http://ehcache.org/" target="_self">http://ehcache.org/</a></p>
<p>The following is a sample EHCache configuration file (<samp class="codeph">ehcache.xml</samp>):</p>
<pre>&lt;ehcache&gt; 
    &lt;diskStore path="java.io.tmpdir"/&gt; 
    &lt;defaultCache 
        maxElementsInMemory="10000" 
        eternal="false" 
        timeToIdleSeconds="120" 
        timeToLiveSeconds="120" 
        overflowToDisk="true" 
        diskPersistent="false" 
        diskExpiryThreadIntervalSeconds="120" 
        memoryStoreEvictionPolicy="LRU" 
        /&gt;        
    &lt;cache name="Artist" 
        maxElementsInMemory="20" 
        eternal="true" 
        overflowToDisk="false" 
        /&gt; 
&lt;/ehcache&gt;</pre>
<div class="section"><h4 class="sectiontitle">Modifications to ehcache.xml in ColdFusion 9.0.1</h4><p>ehCache.xml
includes the following configuration properties:</p>
<div class="para"><ul><li><p><samp class="codeph">diskSpoolBufferSizeMB</samp>: Size to allocate
the DiskStore for a spool buffer. </p>
<p>The default size is 30
MB. Each spool buffer is used only by its cache.</p>
<p>Turning on
trace-level logging shows if backup for cache created/updated using <samp class="codeph">action="put"</samp> occurs
in the diskstore.</p>
</li>
<li><p><samp class="codeph">clearOnFlush</samp>: Determines if the MemoryStore
must be cleared when the cache is flushed. By default, the MemoryStore
is cleared.</p>
</li>
<li><p><samp class="codeph">diskExpiryThreadIntervalSeconds</samp>: The number
of seconds between runs of the disk expiry thread. The default value
is <samp class="codeph">120</samp> seconds.</p>
</li>
</ul>
</div>
<div class="note"><span class="notetitle">Note:  </span>The functions <samp class="codeph">cacheGetProperties</samp> and <samp class="codeph">cacheSetProperties</samp> can be
used to get/set these properties.</div>
</div>
</div></div>
<div id="WS4C3B91C4-E209-4449-B1EE-E44F4F5D3D14" class="nochunk"><a name="WS4C3B91C4-E209-4449-B1EE-E44F4F5D3D14"><!-- --></a><h2 class="topictitle2">Use secondary cache</h2><div><p>To use secondary cache, you must configure the following
settings in the application:</p>
<ul><li><p><samp class="codeph">ormsettings.secondarycacheenabled</samp></p>
<p>This
setting defines whether the secondary cache would be used by the
application. By default, this is set to false.</p>
</li>
<li><p><samp class="codeph">ormsettings.Cacheprovider</samp></p>
<p>This setting
defines the cache provider that needs to be used for secondary cache.
This defaults to EHCache. The other values for this setting are
JBossCache, OSCache, SwarmCache and Hashtable. You can also specify
the fully qualified class name of the cache provider.</p>
</li>
<li><p><samp class="codeph">ormsettings.cacheconfig</samp></p>
<p>This setting
defines the configuration file required by the secondary cache provider.
For example, EHCache requires <samp class="codeph">EHCache.xml</samp> that
defines the configuration settings for the secondary cache. Specify
the path to the XML file in this setting. If this setting is not
defined, cache provider uses its default configuration.</p>
</li>
</ul>
<p>After you have configured the secondary cache, it is critical
to identify the objects in your application that can be cached because
the data cached by secondary cache is shared by all the sessions
of an application. Typically, caching should be enabled for a CFC
that represents:</p>
<ul><li><p>Data that changes rarely</p>
</li>
<li><p>Data that is local to an application and is not modified
by other applications</p>
</li>
<li><p>Non-critical data</p>
</li>
</ul>
<p>For each type of object that needs to be cached, you also need
to decide the access strategies. ORM provides the following cache
strategies that you can use for your objects:</p>
<ul><li><p>read-only </p>
<p>This strategy is useful for data that
is read frequently but never updated. This is the best performing
cache strategy.</p>
</li>
<li><p>nonstrict-read-write </p>
<p>This strategy is useful for data
that is updated occasionally. Typically, it is very unlikely that
two transactions would update the same object simultaneously.</p>
</li>
<li><p>read-write</p>
<p>This strategy may be appropriate if your
data needs to be updated. It carries more overhead than the two
preceding strategies.</p>
</li>
<li><p>Transactional</p>
<p>This strategy provides the support for
transactional cache. It can only be used if the cache provider is
transaction aware.</p>
</li>
</ul>
<p>Support for these strategies depend on the cache provider. Not
all the cache providers support all the cache strategies. For more
information on these strategies, see:</p>
<p><a href="http://www.hibernate.org/hib_docs/reference/en/html/performance-cache.html" target="_self">www.hibernate.org/hib_docs/reference/en/html/performance-cache.html</a></p>
<p>The secondary cache can cache the following types of data.</p>
<ul><li><p>Persistent object data</p>
</li>
<li><p>Persistent object association</p>
</li>
<li><p>Query data</p>
</li>
</ul>
</div><div id="WS95AA449D-EEDB-405c-88B7-926A79960631" class="nochunk"><a name="WS95AA449D-EEDB-405c-88B7-926A79960631"><!-- --></a><h3 class="topictitle3">Cache data of a persistent object</h3><div><p>In this case, the data of the persistent object is cached.
It will not cache the associations or associated object's data.
To enable this flag on a persistent CFC, specify the following attributes
on the component.</p>
<ul><li><p><samp class="codeph">cacheuse</samp>: Defines the caching strategy. </p>
</li>
<li><p><samp class="codeph">cachename</samp>: Defines the name of the cache
region to be used by the secondary cache provider. If you do not
specify a region name for the component, the entity name of the
component is considered as the cache name. In case a region is not
specified in the configuration file, a region is automatically created
with the default configuration.</p>
</li>
</ul>
<p>For example: </p>
<pre>&lt;cfcomponent persistent="true" schema="APP" table="Artists" cachename="artist" cacheuse="read-only"&gt;</pre>
</div></div><div id="WS3FEEED6E-B678-4820-8B57-BAEA674E678C" class="nochunk"><a name="WS3FEEED6E-B678-4820-8B57-BAEA674E678C"><!-- --></a><h3 class="topictitle3">Cache the association data of a persistent object</h3><div><p>In this case, the primary key of the associated objects
are cached. It does not cache the objects loaded as part of the
association unless caching is enabled for those objects. To cache
an association, specify the following attributes on the association
property.</p>
<ul><li><p><samp class="codeph">cacheuse</samp>: Defines the caching strategy.</p>
</li>
<li><p><samp class="codeph">cachename</samp>: Defines the name of the cache
region to be used by the secondary cache provider. If you do not
specify a region name for the association property, the &lt;comoponent_name&gt;.&lt;property_name&gt;
is considered as the cache name. In case a region is not specified
in the configuration file, a region is automatically created with
the default configuration.</p>
</li>
</ul>
<p>For example:</p>
<pre>&lt;cfproperty name="art" fieldtype="one-to-many" cfc="CArt" fkcolumn="ArtID" cachename="ArtistArts" cacheuse="read-only"&gt;</pre>
</div></div><div id="WS8328AD30-E061-4f53-ABB2-886B421F096C" class="nochunk"><a name="WS8328AD30-E061-4f53-ABB2-886B421F096C"><!-- --></a><h3 class="topictitle3">Cache query data</h3><div><p>In this case, the results of queries that are executed
by <samp class="codeph">ORMExecuteQuery()</samp> or <samp class="codeph">EntityLoad()</samp> methods
are cached in the secondary cache. To enable caching query data,
pass "<samp class="codeph">cacheable=true</samp>" and <samp class="codeph">"cachename='cachename'</samp> values
in the options struct of the methods. If you do not specify the <samp class="codeph">cachename</samp>,
the query is cached in the default query cache. It is recommended
that you to specify the <samp class="codeph">cachename</samp> so that you can control
eviction.</p>
<p>For example:</p>
<pre>availableArts = ORMExecuteQuery("from CArt where issold=0", {}, false, {cacheable=true, cachename="availableArtsQuery"});</pre>
</div></div><div id="WSF35B5699-F6E4-4089-87FD-B91DBECDFA41" class="nochunk"><a name="WSF35B5699-F6E4-4089-87FD-B91DBECDFA41"><!-- --></a><h3 class="topictitle3">Secondary cache example using EHCache</h3><div><p>Step 1: Set the following in <samp class="codeph">Application.cfc</samp>:</p>
<pre>&lt;cfset this.name="Caching_Example"&gt; 
&lt;cfset this.datasource="cfartgallery"&gt; 
&lt;cfset this.ormenabled="true"&gt; 
&lt;cfset this.ormsettings.secondarycacheEnabled=true&gt; 
&lt;cfset this.ormsettings.cacheProvider= "ehcache"&gt; 
&lt;cfset this.ormsettings.cacheConfig="ehcache.xml"&gt;</pre>
<p>Step 2: Define the cache settings in the CFCs.</p>
<p>CArtist.cfc</p>
<pre>&lt;cfcomponent persistent="true" schema="APP" table="Artists" cachename="artist" cacheuse="read-only"&gt; 
    &lt;cfproperty name="artistid" fieldtype="id"/&gt; 
    &lt;cfproperty name="firstname"/&gt; 
    &lt;cfproperty name="lastname"/&gt;   
    &lt;cfproperty name="state"/&gt; 
    &lt;cfproperty name="art" fieldtype="one-to-many" cfc="CArt" fkcolumn="ArtID" cachename="ArtistArts" cacheuse="read-only"&gt; 
&lt;/cfcomponent&gt;</pre>
<p>CArt.cfc</p>
<pre>&lt;cfcomponent persistent="true" schema="APP" table="Art"&gt; 
    &lt;cfproperty name="artid" generator="identity" fieldtype="id"/&gt; 
    &lt;cfproperty name="artname"/&gt; 
    &lt;cfproperty name="issold"/&gt; 
&lt;/cfcomponent&gt;</pre>
<p>Step 3:</p>
<pre>&lt;cfscript&gt; 
//This will cache the Artist Component and also the association.  It wouldn't cache the Art objects. 
artistObj = EntityLoad("CArtists", 3, true); 
//This will cache the query. 
availableArts = ORMExecuteQuery("from CArt where issold=0", {}, false, {cacheable=true, cachename="availableArtsCache"}); 
&lt;/cfscript&gt;</pre>
</div></div><div id="WS2992AAB2-50FC-4ead-9D73-169B3C1529EE" class="nochunk"><a name="WS2992AAB2-50FC-4ead-9D73-169B3C1529EE"><!-- --></a><h3 class="topictitle3">Evict content from secondary cache</h3><div><p>ColdFusion provides the following methods to evict contents
from the secondary cache.</p>
<p><samp class="codeph">ORMEvictEntity("&lt;component_name&gt;", [primarykey])</samp></p>
<p>This method is used to evict items for the given component name,
from the secondary cache. If the primary key is specified, then
the data of the entity with that primary key is evicted. Primary
key should be a value in case of simple primary key or should be
a struct in case of composite primary key. </p>
<p>Example:</p>
<pre>&lt;cfset ORMEvictEntity("CArtists")&gt; </pre>
<p>Evicts all the cache data of CArtist entity.</p>
<pre>&lt;cfset ORMEvictEntity("CArtists", 1)&gt; </pre>
<p>Evicts the cache data of CArtists entity whose primary key is
1.</p>
<p><samp class="codeph">ORMEvictCollection("&lt;component_name&gt;", "&lt;collection_name&gt;", [primarykey])</samp></p>
<p>This method is used to evict all the collection/association data
for the given component name and collection name, from the secondary
cache. If the primary key is specified, then, the collection or
association data of the entity with the primary key is evicted.</p>
<p>Example:</p>
<pre>&lt;cfset ORMEvictCollection("CArtists", "art")&gt; </pre>
<p>Evicts all the association or collection data of collection art
belonging to the component CArtists.</p>
<pre>&lt;cfset ORMEvictCollection("CArtists", "art", 1)&gt; </pre>
<p>Evict the association or collection data of collection art belonging
to the component CArtists with primary key 1.</p>
<p><samp class="codeph">ORMEvictQueries([cachename])</samp></p>
<p>This method is used to evict the data of all the queries from
the default query cache. If cache name is specified, then, the data
of all the queries belonging to the cache region with the given
cache name are evicted. Example:</p>
<pre>&lt;cfset ORMEvictQueries()&gt; </pre>
<p>Evicts the data of all the queries from the default query cache.</p>
<pre>&lt;cfset ORMEvictQueries("availableArtsCache")&gt; </pre>
<p>Evicts the data of all the queries from the cache region with
the name <samp class="codeph">availableArtsCache</samp>.</p>
</div></div></div>
<div id="WSd160b5fdf5100e8ff9be58612a1d7d628d-8000" class="nochunk"><a name="WSd160b5fdf5100e8ff9be58612a1d7d628d-8000"><!-- --></a><h2 class="topictitle2">Support for user-defined caches in ColdFusion 9.0.1</h2><div><p>Except in <samp class="codeph">cacheSetProperties</samp> and <samp class="codeph">cacheGetProperties,</samp> user-defined
caches are supported in all caching functions.</p>
<p>Edit ehCache.xml (<i xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:xs="http://www.w3.org/2001/XMLSchema">cfroot</i>/lib)to set the properties for
user-defined caches as shown in the following example:</p>
<div class="para"><pre>&lt;!--- item to put in user-defined cache ---&gt; 
&lt;cfset currentTime = Now()&gt; 
&lt;!--- put item in user-defined cache ---&gt; 
&lt;cfset timeToLive=createtimespan(0,0,0,30)&gt; 
&lt;cfset timeToIdle=createtimespan(0,0,0,30)&gt; 
&lt;cfset customCache = "usercache"&gt; 
&lt;cfset id = "cache1"&gt; 
&lt;cfset cachePut(id,currentTime,timeToLive,timeToIdle,customCache)&gt; 
&lt;!-- list items in the cache ---&gt; 
List Items in cache:  
&lt;cfset cacheIds = cacheGetAllIds(customCache)&gt; 
&lt;cfdump var="#cacheIds#"&gt;&lt;br&gt; 
&lt;!--- print cache data ---&gt; 
&lt;cfset cachedData = cacheGet(id,customCache)&gt; 
&lt;cfoutput&gt;#cachedData#&lt;/cfoutput&gt; 
&lt;!--- print cache metadata ---&gt; 
Cache metadata: 
&lt;cfset mdata = cacheGetMetadata(id,"object",customCache)&gt; 
&lt;cfdump var="#mdata#"&gt; 
&lt;!--- clear user-defined cache ---&gt; 
&lt;cfset cacheRemove(ArrayToList(cacheIds),true,customCache)&gt;</pre>
</div>
</div></div>


<!-- BEGIN USER PREFERENCES -->
          <div id="userprefs">
          </div>
<!-- END USER PREFERENCES -->

          <div id="related">
            
            
            <div class="separator"><a href="#top"><img src="images/BTT.jpg" /></a>&#160;</div>
          </div>
          <div id="footer">
<!-- BEGIN IONCOMMENTS -->
            <div id="ionComHere">
            </div>
<!-- END IONCOMMENTS -->


            <p id="creativecommons"><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" id="creativecommons_text"><img id="creativecommons_img" src="images/CC.png" alt="This work is licensed under a Creative Commons Attribution-Noncommercial-Share Alike 3.0 Unported License" /></a>&nbsp;Twitter™ and Facebook posts are not covered under the terms of Creative Commons.</p>
          </div>
</td>
<td width="10px"></td>
<td id="inner_rightcolumn">

</td></tr></table>
      </div>
<!-- BEGIN BREADCRUMBS -->
      <div id="breadcrumb">
        
<ul class="navigation"><li class="prev"><a accesskey="p" class="prev" href="WSE01EDE03-6E6B-4669-8C54-358460778450.html" title="Lazy Loading"><img src="images/blank.gif" alt="Previous" width="17" height="17" /></a></li><li class="next"><a accesskey="n" class="next" href="WS00180FBE-6DE0-43f0-84CB-DCE04A9FCCA4.html" title="ORM session management"><img src="images/blank.gif" alt="Next" width="17" height="17" /></a></li></ul><div class="hierarchy" id="hierarchy"><a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Home</b></a> / <a href="WSf01dbd23413dda0e-446b5201205757ce2b-8000.html"><b>Developing&#160;ColdFusion 9 Applications</b></a> / <a href="WSD628ADC4-A5F7-4079-99E0-FD725BE9B4BD.html"><b>ColdFusion ORM</b></a> 
      / <a href="WSE08CDAD8-3A58-4b77-B035-EA88C963A8D5.html"><b>Performance optimization</b></a> 
     </div>

      </div>
<!-- END BREADCRUMBS -->
<!-- END CONTENT WRAPPER -->

</td>
<td id="col3">
    <div>
        <img src="images/adobe-lq.png" />
    </div>
</td>
</tr>
</table>
    </div>
<!-- END PAGE CONTENT WRAPPER -->
<script type="text/javascript">
<!--[CDATA[
scrollToNameAnchor();
// ]]-->
</script> 
<!--
    Description:
    This file generates the link to product support in the top right corner
-->

<style>
#menutop{
    position:absolute;
    top:4px;
    right:24px;
    width:auto;    
    font-size:11px;
    color:#fff;
    text-align:right;
}
#menutop a{
    color:#fff;
}
#menutop a:hover{
        text-decoration:underline;
}
</style>  
  
  
  
  
<div id="productmenu">
<!--googleoff: index-->
  <div id="menutop">


<script language=javascript type='text/javascript'>
    // darken menu text for products with light backgrounds
    var path = document.location.href.toLowerCase();
    if (path.indexOf("/acrobat/")           	> 0 ||
        path.indexOf("/acrobat.com/")       	> 0 ||
        path.indexOf("/acrobatConnectPro/") 	> 0 ||
        path.indexOf("/connect/")           	> 0 ||
        path.indexOf("/livecycledataserviceses/") > 0 ||
        path.indexOf("/muse/")         	> 0 ||
	path.indexOf("/presenter/")         	> 0 ||
        path.indexOf("/scene7/")            	> 0 ||
        path.indexOf("/flashmediaserver/")  	> 0 ||
        path.indexOf("/wave/")              	> 0 )
    {
        document.write('<style>#menutop a{color:#505050}</style>');
    }
    if (typeof('terms_AHV_PRODUCT_SUPPORT') != "undefined" && ! use_robohelp_behavior ){      
        if (path.indexOf("/muse/") > -1 ){
            var supportlink = '<a href="http://muse.adobe.com/support.html">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }else{
            var supportlink = '<a href="http://adobe.com/support">'+terms_AHV_PRODUCT_SUPPORT+'</a>';
        }
        document.write( supportlink );
     }

</script> 

  </div>
<!--googleon: index-->
</div>



<style>
#online-privacy-policy{ 
    margin:10px 40px; 
    font-size:11px;
}
</style>

<p id="online-privacy-policy">
<script language="javascript">
var pageLoc = "en_US";
var metaElements = document.all ?
document.all.tags('meta') :
document.getElementsByTagName ?
document.getElementsByTagName ('meta') : new Array();
for (var m = 0; m < metaElements.length; m++) {
	if (metaElements[m].name == "lang") {
		pageLoc = metaElements[m].content;
		break;
	}
}
var ptn = /(..)-(..)/;
if (ptn.test(pageLoc)) {
	var languageCode = pageLoc.replace(ptn, "$1");
	var countryCode = pageLoc.replace(ptn, "$2");
	pageLoc = languageCode + "_" + countryCode.toUpperCase();
}

var policyLoc = "en_US";
var policyText = "Online Privacy Policy";
var policyPath = "";
var policyArray=[
"da_DK", "Online fortrolighedserklæring",
"de_DE", "Online-Datenschutzrichtlinie",
"es_ES", "Política de confidencialidad en línea",
"fi_FI", "Yksityisyyttä koskeva Online-toimintaohjelma",
"fr_FR", "Confidentialité et sécurité",
"it_IT", "Informativa sulla privacy online",
"ja_JP", "プライバシーポリシー",
"ko_KR", "Adobe 온라인 개인정보 보호정책",
"pt_BR", "Política de Confidencialidade On-line", 
"zh_CN", "在线隐私政策",
"zh_TW", "線上隱私政策"
];
var legalLoc = "en_US";
var legalText = "Legal Notices";
var legalPath = legalLoc;
var legalArray=[
"ar_AE", "إشعارات قانونية",
"bg_BG", "Юридически бележки",
"cs_CZ", "Právní upozornění",
"da_DK", "Juridiske meddelelser",
"de_DE", "Rechtliche Hinweise",
"el_GR", "Σημειώσεις νομικού περιεχομένου",
"es_ES", "Avisos legales",
"et_EE", "Juriidilised teated",
"fi_FI", "Lakisääteiset ilmoitukset",
"fr_FR", "Mentions légales",
"he_IL", "הצהרות משפטיות",
"hr_HR", "Pravne napomene",
"hu_HU", "Jogi közlemények",
"it_IT", "Informazioni legali",
"ja_JP", "法律上の注意",
"ko_KR", "법적 고지 사항",
"lt_LT", "Teisinės pastabos",
"lv_LV", "Juridisks paziņojums",
"nb_NO", "Juridiske merknader",
"nl_NL", "Juridische kennisgevingen",
"pl_PL", "Informacje prawne",
"pt_BR", "Aspectos jurídicos",
"ro_RO", "Prevederi legale",
"ru_RU", "Юридическая информация",
"sk_SK", "Právne upozornenie",
"sl_SI", "Pravni pouk",
"sv_SE", "Upphovsrätt",
"tr_TR", "Yasal uyarılar",
"uk_UA", "Юридична інформація",
"zh_CN", "法律声明",
"zh_TW", "法律注意事項"
];

ruPolicy = "http://www.adobe.com/ru/misc/privacy.html";
trPolicy = "http://www.adobe.com/tr/misc/privacy.html";

// Bug 2846992: LOC: RUS, TUR: The link to "Online Privacy Policy" should include language, currently it is not appearing.
if (pageLoc == "ru_RU") {
	policyPath = "ru";
}
else if (pageLoc == "tr_TR") {
	policyPath = "tr";
}
for (var i = 0; i < policyArray.length; i+=2) {
	if (pageLoc == policyArray[i]) {
		policyLoc = pageLoc;
		policyText = policyArray[i+1];
		var ptn = /(..)_(..)/;
		if (ptn.test(policyLoc)) {
			var countryCode = policyLoc.replace(ptn, "$2");
			policyPath = countryCode.toLowerCase();
		}
		break;
	}
}

for (var i = 0; i < legalArray.length; i+=2) {
	if (pageLoc == legalArray[i]) {
		legalLoc = pageLoc;
		legalText = legalArray[i+1];
		legalPath = legalLoc;
		break;
	}
}
if(agt.indexOf("community help client") > -1 ){
	document.write('<a href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
}else{
	//Open the privacy policy in a new window
	document.write('<a target="_blank" href="/'+legalPath+'/legalnotices/index.html">'+legalText+'<\/a>');
	document.write(' | ');
	document.write('<a target="_blank" href="http://www.adobe.com/'+policyPath+'/misc/privacy.html">'+policyText+'<\/a>');
} 
</script>
</p>



<!-- localfooter.ssi -->

<script type="text/javascript">
    var debug = (top.location.href.indexOf("debug=true") > -1);
</script>

<script language="javascript">
document.write('<scr'+'ipt ' +
               'src="/en_US/ssi/_pod.js" ' +
               'language="javascript" ' +
               'charset="UTF-8"> ' +
               '</scr'+'ipt>');
</script>


<script type="text/javascript">
//
//  Ethnio survey code
//
/*          DocumentID      EthnioID */
/*          -------------   -------- */
var ethnio=["/en_US/flash/cs/using/WSb03e830bd6f770ee6664507612436d7dede-8000.html", "87462",
            "/en_US/creativesuite/cs/using/WSe851854fd1e0856a-4b08a77612477f69f15-8000.html",  "10441",
            "/en_US/dreamweaver/cs/using/WSEE4C0148-A6F4-4bf5-9DEF-CE06AB026214a.html",  "57412"
 
    ];
                        
    for ( var i = 0; i < ethnio.length ; i = i+2 ){
        if ( document.location.href.indexOf( ethnio[i] ) > -1 ){ 
            var headID = document.getElementsByTagName("head")[0];         
            var ethnioScript = document.createElement('script');
            ethnioScript.type = 'text/javascript';
            ethnioScript.src = 'http://ethn.io/remotes/' + ethnio[i+1];        
            if ( debug ){
                alert ("Using Ethnio script: " + ethnioScript.src );
            }else{
                headID.appendChild(ethnioScript);
            }
        }
    }
</script>



<div style="display: none;">
<!-- SiteCatalyst -->
<script language="JavaScript" type="text/javascript"><!--
var s_code=' ';
var s_docHost = window.location.hostname.toLowerCase();
var s_docURL = window.location.pathname.toLowerCase();
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
if (s_docHost.indexOf(".corp.adobe") != -1 || s_docHost.indexOf("stage.") != -1 || s_docHost.indexOf(".dev.adobe") != -1 || s_docHost.indexOf("staging.") != -1) scJsHost="";
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/omniture_s_code.js' type='text/javascript'%3E%3C/script%3E"));
//--></script>
<script type="text/javascript"><!--
var s_accountName;
s_server="www.adobe.com static content pages";
if (!window.s_account) s_accountName="mxmacromedia";
else s_accountName=window.s_account;

if (window.s_docURL.indexOf("/designcenter/") != -1)
  s_channel="Adobe Design Center";	
else if ((window.s_docHost.indexOf("labs.adobe") != -1) ||
(window.s_docHost.indexOf("labs-staging.") != -1))
  s_channel="Labs";
else if (window.s_docHost.indexOf("help.adobe.com") != -1) {
  s_channel="Support Help.adobe.com";
  if (window.s_docURL.indexOf("/en_us/") == -1) {
    s_docURLArray=s_docURL.split('/');
    s_pageName="http://help.adobe.com/"+s_docURLArray[1]+"/"+ s_docURLArray[2]+"/"+s_docURLArray[3];
    s_prop23="http://help.adobe.com"+window.location.pathname;
  }
}
else if (window.s_docHost.indexOf("kb2.adobe.com") != -1) {
  s_channel="Support Knowledgebase";
  s_prop23="http://kb2.adobe.com"+s_docURL+":";
  if (typeof(omtrProductList) != 'undefined' && omtrProductList.length > 0)
 {
    s_prop23=s_prop23+omtrProductList;
  }
}
else if (window.s_docHost.indexOf("resellers.adobe.com") != -1) {
		var s_pageName=document.getElementsByTagName("title")[0].text;
}

if (!window.scMMInclude) {
	var s_wd=window,s_tm=new Date;
	if(s_code!=' '){
		s_code=s_dc(s_accountName);
		if(s_code)document.write(s_code)
	} 
} else {
	s_wds(s_accountName);s_ca(s_accountName); 
}	

function sendAnalyticsEvent(str){var ns=s_accountName;if(str!=null)ns+=","+str;void(s_gs(ns));}
function sendLinkEvent(accnt,lnkname,type){
accnt=s_accountName;s_linkType=type;s_lnk=true;s_linkName=lnkname;void(s_gs(accnt));}
//--></script>
<noscript><img src="http://stats.adobe.com/b/ss/mxmacromedia/1/H.15-XELvs/0?pageName=http%3A//www.adobe.com%3A%20noscript&ch=http%3A//www.adobe.com%3A%20noscript&g=http%3A//www.adobe.com" height="1" width="1" border="0" alt="" /></noscript>
<!-- End SiteCatalyst -->
</div>

<script language="JavaScript" type="text/javascript">//<![CDATA[
var scJsHost = (("https:" == document.location.protocol) ? "https://www.adobe.com" : "http://wwwimages.adobe.com");
document.write(unescape("%3Cscript src='" + scJsHost + "/uber/js/atm/s_code_www.js' type='text/javascript'%3E%3C/script%3E"));
//]]></script>
<script type="text/javascript">//<![CDATA[
if(s_adobe){	
	s_adobe.server="www.adobe.com Static Content pages";
	/* Set pageName */
	s_adobe.s_URL="adobe.com"+((location.pathname.charAt(0)=='/')?location.pathname:'/'+location.pathname);
	if (s_adobe.s_URL.substring(s_adobe.s_URL.lastIndexOf('/')+1)=="") s_adobe.s_URL=s_adobe.s_URL+"index.html";
	s_adobe.s_URLSplit=s_adobe.s_URL.split("/");
	s_adobe.pageName=s_adobe.s_URLSplit.join(":");

	/* Set prop4 to language-locale */
	var s_meta=document.getElementsByTagName('meta'); 
      for (i=0; i<s_meta.length; i++) { 
        if (s_meta[i].getAttribute("http-equiv") == "Content-Language") { 
          s_adobe.prop4=s_meta[i].getAttribute("content"); 
	    s_adobe.prop4=s_adobe.prop4.replace(/\s+/g,'');
        } 
      } 
	s_adobe.t()
}
//]]></script>








  </body>
</html>